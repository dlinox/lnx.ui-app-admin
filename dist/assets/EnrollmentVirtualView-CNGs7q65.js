import{d as z,r,e as le,j as se,a8 as W,a9 as R,aa as k,ab as o,ac as e,aB as L,aA as P,ae as I,ag as j,aI as re,aD as ie,ad as q,h as O,aJ as ue,aG as H,_ as J,af as B,aK as de,aH as pe,a3 as ce}from"./index-DRRg_eBM.js";import{d as me,e as _e,i as fe}from"./EditEnrollmentGroup.vue_vue_type_script_setup_true_lang-qUBl6wuK.js";import{a as K}from"./selectables.services-hf1ic-Kf.js";import{h as ve}from"./group.services-DNXTmVBl.js";import{d as G}from"./debounce.utils-DqPPCsFD.js";import{_ as ge}from"./Alert-Bez7UgkS.js";import{_ as ye,a as Ie}from"./FormItem-BmvuZJcR.js";import{_ as Q,a as X}from"./Col-B7SFfu7K.js";import{_ as Y}from"./Select-BARTLa82.js";import{_ as Z}from"./Space-BljgdQMa.js";import{i as ee}from"./DataTable.types-BEg5m_To.js";import"./studentType.services-qFZjJDlz.js";import"./student.services-xrSQ_Sb9.js";import"./documentType.services-lOLtMmx1.js";import{u as Se}from"./period.stores-C0ndm13s.js";import{N as be}from"./Tag-DLFVs5T4.js";import{r as we}from"./icon.utils-BkZ-Dn8n.js";import{_ as xe}from"./Input-BJ4gQKpn.js";import{_ as ke}from"./DataTable--fXJaN9P.js";import"./ListItem-D4M5d6vI.js";import"./Thing-gx5HDPvI.js";import"./Switch-DHyvHpJK.js";import"./use-merged-state-CaVxhrEA.js";import"./composables-i7kb42iS.js";import"./Dropdown-CweT_dMY.js";import"./Popover-CJcKKGg6.js";import"./get-CpGV-8IY.js";import"./Suffix-ByhxVsOv.js";import"./Tooltip-BnJ19Urq.js";const he=z({__name:"ReservationEnrollments",props:{modelValue:{type:Boolean},periodId:{}},emits:["update:modelValue","success","cancel"],setup(d,{emit:p}){const t=p,l=d,c={periodReferenceId:{trigger:["change","blur"],type:"number",required:!0,message:"Este campo es requerido"}},_=r(!1),u=r(!1),m=r([]),a=async f=>{u.value=!0,m.value=await K(f),u.value=!1},g=G(f=>{a(f)},400),S=le({get:()=>l.modelValue,set:f=>t("update:modelValue",f)}),b=r(null),y=r(Object.assign({},{periodId:null,periodReferenceId:null})),h=async()=>{if(b.value&&await b.value.validate()){y.value.periodId=l.periodId,_.value=!0;const n=await ve(y.value);_.value=!1,n&&(t("success"),S.value=!1)}};return se(()=>l.modelValue,async f=>{f&&await a("")}),(f,n)=>{const A=W("LnxIcon"),V=ge,E=Y,w=Ie,T=X,N=Q,D=ye,C=j,M=Z,s=L,i=re;return k(),R(i,{show:S.value,"onUpdate:show":n[2]||(n[2]=x=>S.value=x)},{default:o(()=>[e(s,{style:{width:"500px"},title:"Reestablecer Reservas de matrículas",bordered:!1,size:"small",role:"dialog","aria-modal":"true",segmented:{content:!0,footer:!0}},{footer:o(()=>[e(M,{justify:"end"},{default:o(()=>[e(C,{onClick:n[1]||(n[1]=x=>S.value=!1)},{default:o(()=>n[4]||(n[4]=[P("Cancelar")])),_:1}),e(C,{type:"primary",onClick:h,loading:_.value},{default:o(()=>n[5]||(n[5]=[P(" Aceptar ")])),_:1},8,["loading"])]),_:1})]),default:o(()=>[e(V,{title:"¡Importante!",type:"default",closable:"",class:"mb-4"},{icon:o(()=>[e(A,{iconName:"information"})]),default:o(()=>[n[3]||(n[3]=P(" Con esta funcionalidad, podrás reestablecer las reservas de matrículas del periodo académico seleccionado. Asegúrate de que los grupos ya estén creados en el nuevo periodo antes de continuar. "))]),_:1}),e(D,{ref_key:"formRef",ref:b,model:y.value,rules:c},{default:o(()=>[e(N,{gutter:16},{default:o(()=>[e(T,{span:24},{default:o(()=>[e(w,{label:"Periodo Académico de referencia",path:"periodReferenceId"},{default:o(()=>[e(E,{value:y.value.periodReferenceId,"onUpdate:value":n[0]||(n[0]=x=>y.value.periodReferenceId=x),placeholder:"Seleccionar Periodo Académico",filterable:"",options:m.value,loading:u.value,clearable:"",remote:"","virtual-scroll":!1,onSearch:I(g)},null,8,["value","options","loading","onSearch"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["show"])}}}),Ve=z({__name:"DataTableOp",props:{item:{}},emits:["openForm","success"],setup(d,{emit:p}){const t=p,l=Se(),c=async()=>{};return ie(()=>{c()}),(_,u)=>{var m;return((m=I(l).enrollment)==null?void 0:m.period)==_.item.period?(k(),R(me,{key:0,item:_.item,onResetEnrollment:u[0]||(u[0]=a=>t("openForm",a)),onChangeGroup:u[1]||(u[1]=a=>t("openForm",a)),onReserveEnrollment:u[2]||(u[2]=a=>t("success")),onCancelEnrollment:u[3]||(u[3]=a=>t("success"))},null,8,["item"])):q("",!0)}}}),Ce=(d,p)=>[{title:"Ops.",key:"ops",width:"100px",fixed:"left",render(t){const l=t;return O(Ve,{onOpenForm:()=>d(l),onSuccess:()=>p(),item:l},{default:()=>"Editar"})}},{title:"Período",key:"period",minWidth:"120"},{title:"Estudiante",key:"group-student",children:[{title:"Nombre",key:"student",minWidth:"250px"},{title:"Estado de mat.",key:"enrollmentStatus",minWidth:"150px",render(t){const l=t;return O(be,{type:l.enrollmentStatus==="MATRICULADO"?"info":l.enrollmentStatus==="RESERVADO"?"warning":"error",size:"small",bordered:!1},{default:()=>l.enrollmentStatus})}}]},{title:"Grupo",key:"group-group",children:[{title:"Módulo",key:"module",minWidth:"200px"},{title:"Curso",key:"course",minWidth:"200px"},{title:"Grupo",key:"group",minWidth:"100px"},{title:"Modalidad",key:"modality",minWidth:"100px"}]}],Pe=(d=ee())=>({page:d.page,total:d.total,pageSize:d.pageSize,pageCount:d.pageCount,showSizePicker:!0,pageSizes:[10,50,100,500,1e3,5e3],style:{paddingRight:"16px",paddingBottom:"12px"},prefix(){return`Total ${d.total} registros`}}),ze={style:{"border-bottom":"1px solid #e9e9e9"}},Re=z({__name:"DataTable",setup(d){const p=r(!1),t=r(!1),l=r(!1),c=r([]),_=r(!1),u=r([]),m=ue({...ee()}),a=r({search:null,page:m.page,pageSize:m.pageSize,filters:{periodId:null}}),g=r({}),S=r(null),b=r(null),$=r(null),y=r(null),h=r(!1),f=s=>{S.value=s.courseId,$.value=s.studentId,y.value=s.curriculumId,b.value=s,h.value=s.isSpecial,p.value=!0},n=async()=>{a.value.page=1,await w()},A=Ce(f,n),V=async s=>{l.value=!0,c.value=await K(s),l.value=!1},E=G(s=>{V(s)},400),w=async()=>{_.value=!0,g.value=await fe(a.value),u.value=g.value.data,m.total=g.value.total,m.pageSize=g.value.per_page,m.page=g.value.current_page,m.pageCount=g.value.last_page,_.value=!1},T=G(()=>{n()},400),N=async s=>{a.value.page=s,await w()},D=async s=>{a.value.page=1,a.value.pageSize=s,await w()},C=async()=>{await V(""),await w()},M=r(s=>s.enrollmentModality=="VIRTUAL"?"enrollment-virtual":"");return C(),(s,i)=>{const x=Y,oe=j,te=Z,U=X,ne=xe,F=Q,ae=ke;return k(),H(J,null,[B("div",ze,[e(F,{gutter:12,class:"p-4 flex justify-between"},{default:o(()=>[e(U,{span:12},{default:o(()=>[e(te,null,{default:o(()=>[e(x,{value:a.value.filters.periodId,"onUpdate:value":[i[0]||(i[0]=v=>a.value.filters.periodId=v),n],placeholder:"Seleccionar Periodo Académico",filterable:"",options:c.value,loading:l.value,clearable:"",remote:"",size:"large","virtual-scroll":!1,onSearch:I(E)},null,8,["value","options","loading","onSearch"]),a.value.filters.periodId?(k(),R(oe,{key:0,size:"large","render-icon":I(we)("convertshape"),onClick:i[1]||(i[1]=v=>t.value=!0)},{default:o(()=>i[7]||(i[7]=[P(" Reservas ")])),_:1},8,["render-icon"])):q("",!0)]),_:1})]),_:1}),e(U,{span:10},{default:o(()=>[e(ne,{size:"large",placeholder:"Buscar",value:a.value.search,"onUpdate:value":i[2]||(i[2]=v=>a.value.search=v),onInput:I(T),clearable:""},{suffix:o(()=>[e(pe,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),e(F,null,{default:o(()=>[e(U,{span:24},{default:o(()=>[e(ae,{key:"id",remote:"",size:"small","row-class-name":M.value,"single-line":!1,columns:I(A),data:u.value,pagination:I(Pe)(m),"pagination-show-size-picker":!0,loading:_.value,"onUpdate:page":N,"onUpdate:pageSize":D},null,8,["row-class-name","columns","data","pagination","loading"])]),_:1})]),_:1}),de(s.$slots,"extra",{reLoadDataTable:n},void 0,!0)]),e(_e,{modelValue:p.value,"onUpdate:modelValue":i[3]||(i[3]=v=>p.value=v),studentId:$.value,curriculumId:y.value,courseId:S.value,isSpecial:h.value,enrollmetGroup:b.value,onSuccess:n},null,8,["modelValue","studentId","curriculumId","courseId","isSpecial","enrollmetGroup"]),e(he,{modelValue:t.value,"onUpdate:modelValue":[i[4]||(i[4]=v=>t.value=v),i[6]||(i[6]=v=>t.value=v)],periodId:a.value.filters.periodId,onSuccess:n,onCancel:i[5]||(i[5]=v=>t.value=!1)},null,8,["modelValue","periodId"])],64)}}}),$e=(d,p)=>{const t=d.__vccOpts||d;for(const[l,c]of p)t[l]=c;return t},Ae=$e(Re,[["__scopeId","data-v-5f1796d1"]]),io=z({__name:"EnrollmentVirtualView",setup(d){const{hasPermission:p}=ce();return(async()=>{})(),(l,c)=>{const _=L,u=W("AppNotAuthorization");return I(p)(["enrollment.edit"])?(k(),H(J,{key:0},[e(_,{segmented:{header:!0,content:!0}},{header:o(()=>c[0]||(c[0]=[B("span",{class:"text-sm text-slate-500"}," Gestión de matrículas ",-1),B("h5",{class:"text-lg font-bold text-slate-800"},"Matrículas",-1)])),"header-extra":o(()=>c[1]||(c[1]=[])),_:1}),e(Ae)],64)):(k(),R(u,{key:1}))}}});export{io as default};
