import{d as le,a3 as oe,a5 as ae,r as m,aD as re,a8 as se,aG as h,a9 as g,ae as _,aa as u,ac as o,af as t,ab as e,aB as ue,aA as c,ah as a,_ as w,aU as A,ad as N,ag as ie}from"./index-CHKdQ-q5.js";import{r as de}from"./icon.utils-CmxuJXeQ.js";import{u as me}from"./useBreakpoints-BGm0jbfR.js";import{d as pe,e as _e,f as ce,h as fe}from"./EditEnrollmentGroup.vue_vue_type_script_setup_true_lang-FgG1Ho9T.js";import"./studentType.services-2cHVVDyk.js";import{i as ge}from"./student.services-w1brlGa3.js";import"./documentType.services-Bs_sGx4z.js";import{_ as ve}from"./selectables.services-QAg3KdYJ.js";import{u as he}from"./period.stores-BUvFY76H.js";import{_ as ye}from"./Select-CjOGNBL7.js";import{a as be,_ as Ie}from"./Col-G0czzw1d.js";import{_ as Ee}from"./Spin-Kcdkwoxe.js";import{_ as Se}from"./Space-WaWU-eRg.js";import{_ as ke}from"./Statistic-DaZJzOYF.js";import{_ as we,a as Ne}from"./CollapseItem-0waxvqco.js";import{a as xe,_ as Ce}from"./ListItem-BsQdMXx1.js";import{_ as $e}from"./Thing-c7LYiMsI.js";import{_ as Be}from"./Table-BwJbIgEI.js";import{N as Me}from"./Tag-Cy27tpc_.js";import"./Alert-D_4vezL4.js";import"./FormItem-BobmnhmY.js";import"./get-_S_LWlCl.js";import"./Input-C-7cIp0X.js";import"./Suffix-C8CazGck.js";import"./use-merged-state-CFtIg60l.js";import"./Switch-Cam2dNBn.js";import"./DataTable.types-BEg5m_To.js";import"./composables-CsGV-aUD.js";import"./Dropdown-CRs7219k.js";import"./Popover-CP6C22MG.js";const Ae={class:"p-4"},Ve={class:"text-lg font-semibold w-full text-blue-800 p-2"},Pe={key:1},pt=le({__name:"EnrollmentSpecialStudentView",setup(Re){const{hasPermission:G}=oe(),{screenSize:V}=me(),P=ae(),y=he(),x=m(!1),b=m(null),j=m(null),C=m([]),$=m(!0),d=m({}),R=m(!0),D=m(null),T=m(null),F=m(null),W=async f=>{let l=await ce({id:f}),v=new Blob([l],{type:"application/pdf"}),E=window.URL.createObjectURL(v),p=document.getElementById("printFrame");p.src=E,p.onload=function(){var S;(S=p.contentWindow)==null||S.print()}},q=async()=>{const f=P.params.id;$.value=!0,d.value=await ge(f),$.value=!1},I=async()=>{var v;const f=P.params.id,l=(v=j.value)==null?void 0:v.id;R.value=!0,D.value=await fe(f,b.value,l),R.value=!1},B=(f,l=null)=>{T.value=f,F.value=l,x.value=!0},H=async()=>{C.value=await ve(),b.value=C.value[0].value,q(),I()};return re(()=>{H()}),(f,l)=>{const v=ye,E=ue,p=ke,S=Se,J=Ee,U=be,M=Me,z=ie,K=Be,Q=$e,X=Ce,Y=xe,Z=Ne,ee=we,te=Ie,ne=se("AppNotAuthorization");return _(G)(["enrollment.create-special"])?(u(),h(w,{key:0},[o(E,{segmented:{header:!0,footer:!0,content:!0}},{header:e(()=>l[2]||(l[2]=[t("span",{class:"text-sm text-slate-500"}," Matricular estudiante ",-1),t("h5",{class:"text-lg font-bold text-slate-800"},"Matricula Especial",-1)])),"header-extra":e(()=>[o(v,{value:b.value,"onUpdate:value":[l[0]||(l[0]=n=>b.value=n),I],placeholder:"Seleccionar Plan de estudio",filterable:"",options:C.value,"virtual-scroll":!1,"default-value":1},null,8,["value","options"])]),action:e(()=>l[3]||(l[3]=[])),_:1}),t("div",Ae,[o(te,{gutter:16},{default:e(()=>[o(U,{span:_(V)=="lg"?6:24},{default:e(()=>[o(E,{segmented:{header:!0,content:!0},title:"InformaciÃ³n Personal",subtitle:"Datos del estudiante"},{default:e(()=>[o(J,{show:$.value},{default:e(()=>[o(S,{vertical:""},{default:e(()=>[o(p,{class:"small",label:"Tipo de estudiante"},{default:e(()=>{var n;return[c(a((n=d.value)==null?void 0:n.studentType),1)]}),_:1}),o(p,{class:"small",label:"Documento"},{default:e(()=>{var n,s;return[c(a((n=d.value)!=null&&n.documentNumber?(s=d.value)==null?void 0:s.documentNumber:"No registrado"),1)]}),_:1}),o(p,{class:"small",label:"Nombres"},{default:e(()=>{var n;return[c(a((n=d.value)==null?void 0:n.fullName),1)]}),_:1}),o(p,{class:"small",label:"Correo electronico"},{default:e(()=>{var n,s;return[c(a((n=d.value)!=null&&n.email?(s=d.value)==null?void 0:s.email:"No registrado"),1)]}),_:1}),o(p,{class:"small",label:"Telefono"},{default:e(()=>{var n,s;return[c(a((n=d.value)!=null&&n.phone?(s=d.value)==null?void 0:s.phone:"No registrado"),1)]}),_:1})]),_:1})]),_:1},8,["show"])]),_:1})]),_:1},8,["span"]),o(U,{span:_(V)=="lg"?18:24},{default:e(()=>[o(E,{segmented:{header:!0,content:!0},title:"Matricula"},{"header-extra":e(()=>[o(M,{bordered:!1,type:_(y).enrollment?"info":"error"},{default:e(()=>{var n;return[t("strong",null,a(_(y).enrollment?(n=_(y).enrollment)==null?void 0:n.period:"No habilitado"),1)]}),_:1},8,["type"])]),default:e(()=>[o(ee,null,{default:e(()=>{var n;return[(u(!0),h(w,null,A((n=D.value)==null?void 0:n.enrollments,s=>(u(),g(Z,{key:s.moduleId,name:s.moduleId},{header:e(()=>[t("h2",Ve,a(s.moduleName)+" "+a(s.isExtracurricular?"(Extracurricular)":""),1)]),default:e(()=>[o(Y,{hoverable:"",clickable:""},{default:e(()=>[(u(!0),h(w,null,A(s.courses,i=>(u(),g(X,{key:i.id},{default:e(()=>[o(Q,{title:`${i.code} - ${i.name}`},{"header-extra":e(()=>[i.enrollmentGroups.length==0||i.enrollmentGroups.filter(r=>r.groupStatus=="ABIERTO").length==0?(u(),g(z,{key:0,type:"primary",onClick:r=>B(i.id)},{default:e(()=>l[4]||(l[4]=[c(" Matricular ")])),_:2},1032,["onClick"])):N("",!0)]),description:e(()=>[o(S,{size:"small"},{default:e(()=>[o(M,{bordered:!1,size:"small"},{default:e(()=>[c(" Area: "+a(i.area),1)]),_:2},1024)]),_:2},1024)]),default:e(()=>[i.enrollmentGroups.length>0?(u(),g(K,{key:0,"single-line":!1},{default:e(()=>[l[6]||(l[6]=t("thead",null,[t("tr",null,[t("th",{colspan:"2"},"Matricula"),t("th",{colspan:"3"},"Grupo"),t("th",{colspan:"2"})]),t("tr",null,[t("th",null,"Periodo"),t("th",null,"Estado"),t("th",null,"Grupo"),t("th",null,"Modalidad"),t("th",null,"Estado"),t("th",{rowspan:"2"},"Nota"),t("th",null,"Acciones")])],-1)),t("tbody",null,[(u(!0),h(w,null,A(i.enrollmentGroups,r=>{var L,O;return u(),h("tr",null,[t("td",null,[((L=_(y).enrollment)==null?void 0:L.period)==r.period?(u(),g(M,{key:0,type:"info"},{default:e(()=>[c(a(r.period),1)]),_:2},1024)):(u(),h("span",Pe,a(r.period),1))]),t("td",null,a(r.enrollmentStatus),1),t("td",null,a(r.groupName),1),t("td",null,a(r.groupModality),1),t("td",null,a(r.groupStatus),1),t("td",null,a(r.grade),1),t("td",null,[((O=_(y).enrollment)==null?void 0:O.period)==r.period?(u(),g(pe,{key:0,item:r,onResetEnrollment:k=>B(i.id,k),onChangeGroup:k=>B(i.id,k),onReserveEnrollment:I,onCancelEnrollment:I},null,8,["item","onResetEnrollment","onChangeGroup"])):N("",!0),r.enrollmentStatus==="MATRICULADO"?(u(),g(z,{key:1,"render-icon":_(de)("printer"),onClick:k=>W(r.id)},{default:e(()=>l[5]||(l[5]=[c(" Ficha ")])),_:2},1032,["render-icon","onClick"])):N("",!0)])])}),256))])]),_:2},1024)):N("",!0)]),_:2},1032,["title"])]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["name"]))),128))]}),_:1})]),_:1})]),_:1},8,["span"])]),_:1})]),l[7]||(l[7]=t("iframe",{id:"printFrame",style:{display:"none"}},null,-1)),o(_e,{modelValue:x.value,"onUpdate:modelValue":l[1]||(l[1]=n=>x.value=n),studentId:d.value.id,curriculumId:b.value,courseId:T.value,enrollmetGroup:F.value,isSpecial:!0,onSuccess:I},null,8,["modelValue","studentId","curriculumId","courseId","enrollmetGroup"])],64)):(u(),g(ne,{key:1}))}}});export{pt as default};
