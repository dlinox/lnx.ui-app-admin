import{r as B}from"./icon.utils-DutMd2qr.js";import{d as R,a3 as q,a9 as E,ad as L,ae as P,aa as b,ab as a,ac as e,ag as N,aH as J,h as O,e as K,r as p,j as W,aB as F,aA as I,aI as Q,aG as A,_ as D,aU as j,aJ as te,af as M,aK as ne,a8 as oe}from"./index-DwV6zJCX.js";import{_ as le,a as se,b as ie,c as re,d as ue,e as me}from"./role.services-CWnqkrIF.js";import{_ as pe,a as de}from"./FormItem-CNNyqOT9.js";import{_ as G,a as X}from"./Col-BkVWW8vc.js";import{_ as Y}from"./Input-DldL4MyO.js";import{_ as Z}from"./Space-DEwGxh3N.js";import{_ as _e}from"./Switch-DLELeq5T.js";import{i as ee}from"./DataTable.types-BEg5m_To.js";import{u as ce}from"./composables-OPWM5oN5.js";import{_ as fe}from"./Dropdown-CxNUQKFj.js";import{_ as ve}from"./Tag-tDmUe03M.js";import{a as ge,b as be,_ as ye}from"./DataTable-DqW2qosf.js";import{_ as we,a as ke}from"./CollapseItem-B5Oz9WL9.js";import{d as xe}from"./debounce.utils-DqPPCsFD.js";import"./get-CqIzH_zz.js";import"./Suffix-B52V2l9z.js";import"./use-merged-state-B_X6BK0G.js";import"./get-slot-Bk_rJcZu.js";import"./Popover-BpepRpqO.js";import"./Tooltip-B687EG_W.js";import"./Select-B-XafpkT.js";const ze=R({__name:"DataTableOp",props:{item:{}},emits:["edit","delete","permissions"],setup(m,{emit:c}){const{hasPermission:s}=q(),i=ce(),t=c,r=[{label:"Asignar permisos",key:"assign-permissions",icon:B("security-safe"),show:s(["role-admin.assign-permissions"]),props:{onClick:()=>t("permissions")}},{label:"Editar",key:"edit",icon:B("edit-2"),show:s(["role-admin.edit"]),props:{onClick:()=>t("edit")}},{label:"Eliminar",key:"delete",icon:B("trash","red"),show:s(["role-admin.delete"]),props:{style:{color:"red"},onClick:()=>{i.warning({title:"Confirmar",content:"¿Está seguro que desea eliminar este registro?",positiveText:"Eliminar",negativeText:"Cancelar",closable:!1,showIcon:!1,negativeButtonProps:{secondary:!0,type:"tertiary",size:"large"},positiveButtonProps:{size:"large",type:"error"},onPositiveClick:()=>{t("delete")}})}}}];return(u,n)=>{const l=N,f=fe;return P(s)(["role-admin.edit","role-admin.delete","role-admin.assign-permissions"])?(b(),E(f,{key:0,options:r,placement:"bottom-start"},{default:a(()=>[e(l,null,{default:a(()=>[e(J,{"icon-name":"setting-5",size:"20"})]),_:1})]),_:1})):L("",!0)}}}),Ve=(m,c,s)=>[{title:"Ops.",key:"ops",width:"80px",fixed:"left",render(i){const t=i;return O(ze,{onEdit:()=>{m(t)},onDelete:()=>{c(t)},onPermissions:()=>{s(t)},item:t},{default:()=>"Editar"})}},{title:"Nombre",key:"name",minWidth:"300px"},{title:"Habilitado",key:"isEnabled",width:"150px",render:i=>O(ve,{type:i.isEnabled?"success":"error",tertiary:!0,bordered:!1,strong:!0},{default:()=>i.isEnabled?"	Habilitado":"Deshabilitado"})}],he=(m=ee())=>({page:m.page,total:m.total,pageSize:m.pageSize,pageCount:m.pageCount,showSizePicker:!0,pageSizes:[10,50,100,500,1e3,5e3],style:{paddingRight:"16px",paddingBottom:"12px"},prefix(){return`Total ${m.total} registros`}}),H=m=>({id:null,name:null,level:m,permissions:[],isEnabled:!0}),Ce=()=>({name:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}]}),ae=R({__name:"RoleForm",props:{item:{},level:{},modelValue:{type:Boolean}},emits:["update:modelValue","success"],setup(m,{emit:c}){const s=c,i=m,t=K({get:()=>i.modelValue,set:y=>s("update:modelValue",y)}),r=p(!1),u=p(null),n=p(H(i.level)),l=p(null),f=p({...Ce()}),v=async()=>{if(u.value){const y=await u.value.validate();let o=null;y?(r.value=!0,n.value.id?o=await le(n.value):o=await se(n.value),o.status?(s("success"),t.value=!1):l.value=o.data):console.log("Formulario inválido")}r.value=!1},g=()=>{console.log("Inicializando formulario"),n.value=i.item?{...i.item}:H(i.level)};return W(t,y=>{y&&(l.value=null,g())}),(y,o)=>{const k=Y,x=de,S=X,$=_e,C=Z,T=G,d=pe,_=N,V=F,z=Q;return b(),E(z,{show:t.value,"onUpdate:show":o[4]||(o[4]=w=>t.value=w)},{default:a(()=>[e(V,{style:{width:"500px"},title:y.item?"EDITAR REGISTRO":"NUEVO REGISTRO",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:a(()=>[e(C,{justify:"end"},{default:a(()=>[e(_,{tertiary:"",size:"large",onClick:o[3]||(o[3]=w=>t.value=!1),disabled:r.value},{default:a(()=>o[5]||(o[5]=[I(" Cancelar ")])),_:1},8,["disabled"]),e(_,{size:"large",type:"primary",onClick:v,loading:r.value},{default:a(()=>o[6]||(o[6]=[I("Guardar")])),_:1},8,["loading"])]),_:1})]),default:a(()=>[e(d,{ref_key:"formRef",ref:u,model:n.value,rules:f.value,size:"large"},{default:a(()=>[e(T,null,{default:a(()=>[e(S,{span:"24"},{default:a(()=>{var w;return[e(x,{path:"name",label:"Nombre",feedback:(w=l.value)==null?void 0:w.name},{default:a(()=>{var U;return[e(k,{status:((U=l.value)==null?void 0:U.name)!=null?"error":"",value:n.value.name,"onUpdate:value":o[0]||(o[0]=h=>n.value.name=h),onInput:o[1]||(o[1]=h=>l.value!=null?l.value.name=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1}),e(S,{span:"24"},{default:a(()=>[e(C,{justify:"end"},{default:a(()=>[e(x,{"label-placement":"left",label:"¿Habilitado?",path:"isEnabled","show-feedback":!1},{default:a(()=>[e($,{value:n.value.isEnabled,"onUpdate:value":o[2]||(o[2]=w=>n.value.isEnabled=w)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),Ee=R({__name:"Form",props:{item:{},level:{},modelValue:{type:Boolean}},emits:["update:modelValue","success"],setup(m,{emit:c}){const s=c,i=m,t=p([]),r=K({get:()=>i.modelValue,set:v=>s("update:modelValue",v)}),u=p(!1),n=p({}),l=async()=>{try{u.value=!0;const v=await ie();t.value=v}catch(v){console.error("Error fetching permissions:",v)}finally{u.value=!1}},f=async()=>{u.value=!0;let v=await re(n.value);v&&(s("success",v),r.value=!1),u.value=!1};return W(r,v=>{v&&(n.value=i.item,l())}),(v,g)=>{const y=be,o=Z,k=ge,x=ke,S=we,$=G,C=N,T=F,d=Q;return b(),E(d,{show:r.value,"onUpdate:show":g[2]||(g[2]=_=>r.value=_)},{default:a(()=>[e(T,{style:{width:"500px"},title:"Asignar Permisos",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:a(()=>[e(o,{justify:"end"},{default:a(()=>[e(C,{tertiary:"",size:"large",onClick:g[1]||(g[1]=_=>r.value=!1),disabled:u.value},{default:a(()=>g[3]||(g[3]=[I(" Cancelar ")])),_:1},8,["disabled"]),e(C,{size:"large",type:"primary",onClick:f,loading:u.value},{default:a(()=>g[4]||(g[4]=[I("Guardar")])),_:1},8,["loading"])]),_:1})]),default:a(()=>[e($,{style:{height:"500px",overflow:"auto"}},{default:a(()=>[e(S,{"default-expanded-names":"1",accordion:""},{default:a(()=>[(b(!0),A(D,null,j(t.value,(_,V)=>(b(),E(x,{key:V,name:V,title:_.display_name},{default:a(()=>[e(k,{value:n.value.permissions,"onUpdate:value":g[0]||(g[0]=z=>n.value.permissions=z),size:"large"},{default:a(()=>[e(o,{"item-style":"display: flex;"},{default:a(()=>[(b(!0),A(D,null,j(_.children,z=>(b(),E(y,{key:z.id,value:z.id,label:z.display_name},null,8,["value","label"]))),128))]),_:2},1024)]),_:2},1032,["value"])]),_:2},1032,["name","title"]))),128))]),_:1})]),_:1})]),_:1})]),_:1},8,["show"])}}}),Pe={style:{"border-bottom":"1px solid #e9e9e9"}},Se=R({__name:"DataTable",props:{level:{}},setup(m){const c=m,s=p(!1),i=p([]),t=p(!1),r=p(!1),u=p({}),n=te({...ee()}),l=p({search:null,page:n.page,pageSize:n.pageSize}),f=p({}),o=Ve(d=>{u.value=d,t.value=!0},async d=>{await me(d),await k()},d=>{u.value=d,r.value=!0}),k=async()=>{l.value.page=1,await x()},x=async()=>{s.value=!0,f.value=await ue(l.value),i.value=f.value.data,n.total=f.value.total,n.pageSize=f.value.per_page,n.page=f.value.current_page,n.pageCount=f.value.last_page,s.value=!1},S=xe(()=>{k()},400),$=async d=>{l.value.page=d,await x()},C=async d=>{l.value.page=1,l.value.pageSize=d,await x()};return(async()=>{l.value.filters={level:c.level},await x()})(),(d,_)=>{const V=X,z=Y,w=G,U=ye;return b(),A(D,null,[M("div",Pe,[e(w,{gutter:12,style:{padding:"12px 16px"}},{default:a(()=>[e(V,{span:12}),e(V,{span:12},{default:a(()=>[e(z,{size:"large",placeholder:"Buscar",value:l.value.search,"onUpdate:value":_[0]||(_[0]=h=>l.value.search=h),onInput:P(S),clearable:""},{suffix:a(()=>[e(J,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),e(w,null,{default:a(()=>[e(V,{span:24},{default:a(()=>[e(U,{key:"id",remote:"",size:"small","single-line":!1,columns:P(o),data:i.value,pagination:P(he)(n),"pagination-show-size-picker":!0,loading:s.value,"onUpdate:page":$,"onUpdate:pageSize":C},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),ne(d.$slots,"extra",{reLoadDataTable:k})]),e(ae,{modelValue:t.value,"onUpdate:modelValue":_[1]||(_[1]=h=>t.value=h),item:u.value,level:c.level,onSuccess:k},null,8,["modelValue","item","level"]),e(Ee,{modelValue:r.value,"onUpdate:modelValue":_[2]||(_[2]=h=>r.value=h),item:u.value,onSuccess:k,level:c.level},null,8,["modelValue","item","level"])],64)}}}),Ye=R({__name:"RoleAdminView",setup(m){const{hasPermission:c}=q(),s=p(!1);return(i,t)=>{const r=N,u=F,n=oe("AppNotAuthorization");return P(c)(["role-admin.create","role-admin.edit","role-admin.delete","role-admin.assign-permissions"])?(b(),A(D,{key:0},[e(u,{segmented:{header:!0,content:!0}},{header:a(()=>t[2]||(t[2]=[M("span",{class:"text-sm text-slate-500"}," Gestion de roles de administrador ",-1),M("h5",{class:"text-lg font-bold text-slate-800"},"Roles de Administrador",-1)])),"header-extra":a(()=>[P(c)(["role-admin.create"])?(b(),E(r,{key:0,type:"primary",size:"large","render-icon":P(B)("additem"),onClick:t[0]||(t[0]=l=>s.value=!0)},{default:a(()=>t[3]||(t[3]=[I(" Agregar ")])),_:1},8,["render-icon"])):L("",!0)]),_:1}),e(Se,{level:"admin"},{extra:a(({reLoadDataTable:l})=>[e(ae,{modelValue:s.value,"onUpdate:modelValue":t[1]||(t[1]=f=>s.value=f),item:null,onSuccess:l,level:"admin"},null,8,["modelValue","onSuccess"])]),_:1})],64)):(b(),E(n,{key:1}))}}});export{Ye as default};
