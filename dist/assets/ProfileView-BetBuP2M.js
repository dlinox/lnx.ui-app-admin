import{an as j,d as E,e as k,r as w,g as A,aa as S,a5 as G,a8 as s,ab as t,ah as C,af as U,ai as N,aj as L,cm as M,al as D,ad as r,ao as V,_ as H}from"./index-DErOr0AP.js";import{_ as T}from"./Input-j5r0X2o1.js";import{_ as J,a as K}from"./FormItem-n4kq_3-q.js";import{_ as Q,a as W}from"./Col-_50WYJb9.js";import{_ as X}from"./Space-DSo-Uj4Z.js";import{a as Y,_ as Z}from"./ListItem-BB_xTScW.js";import"./get-C_Ul0xsd.js";const B=()=>({password:"",newPassword:"",confirmPassword:""}),h=_=>({password:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}],newPassword:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}],confirmPassword:[{required:!0,trigger:["blur","input"],message:"Obligatorio"},{validator:(u,d,i)=>{d!==_.newPassword?i(new Error("Las contraseñas no coinciden")):i()},trigger:["blur","input"]}]}),ee=j(),te="/user/profile",ae=async _=>{try{return{status:!0,data:(await ee.post(`${te}/change-password`,_)).data.data}}catch(u){return u.response.status===422?{status:!1,data:u.response.data.errors}:{status:!1,data:null}}},se=E({__name:"Form",props:{modelValue:{type:Boolean}},emits:["update:modelValue","success"],setup(_,{emit:u}){const d=u,i=_,f=k({get:()=>i.modelValue,set:c=>d("update:modelValue",c)}),a=w(!1),v=w(null),n=w({...B()}),o=w(null),b=k(()=>h(n.value)),g=async()=>{if(v.value){const c=await v.value.validate();let e=null;c&&(a.value=!0,e=await ae(n.value),e.status?(d("success"),f.value=!1):o.value=e.data)}a.value=!1},R=()=>{n.value={...B()},o.value=null};return A(f,c=>{c&&(o.value=null,R())}),(c,e)=>{const x=T,P=J,y=Q,z=W,F=K,$=U,I=X,q=N,O=L;return S(),G(O,{show:f.value,"onUpdate:show":e[7]||(e[7]=l=>f.value=l)},{default:s(()=>[t(q,{style:{width:"500px"},title:"Cambiar contraseña",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:s(()=>[t(I,{justify:"end"},{default:s(()=>[t($,{tertiary:"",size:"large",onClick:e[6]||(e[6]=l=>f.value=!1),disabled:a.value},{default:s(()=>e[8]||(e[8]=[C(" Cancelar ")])),_:1},8,["disabled"]),t($,{size:"large",type:"primary",onClick:g,loading:a.value},{default:s(()=>e[9]||(e[9]=[C("Guardar")])),_:1},8,["loading"])]),_:1})]),default:s(()=>[t(F,{ref_key:"formRef",ref:v,model:n.value,rules:b.value,size:"large"},{default:s(()=>[t(z,null,{default:s(()=>[t(y,{span:"24"},{default:s(()=>{var l;return[t(P,{path:"password",label:"Contraseña",feedback:(l=o.value)==null?void 0:l.password},{default:s(()=>{var p;return[t(x,{placeholder:"Escribe tu contraseña",type:"password",status:((p=o.value)==null?void 0:p.password)!=null?"error":"",value:n.value.password,"onUpdate:value":e[0]||(e[0]=m=>n.value.password=m),onInput:e[1]||(e[1]=m=>o.value!=null?o.value.password=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1}),t(y,{span:"24"},{default:s(()=>{var l;return[t(P,{path:"newPassword",label:"Nueva contraseña",feedback:(l=o.value)==null?void 0:l.newPassword},{default:s(()=>{var p;return[t(x,{placeholder:"Escribe tu nueva contraseña",type:"password",status:((p=o.value)==null?void 0:p.newPassword)!=null?"error":"",value:n.value.newPassword,"onUpdate:value":e[2]||(e[2]=m=>n.value.newPassword=m),onInput:e[3]||(e[3]=m=>o.value!=null?o.value.newPassword=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1}),t(y,{span:"24"},{default:s(()=>{var l;return[t(P,{path:"confirmPassword",label:"Confirmar contraseña",feedback:(l=o.value)==null?void 0:l.confirmPassword},{default:s(()=>{var p;return[t(x,{placeholder:"Escribe tu nueva contraseña",type:"password",status:((p=o.value)==null?void 0:p.confirmPassword)!=null?"error":"",value:n.value.confirmPassword,"onUpdate:value":e[4]||(e[4]=m=>n.value.confirmPassword=m),onInput:e[5]||(e[5]=m=>o.value!=null?o.value.confirmPassword=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1},8,["show"])}}}),oe={class:"mx-auto mt-4 max-w-2xl px-4"},ne={class:"text-base font-bold text-slate-800"},le={class:"text-base font-bold text-slate-800"},re={class:"text-base font-bold text-slate-800"},ve=E({__name:"ProfileView",setup(_){const u=M(),d=w(!1),i=k(()=>u.authState.user);return(f,a)=>{const v=N,n=Y,o=U,b=Z;return S(),D(H,null,[t(v,{segmented:{header:!0,content:!0}},{header:s(()=>a[2]||(a[2]=[r("span",{class:"text-sm text-slate-500"}," Gestionar tu cuenta de usuario ",-1),r("h5",{class:"text-lg font-bold text-slate-800"},"Perfil de usuario",-1)])),_:1}),r("div",oe,[t(v,null,{default:s(()=>[t(b,null,{default:s(()=>[t(n,null,{default:s(()=>[a[3]||(a[3]=r("div",{class:"text-small text-slate-500"},"Nombre",-1)),r("div",ne,V(i.value.name),1)]),_:1}),t(n,null,{default:s(()=>[a[4]||(a[4]=r("div",{class:"text-small text-slate-500"},"Correo electrónico",-1)),r("div",le,V(i.value.email),1)]),_:1}),t(n,null,{default:s(()=>[a[5]||(a[5]=r("div",{class:"text-small text-slate-500"},"Rol",-1)),r("div",re,V(i.value.role),1)]),_:1}),t(n,null,{suffix:s(()=>[t(o,{onClick:a[0]||(a[0]=g=>d.value=!0),type:"primary"},{default:s(()=>a[6]||(a[6]=[C(" Cambiar contraseña ")])),_:1})]),default:s(()=>[a[7]||(a[7]=r("div",{class:"text-small text-slate-500"},"Contraseña",-1)),a[8]||(a[8]=r("div",{class:"text-base font-bold text-slate-800"},"************",-1))]),_:1})]),_:1})]),_:1}),t(se,{modelValue:d.value,"onUpdate:modelValue":a[1]||(a[1]=g=>d.value=g)},null,8,["modelValue"])])],64)}}});export{ve as default};
