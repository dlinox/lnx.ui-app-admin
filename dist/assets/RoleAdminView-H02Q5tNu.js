import{r as V}from"./icon.utils-BrUbkzNf.js";import{_ as K,a as Q,b as X,c as Y}from"./role.services-Bo6OE7EI.js";import{d as z,aa as E,a5 as F,a8 as n,ab as e,ag as M,af as T,h as P,e as Z,r as _,g as ee,ah as R,ai as A,aj as te,ak as ae,al as G,ad as h,ac as k,am as ne,_ as j}from"./index-DErOr0AP.js";import{_ as q}from"./Input-j5r0X2o1.js";import{_ as oe,a as le}from"./FormItem-n4kq_3-q.js";import{_ as H,a as L}from"./Col-_50WYJb9.js";import{_ as se}from"./Switch-KlYhZevK.js";import{_ as ie}from"./Space-DSo-Uj4Z.js";import{i as W}from"./DataTable.types-BfyqQUqo.js";import{u as re}from"./composables-CTqibouk.js";import{_ as ue}from"./Dropdown-D0l2jCAn.js";import{N as pe}from"./Select-Cy4RUJ2X.js";import{d as de}from"./debounce.utils-DqPPCsFD.js";import{_ as me}from"./DataTable-D03hb7st.js";import"./index-E0H31oqx.js";import"./get-C_Ul0xsd.js";import"./Tooltip-BqTXu7HV.js";const _e=z({__name:"DataTableOp",props:{item:{}},emits:["edit","delete"],setup(l,{emit:p}){const r=re(),t=p,u=[{label:"Editar",key:"edit",icon:V("edit-2"),props:{onClick:()=>t("edit")}},{label:"Eliminar",key:"delete",icon:V("trash","red"),props:{style:{color:"red"},onClick:()=>{r.warning({title:"Confirmar",content:"¿Está seguro que desea eliminar este registro?",positiveText:"Eliminar",negativeText:"Cancelar",closable:!1,showIcon:!1,negativeButtonProps:{secondary:!0,type:"tertiary",size:"large"},positiveButtonProps:{size:"large",type:"error"},onPositiveClick:()=>{t("delete")}})}}}];return(f,s)=>{const o=T,i=ue;return E(),F(i,{options:u,placement:"bottom-start"},{default:n(()=>[e(o,null,{default:n(()=>[e(M,{"icon-name":"setting-5",size:"20"})]),_:1})]),_:1})}}}),ce=(l,p)=>[{title:"Ops.",key:"ops",width:"80px",fixed:"left",render(r){const t=r;return P(_e,{onEdit:()=>{l(t)},onDelete:()=>{p(t)},item:t},{default:()=>"Editar"})}},{title:"Nombre",key:"name",minWidth:"300px"},{title:"Habilitado",key:"isEnabled",width:"150px",render:r=>P(pe,{type:r.isEnabled?"success":"error",tertiary:!0,bordered:!1,strong:!0},{default:()=>r.isEnabled?"	Habilitado":"Deshabilitado"})}],fe=(l=W())=>({page:l.page,total:l.total,pageSize:l.pageSize,pageCount:l.pageCount,showSizePicker:!0,pageSizes:[10,50,100,500,1e3,5e3],style:{paddingRight:"16px",paddingBottom:"12px"},prefix(){return`Total ${l.total} registros`}}),O=l=>({id:null,name:null,level:l,isEnabled:!0}),ge=()=>({name:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}]}),J=z({__name:"RoleForm",props:{item:{},level:{},modelValue:{type:Boolean}},emits:["update:modelValue","success"],setup(l,{emit:p}){const r=p,t=l,u=Z({get:()=>t.modelValue,set:d=>r("update:modelValue",d)}),f=_(!1),s=_(null),o=_(O(t.level)),i=_(null),$=_({...ge()}),B=async()=>{if(s.value){const d=await s.value.validate();let a=null;d?(f.value=!0,o.value.id?a=await K(o.value):a=await Q(o.value),a.status?(r("success"),u.value=!1):i.value=a.data):console.log("Formulario inválido")}f.value=!1},C=()=>{console.log("Inicializando formulario"),o.value=t.item?{...t.item}:O(t.level)};return ee(u,d=>{d&&(i.value=null,C())}),(d,a)=>{const I=q,b=oe,w=H,D=se,m=ie,g=L,v=le,y=T,x=A,S=te;return E(),F(S,{show:u.value,"onUpdate:show":a[4]||(a[4]=c=>u.value=c)},{default:n(()=>[e(x,{style:{width:"500px"},title:d.item?"EDITAR REGISTRO":"NUEVO REGISTRO",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:n(()=>[e(m,{justify:"end"},{default:n(()=>[e(y,{tertiary:"",size:"large",onClick:a[3]||(a[3]=c=>u.value=!1),disabled:f.value},{default:n(()=>a[5]||(a[5]=[R(" Cancelar ")])),_:1},8,["disabled"]),e(y,{size:"large",type:"primary",onClick:B,loading:f.value},{default:n(()=>a[6]||(a[6]=[R("Guardar")])),_:1},8,["loading"])]),_:1})]),default:n(()=>[e(v,{ref_key:"formRef",ref:s,model:o.value,rules:$.value,size:"large"},{default:n(()=>[e(g,null,{default:n(()=>[e(w,{span:"24"},{default:n(()=>{var c;return[e(b,{path:"name",label:"Nombre",feedback:(c=i.value)==null?void 0:c.name},{default:n(()=>{var U;return[e(I,{status:((U=i.value)==null?void 0:U.name)!=null?"error":"",value:o.value.name,"onUpdate:value":a[0]||(a[0]=N=>o.value.name=N),onInput:a[1]||(a[1]=N=>i.value!=null?i.value.name=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1}),e(w,{span:"24"},{default:n(()=>[e(m,{justify:"end"},{default:n(()=>[e(b,{"label-placement":"left",label:"¿Habilitado?",path:"isEnabled","show-feedback":!1},{default:n(()=>[e(D,{value:o.value.isEnabled,"onUpdate:value":a[2]||(a[2]=c=>o.value.isEnabled=c)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),ve={style:{"border-bottom":"1px solid #e9e9e9"}},be=z({__name:"DataTable",props:{level:{}},setup(l){const p=l,r=_(!1),t=_([]),u=_(!1),f=_(null),s=ae({...W()}),o=_({search:null,page:s.page,pageSize:s.pageSize}),i=_({}),C=ce(m=>{f.value=m,u.value=!0},async m=>{await Y(m),await d()}),d=async()=>{o.value.page=1,await a()},a=async()=>{r.value=!0,i.value=await X(o.value),t.value=i.value.data,s.total=i.value.total,s.pageSize=i.value.per_page,s.page=i.value.current_page,s.pageCount=i.value.last_page,r.value=!1},I=de(()=>{d()},400),b=async m=>{o.value.page=m,await a()},w=async m=>{o.value.page=1,o.value.pageSize=m,await a()};return(async()=>{o.value.filters={level:p.level},await a()})(),(m,g)=>{const v=H,y=q,x=L,S=me;return E(),G(j,null,[h("div",ve,[e(x,{gutter:12,style:{padding:"12px 16px"}},{default:n(()=>[e(v,{span:12}),e(v,{span:12},{default:n(()=>[e(y,{size:"large",placeholder:"Buscar",value:o.value.search,"onUpdate:value":g[0]||(g[0]=c=>o.value.search=c),onInput:k(I),clearable:""},{suffix:n(()=>[e(M,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),e(x,null,{default:n(()=>[e(v,{span:24},{default:n(()=>[e(S,{key:"id",remote:"","single-line":!1,columns:k(C),data:t.value,pagination:k(fe)(s),"pagination-show-size-picker":!0,loading:r.value,"onUpdate:page":b,"onUpdate:pageSize":w},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),ne(m.$slots,"extra",{reLoadDataTable:d})]),e(J,{modelValue:u.value,"onUpdate:modelValue":g[1]||(g[1]=c=>u.value=c),item:f.value,level:p.level,onSuccess:d},null,8,["modelValue","item","level"])],64)}}}),Ne=z({__name:"RoleAdminView",setup(l){const p=_(!1);return(r,t)=>{const u=T,f=A;return E(),G(j,null,[e(f,{segmented:{header:!0,content:!0}},{header:n(()=>t[2]||(t[2]=[h("span",{class:"text-sm text-slate-500"}," Gestion de roles de administrador ",-1),h("h5",{class:"text-lg font-bold text-slate-800"},"Roles de Administrador",-1)])),"header-extra":n(()=>[e(u,{"render-icon":k(V)("additem"),onClick:t[0]||(t[0]=s=>p.value=!0)},{default:n(()=>t[3]||(t[3]=[R(" Agregar ")])),_:1},8,["render-icon"])]),_:1}),e(be,{level:"admin"},{extra:n(({reLoadDataTable:s})=>[e(J,{modelValue:p.value,"onUpdate:modelValue":t[1]||(t[1]=o=>p.value=o),item:null,onSuccess:s,level:"admin"},null,8,["modelValue","onSuccess"])]),_:1})],64)}}});export{Ne as default};
