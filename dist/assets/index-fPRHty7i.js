import{r as h}from"./icon.utils-6fJ-3dCS.js";import{_ as Q,a as X,b as Y,c as Z}from"./area.services-BHoFh0p5.js";import{d as O,a8 as N,a9 as S,aa as a,ab as e,af as B,aG as G,h as A,e as ee,r as p,j as te,aA as M,az as T,aH as ae,a4 as ne,aI as oe,aF as q,_ as H,ae as R,aJ as le,ad as E}from"./index-DRqPu8js.js";import{_ as ue,a as se}from"./FormItem-B0e_KJJq.js";import{_ as j,a as W}from"./Col-CNgfr2Vq.js";import{_ as J}from"./Input-PHuG5EIV.js";import{_ as re}from"./Select-Bhk-Lp7D.js";import{_ as ie}from"./Space-DpUkt9IF.js";import{_ as pe}from"./Switch-C8iQr2Sc.js";import{i as L}from"./DataTable.types-BEg5m_To.js";import{u as me}from"./composables-CNUmupj0.js";import{_ as ce}from"./Dropdown-hwViG8Gw.js";import{_ as de}from"./Tag-DIW11yL8.js";import{d as _e}from"./debounce.utils-DqPPCsFD.js";import{_ as fe}from"./DataTable-B0gpVXZr.js";import{_ as ge}from"./selectables.services-BQd8Oz6S.js";import"./get-CdE2f0gc.js";import"./Suffix-DbP13eKO.js";import"./use-merged-state-dfDog2av.js";import"./Popover-DfaujfXt.js";import"./Tooltip-lejxWDdy.js";const ve=O({__name:"DataTableOp",props:{item:{}},emits:["edit","delete"],setup(c,{emit:_}){const l=me(),s=_,d=[{label:"Editar",key:"edit",icon:h("edit-2"),props:{onClick:()=>s("edit")}},{label:"Eliminar",key:"delete",icon:h("trash","red"),props:{style:{color:"red"},onClick:()=>{l.warning({title:"Confirmar",content:"¿Está seguro que desea eliminar este registro?",positiveText:"Eliminar",negativeText:"Cancelar",closable:!1,showIcon:!1,negativeButtonProps:{secondary:!0,type:"tertiary",size:"large"},positiveButtonProps:{size:"large",type:"error"},onPositiveClick:()=>{s("delete")}})}}}];return(u,r)=>{const o=B,n=ce;return S(),N(n,{options:d,placement:"bottom-start"},{default:a(()=>[e(o,null,{default:a(()=>[e(G,{"icon-name":"setting-5",size:"20"})]),_:1})]),_:1})}}}),be=(c,_)=>[{title:"Ops.",key:"ops",width:"80px",fixed:"left",render(l){const s=l;return A(ve,{onEdit:()=>{c(s)},onDelete:()=>{_(s)},item:s},{default:()=>"Editar"})}},{title:"Nombre",key:"name",minWidth:"200px"},{title:"Currículo",key:"curriculum",minWidth:"200px"},{title:"Habilitado",key:"isEnabled",width:"150px",render:l=>A(de,{type:l.isEnabled?"success":"error",tertiary:!0,bordered:!1,strong:!0},{default:()=>l.isEnabled?"	Habilitado":"Deshabilitado"})}],ye=(c=L())=>({page:c.page,total:c.total,pageSize:c.pageSize,pageCount:c.pageCount,showSizePicker:!0,pageSizes:[10,50,100,500,1e3,5e3],style:{paddingRight:"16px",paddingBottom:"12px"},prefix(){return`Total ${c.total} registros`}}),F=()=>({id:null,name:null,curriculumId:null,isEnabled:!0}),we=()=>({name:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}],curriculumId:[{type:"number",required:!0,trigger:["blur","input"],message:"Obligatorio"}]}),K=O({__name:"AreaForm",props:{item:{},modelValue:{type:Boolean},curriculumOptions:{}},emits:["update:modelValue","success"],setup(c,{emit:_}){const l=_,s=c,d=ee({get:()=>s.modelValue,set:g=>l("update:modelValue",g)}),u=p(!1),r=p(null),o=p(F()),n=p(null),f=p({...we()}),D=async()=>{if(r.value){const g=await r.value.validate();let t=null;g?(u.value=!0,o.value.id?t=await Q(o.value):t=await X(o.value),t.status?(l("success"),d.value=!1):n.value=t.data):console.log("Formulario inválido")}u.value=!1},U=()=>{console.log("Inicializando formulario"),o.value=s.item?{...s.item}:F()};return te(d,g=>{g&&U()}),(g,t)=>{const v=J,y=se,w=W,V=re,P=pe,m=ie,b=j,I=ue,z=B,C=M,$=ae;return S(),N($,{show:d.value,"onUpdate:show":t[6]||(t[6]=i=>d.value=i)},{default:a(()=>[e(C,{style:{width:"500px"},title:g.item?"EDITAR REGISTRO":"NUEVO REGISTRO",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:a(()=>[e(m,{justify:"end"},{default:a(()=>[e(z,{tertiary:"",size:"large",onClick:t[5]||(t[5]=i=>d.value=!1),disabled:u.value},{default:a(()=>t[7]||(t[7]=[T(" Cancelar ")])),_:1},8,["disabled"]),e(z,{size:"large",type:"primary",onClick:D,loading:u.value},{default:a(()=>t[8]||(t[8]=[T("Guardar")])),_:1},8,["loading"])]),_:1})]),default:a(()=>[e(I,{ref_key:"formRef",ref:r,model:o.value,rules:f.value,size:"large"},{default:a(()=>[e(b,null,{default:a(()=>[e(w,{span:"24"},{default:a(()=>{var i;return[e(y,{path:"name",label:"Nombre",feedback:(i=n.value)==null?void 0:i.name},{default:a(()=>{var x;return[e(v,{status:((x=n.value)==null?void 0:x.name)!=null?"error":"",value:o.value.name,"onUpdate:value":t[0]||(t[0]=k=>o.value.name=k),onInput:t[1]||(t[1]=k=>n.value!=null?n.value.name=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1}),e(w,{span:"24"},{default:a(()=>{var i;return[e(y,{path:"curriculumId",label:"Plan de estudios",feedback:(i=n.value)==null?void 0:i.curriculumId},{default:a(()=>{var x;return[e(V,{clearable:"",placeholder:"Seleccione un plan de estudios",value:o.value.curriculumId,"onUpdate:value":t[2]||(t[2]=k=>o.value.curriculumId=k),options:g.curriculumOptions,"virtual-scroll":!1,status:((x=n.value)==null?void 0:x.curriculumId)!=null?"error":"",onInput:t[3]||(t[3]=k=>n.value!=null?n.value.curriculumId=null:()=>{})},null,8,["value","options","status"])]}),_:1},8,["feedback"])]}),_:1}),e(w,{span:"24"},{default:a(()=>[e(m,{justify:"end"},{default:a(()=>[e(y,{"label-placement":"left",label:"¿Habilitado?",path:"isEnabled","show-feedback":!1},{default:a(()=>[e(P,{value:o.value.isEnabled,"onUpdate:value":t[4]||(t[4]=i=>o.value.isEnabled=i)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),Ie={style:{"border-bottom":"1px solid #e9e9e9"}},xe=O({__name:"DataTable",props:{curriculumOptions:{}},setup(c){const _=ne(),l=p(!1),s=p([]),d=p(!1),u=p(null),r=oe({...L()}),o=p(""),n=p({search:null,page:r.page,pageSize:r.pageSize}),f=p({}),g=be(m=>{u.value=m,d.value=!0},async m=>{await Z(m),await t()}),t=async()=>{n.value.page=1,await v()},v=async()=>{l.value=!0,n.value.filters={curriculumId:o.value},f.value=await Y(n.value),s.value=f.value.data,r.total=f.value.total,r.pageSize=f.value.per_page,r.page=f.value.current_page,r.pageCount=f.value.last_page,l.value=!1},y=_e(()=>{t()},400),w=async m=>{n.value.page=m,await v()},V=async m=>{n.value.page=1,n.value.pageSize=m,await v()};return(async()=>{o.value=_.params.id??"",await v()})(),(m,b)=>{const I=W,z=J,C=j,$=fe;return S(),q(H,null,[R("div",Ie,[e(C,{gutter:12,style:{padding:"12px 16px"}},{default:a(()=>[e(I,{span:12}),e(I,{span:12},{default:a(()=>[e(z,{size:"large",placeholder:"Buscar",value:n.value.search,"onUpdate:value":b[0]||(b[0]=i=>n.value.search=i),onInput:E(y),clearable:""},{suffix:a(()=>[e(G,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),e(C,null,{default:a(()=>[e(I,{span:24},{default:a(()=>[e($,{key:"id",remote:"","single-line":!1,columns:E(g),data:s.value,pagination:E(ye)(r),"pagination-show-size-picker":!0,loading:l.value,"onUpdate:page":w,"onUpdate:pageSize":V},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),le(m.$slots,"extra",{reLoadDataTable:t})]),e(K,{modelValue:d.value,"onUpdate:modelValue":b[1]||(b[1]=i=>d.value=i),curriculumOptions:m.curriculumOptions,item:u.value,onSuccess:t},null,8,["modelValue","curriculumOptions","item"])],64)}}}),He=O({__name:"index",setup(c){const _=p([]),l=p(!1);return(async()=>{_.value=await ge()})(),(d,u)=>{const r=B,o=M;return S(),q(H,null,[e(o,{segmented:{header:!0,content:!0}},{header:a(()=>u[2]||(u[2]=[R("span",{class:"text-sm text-slate-500"}," Gestión de Areas academicas ",-1),R("h5",{class:"text-lg font-bold text-slate-800"},"Areas",-1)])),"header-extra":a(()=>[e(r,{"render-icon":E(h)("additem"),onClick:u[0]||(u[0]=n=>l.value=!0)},{default:a(()=>u[3]||(u[3]=[T(" Agregar ")])),_:1},8,["render-icon"])]),_:1}),e(xe,{curriculumOptions:_.value},{extra:a(({reLoadDataTable:n})=>[e(K,{modelValue:l.value,"onUpdate:modelValue":u[1]||(u[1]=f=>l.value=f),curriculumOptions:_.value,item:null,onSuccess:n},null,8,["modelValue","curriculumOptions","onSuccess"])]),_:1},8,["curriculumOptions"])],64)}}});export{He as default};
