import{r as U,i as O,a as Q}from"./DataTable.types-CTwUvM75.js";import{d as S,a9 as V,a4 as F,a6 as t,aa as e,ah as M,ag as B,h as P,an as T,e as X,r as _,g as Y,ae as I,ai as G,aj as Z,ak as ee,al as j,ac as q,ab as E,am as ae,_ as H}from"./index-B-obX2sB.js";import{_ as A}from"./Input-unfOrBbM.js";import{_ as te,a as ne}from"./FormItem-U3eICQ5G.js";import{N as oe,_ as W,a as le,b as J}from"./Col-DAD-ZKcB.js";import{_ as se}from"./Switch-BnMiMAa5.js";import{u as re,_ as ue}from"./composables-CZWT4bjQ.js";import{_ as ie}from"./Dropdown-WWEjU7w1.js";import{d as de}from"./debounce.utils-DqPPCsFD.js";import"./get-2ABWGPF1.js";import"./Forward-DoJ_oC4p.js";import"./use-keyboard-C5I-QWKR.js";const pe=S({__name:"DataTableOp",props:{item:{}},emits:["edit","delete"],setup(s,{emit:n}){const d=re(),l=n,c=[{label:"Editar",key:"edit",icon:U("edit-2"),props:{onClick:()=>l("edit")}},{label:"Eliminar",key:"delete",icon:U("trash","red"),props:{style:{color:"red"},onClick:()=>{d.warning({title:"Confirmar",content:"¿Está seguro que desea eliminar este registro?",positiveText:"Eliminar",negativeText:"Cancelar",closable:!1,showIcon:!1,negativeButtonProps:{secondary:!0,type:"tertiary",size:"large"},positiveButtonProps:{size:"large",type:"error"},onPositiveClick:()=>{l("delete")}})}}}];return(u,i)=>{const o=B,r=ie;return V(),F(r,{options:c,placement:"bottom-start"},{default:t(()=>[e(o,null,{default:t(()=>[e(M,{"icon-name":"setting-5",size:"20"})]),_:1})]),_:1})}}}),ce=(s,n)=>[{title:"Ops.",key:"ops",width:"80px",fixed:"left",render(d){const l=d;return P(pe,{onEdit:()=>{s(l)},onDelete:()=>{n(l)},item:l},{default:()=>"Editar"})}},{title:"Nombre",key:"name",minWidth:"300px"},{title:"Habilitado",key:"isEnabled",width:"150px",render:d=>P(oe,{type:d.isEnabled?"success":"error",tertiary:!0,bordered:!1,strong:!0},{default:()=>d.isEnabled?"	Habilitado":"Deshabilitado"})}],me=(s=O())=>({page:s.page,total:s.total,pageSize:s.pageSize,pageCount:s.pageCount,showSizePicker:!0,pageSizes:[10,50,100,500,1e3,5e3],style:{paddingRight:"16px",paddingBottom:"12px"},prefix(){return`Total ${s.total} registros`}}),L=()=>({id:null,name:null,deviceCount:0,deviceDetail:null,isEnabled:!0}),_e=()=>({name:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}]}),ve=async s=>{try{return(await T().post("/laboratory/load-data-table",s)).data.data}catch{return Q()}},fe=async s=>{try{return{status:!0,data:(await T().post("/laboratory",s)).data.data}}catch(n){return n.response.status===422?{status:!1,data:n.response.data.errors}:{status:!1,data:null}}},ge=async s=>{try{return{status:!0,data:(await T().put("/laboratory",s)).data.data}}catch(n){return n.response.status===422?{status:!1,data:n.response.data.errors}:{status:!1,data:null}}},be=async s=>{try{return await T().delete("/laboratory",{data:{id:s.id}}),!0}catch{return!1}},K=S({__name:"LaboratoryForm",props:{item:{},modelValue:{type:Boolean}},emits:["update:modelValue","success"],setup(s,{emit:n}){const d=n,l=s,c=X({get:()=>l.modelValue,set:m=>d("update:modelValue",m)}),u=_(!1),i=_(null),o=_(L()),r=_(null),N=_({..._e()}),h=async()=>{if(i.value){const m=await i.value.validate();let a=null;m?(u.value=!0,o.value.id?a=await ge(o.value):a=await fe(o.value),a.status?(d("success"),c.value=!1):r.value=a.data):console.log("Formulario inválido")}u.value=!1},y=()=>{console.log("Inicializando formulario"),o.value=l.item?{...l.item}:L()};return Y(c,m=>{m&&y()}),(m,a)=>{const k=A,w=te,C=W,v=se,b=le,x=J,$=ne,z=B,R=G,D=Z;return V(),F(D,{show:c.value,"onUpdate:show":a[8]||(a[8]=p=>c.value=p)},{default:t(()=>[e(R,{style:{width:"500px"},title:m.item?"EDITAR REGISTRO":"NUEVO REGISTRO",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:t(()=>[e(b,{justify:"end"},{default:t(()=>[e(z,{tertiary:"",size:"large",onClick:a[7]||(a[7]=p=>c.value=!1),disabled:u.value},{default:t(()=>a[9]||(a[9]=[I(" Cancelar ")])),_:1},8,["disabled"]),e(z,{size:"large",type:"primary",onClick:h,loading:u.value},{default:t(()=>a[10]||(a[10]=[I("Guardar")])),_:1},8,["loading"])]),_:1})]),default:t(()=>[e($,{ref_key:"formRef",ref:i,model:o.value,rules:N.value,size:"large"},{default:t(()=>[e(x,null,{default:t(()=>[e(C,{span:"24"},{default:t(()=>{var p;return[e(w,{path:"name",label:"Nombre",feedback:(p=r.value)==null?void 0:p.name},{default:t(()=>{var f;return[e(k,{status:((f=r.value)==null?void 0:f.name)!=null?"error":"",value:o.value.name,"onUpdate:value":a[0]||(a[0]=g=>o.value.name=g),onInput:a[1]||(a[1]=g=>r.value!=null?r.value.name=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1}),e(C,{span:"24"},{default:t(()=>{var p;return[e(w,{path:"deviceCount",label:"Cantidad de dispositivos",feedback:(p=r.value)==null?void 0:p.deviceCount},{default:t(()=>{var f;return[e(k,{status:((f=r.value)==null?void 0:f.deviceCount)!=null?"error":"",value:o.value.deviceCount,"onUpdate:value":a[2]||(a[2]=g=>o.value.deviceCount=g),onInput:a[3]||(a[3]=g=>r.value!=null?r.value.deviceCount=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1}),e(C,{span:"24"},{default:t(()=>{var p;return[e(w,{path:"deviceDetail",label:"Detalle de dispositivos",feedback:(p=r.value)==null?void 0:p.deviceDetail},{default:t(()=>{var f;return[e(k,{status:((f=r.value)==null?void 0:f.deviceDetail)!=null?"error":"",value:o.value.deviceDetail,"onUpdate:value":a[4]||(a[4]=g=>o.value.deviceDetail=g),onInput:a[5]||(a[5]=g=>r.value!=null?r.value.deviceDetail=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1}),e(C,{span:"24"},{default:t(()=>[e(b,{justify:"end"},{default:t(()=>[e(w,{"label-placement":"left",label:"¿Habilitado?",path:"isEnabled","show-feedback":!1},{default:t(()=>[e(v,{value:o.value.isEnabled,"onUpdate:value":a[6]||(a[6]=p=>o.value.isEnabled=p)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),ye={style:{"border-bottom":"1px solid #e9e9e9"}},we=S({__name:"DataTable",setup(s){const n=_(!1),d=_([]),l=_(!1),c=_(null),u=ee({...O()}),i=_({search:null,page:u.page,pageSize:u.pageSize}),o=_({}),h=ce(v=>{c.value=v,l.value=!0},async v=>{await be(v),await y()}),y=async()=>{i.value.page=1,await m()},m=async()=>{n.value=!0,o.value=await ve(i.value),d.value=o.value.data,u.total=o.value.total,u.pageSize=o.value.per_page,u.page=o.value.current_page,u.pageCount=o.value.last_page,n.value=!1},a=de(()=>{y()},400),k=async v=>{i.value.page=v,await m()},w=async v=>{i.value.page=1,i.value.pageSize=v,await m()};return(async()=>{await m()})(),(v,b)=>{const x=W,$=A,z=J,R=ue;return V(),j(H,null,[q("div",ye,[e(z,{gutter:12,style:{padding:"12px 16px"}},{default:t(()=>[e(x,{span:12}),e(x,{span:12},{default:t(()=>[e($,{size:"large",placeholder:"Buscar",value:i.value.search,"onUpdate:value":b[0]||(b[0]=D=>i.value.search=D),onInput:E(a),clearable:""},{suffix:t(()=>[e(M,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),e(z,null,{default:t(()=>[e(x,{span:24},{default:t(()=>[e(R,{key:"id",remote:"","single-line":!1,columns:E(h),data:d.value,pagination:E(me)(u),"pagination-show-size-picker":!0,loading:n.value,"onUpdate:page":k,"onUpdate:pageSize":w},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),ae(v.$slots,"extra",{reLoadDataTable:y})]),e(K,{modelValue:l.value,"onUpdate:modelValue":b[1]||(b[1]=D=>l.value=D),item:c.value,onSuccess:y},null,8,["modelValue","item"])],64)}}}),Re=S({__name:"index",setup(s){const n=_(!1);return(d,l)=>{const c=B,u=G;return V(),j(H,null,[e(u,{segmented:{header:!0,content:!0}},{header:t(()=>l[2]||(l[2]=[q("h6",{style:{color:"#999",margin:"0"}},"Gestión de Laboratorys academicas",-1),I(" Laboratorys ")])),"header-extra":t(()=>[e(c,{"render-icon":E(U)("additem"),onClick:l[0]||(l[0]=i=>n.value=!0)},{default:t(()=>l[3]||(l[3]=[I(" Agregar ")])),_:1},8,["render-icon"])]),_:1}),e(we,null,{extra:t(({reLoadDataTable:i})=>[e(K,{modelValue:n.value,"onUpdate:modelValue":l[1]||(l[1]=o=>n.value=o),item:null,onSuccess:i},null,8,["modelValue","onSuccess"])]),_:1})],64)}}});export{Re as default};
