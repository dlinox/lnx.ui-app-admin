import{r as V,i as A,a as ee}from"./DataTable.types-BjrSoKaL.js";import{G as ae}from"./genders.constans-ZqlXwVVz.js";import{u as te}from"./useBreakpoints-DHc7VBYg.js";import{d as D,a9 as U,a4 as G,a6 as t,aa as e,ah as W,ag as B,h as $,an as E,e as le,r as y,g as ne,ae as F,ab as _,ai as q,aj as oe,ak as se,al as j,ac as H,am as ue,_ as L}from"./index-DvYzMf2M.js";import{_ as J}from"./Input-BCz2VVQV.js";import{_ as re,a as ie}from"./FormItem-YPSbYUsQ.js";import{N as P,_ as K,c as de,a as pe,b as Q}from"./Col-CIH6lTu0.js";import{_ as me}from"./Switch-BXlFdt54.js";import{d as ce}from"./debounce.utils-DqPPCsFD.js";import{u as _e,_ as ve}from"./composables-DRgl5ljF.js";import{_ as fe}from"./Dropdown-DsRfH9bj.js";import{d as ge}from"./documentType.services-BSbOnC-G.js";import"./get-uXzlwZRV.js";import"./Forward-B-RFULzP.js";import"./use-keyboard-CQ_fFCxs.js";const be=D({__name:"DataTableOp",props:{item:{}},emits:["edit","delete"],setup(s,{emit:o}){const d=o,u=_e(),p=[{label:"Editar",key:"edit",icon:V("edit-2"),props:{onClick:()=>d("edit")}},{label:"Eliminar",key:"delete",icon:V("trash","red"),props:{style:{color:"red"},onClick:()=>{u.warning({title:"Confirmar",content:"¿Está seguro que desea eliminar este registro?",positiveText:"Eliminar",negativeText:"Cancelar",closable:!1,showIcon:!1,negativeButtonProps:{secondary:!0,type:"tertiary",size:"large"},positiveButtonProps:{size:"large",type:"error"},onPositiveClick:()=>{d("delete")}})}}}];return(m,c)=>{const v=B,l=fe;return U(),G(l,{options:p,placement:"bottom-start"},{default:t(()=>[e(v,null,{default:t(()=>[e(W,{"icon-name":"setting-5",size:"20"})]),_:1})]),_:1})}}}),ye=(s,o)=>[{title:"Ops.",key:"ops",width:"80px",fixed:"left",render(d){const u=d;return $(be,{onEdit:()=>{s(u)},onDelete:()=>{o(u)},item:u},{default:()=>"Editar"})}},{title:"Codigo",key:"code",minWidth:"120px"},{title:"Número de documento",key:"documentNumber",minWidth:"120px"},{title:"Nombre",key:"name",minWidth:"120px"},{title:"Apellido Paterno",key:"lastNameFather",minWidth:"120px"},{title:"Apellido Materno",key:"lastNameMother",minWidth:"120px"},{title:"Género",key:"gender",minWidth:"150px",render:d=>$(P,{tertiary:!0,bordered:!1,strong:!0},{default:()=>d.gender===1?"MASCULINO":d.gender===2?"FEMENINO":"NO ESPECIFICADO"})},{title:"Email",key:"email",minWidth:"80px"},{title:"Teléfono",key:"phone",minWidth:"100px"},{title:"Habilitado",key:"isEnabled",width:"150px",render:d=>$(P,{type:d.isEnabled?"success":"error",tertiary:!0,bordered:!1,strong:!0},{default:()=>d.isEnabled?"	Habilitado":"Deshabilitado"})}],he=(s=A())=>({page:s.page,total:s.total,pageSize:s.pageSize,pageCount:s.pageCount,showSizePicker:!0,pageSizes:[10,50,100,500,1e3,5e3],style:{paddingRight:"16px",paddingBottom:"12px"},prefix(){return`Total ${s.total} registros`}}),O=()=>({id:null,personId:null,code:null,documentTypeId:1,documentNumber:null,name:null,lastNameFather:null,lastNameMother:null,gender:null,email:null,phone:null,address:null,isEnabled:!0}),Ne=()=>({code:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}],documentNumber:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}],name:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}],lastNameFather:[],lastNameMother:[],gender:[],email:[],phone:[],address:[],TeacherTypeId:[{type:"number",required:!0,trigger:["blur","input"],message:"Obligatorio"}]}),ke=async s=>{try{return(await E().post("/teacher/load-data-table",s)).data.data}catch{return ee()}},we=async s=>{try{return(await E().get(`/teacher/item/by-id/${s}`)).data.data}catch{return O()}},Ie=async s=>{try{return{status:!0,data:(await E().post("/teacher",s)).data.data}}catch(o){return o.response.status===422?{status:!1,data:o.response.data.errors}:{status:!1,data:null}}},Te=async s=>{try{return{status:!0,data:(await E().put("/teacher",s)).data.data}}catch(o){return o.response.status===422?{status:!1,data:o.response.data.errors}:{status:!1,data:null}}},xe=async s=>{try{return await E().delete("/teacher",{data:{id:s.id}}),!0}catch{return!1}},X=D({__name:"TeacherForm",props:{item:{},modelValue:{type:Boolean},selectables:{}},emits:["update:modelValue","success"],setup(s,{emit:o}){const d=o,u=s,{screenSize:p}=te(),m=le({get:()=>u.modelValue,set:b=>d("update:modelValue",b)}),c=y(!1),v=y(null),l=y(O()),r=y(null),R=y({...Ne()}),S=async()=>{if(console.log("formRef",l.value),v.value){const b=await v.value.validate();let a=null;b?(c.value=!0,l.value.id?a=await Te(l.value):a=await Ie(l.value),a.status?(d("success"),m.value=!1):r.value=a.data):console.log("Formulario inválido")}c.value=!1},w=async()=>{var b;return(b=u.item)!=null&&b.id?l.value=await we(u.item.id):l.value=O(),l.value},I=async()=>{console.log("Inicializando formulario"),await w()};return ne(m,b=>{b&&I()}),(b,a)=>{const N=J,h=re,i=K,k=de,x=me,C=pe,z=Q,M=ie,T=B,Y=q,Z=oe;return U(),G(Z,{show:m.value,"onUpdate:show":a[17]||(a[17]=n=>m.value=n)},{default:t(()=>[e(Y,{style:{width:"1024px"},title:b.item?"EDITAR REGISTRO":"NUEVO REGISTRO",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:t(()=>[e(C,{justify:"end"},{default:t(()=>[e(T,{tertiary:"",size:"large",onClick:a[16]||(a[16]=n=>m.value=!1),disabled:c.value},{default:t(()=>a[18]||(a[18]=[F(" Cancelar ")])),_:1},8,["disabled"]),e(T,{size:"large",type:"primary",onClick:S,loading:c.value},{default:t(()=>a[19]||(a[19]=[F("Guardar")])),_:1},8,["loading"])]),_:1})]),default:t(()=>[e(M,{ref_key:"formRef",ref:v,model:l.value,rules:R.value,size:"large",onSubmit:S},{default:t(()=>[e(z,{gutter:16},{default:t(()=>[e(i,{span:_(p)==="sm"?12:8},{default:t(()=>{var n;return[e(h,{path:"code",label:"Código",feedback:(n=r.value)==null?void 0:n.code},{default:t(()=>{var f;return[e(N,{value:l.value.code,"onUpdate:value":a[0]||(a[0]=g=>l.value.code=g),status:((f=r.value)==null?void 0:f.code)!=null?"error":"",onInput:a[1]||(a[1]=g=>r.value!=null?r.value.code=null:()=>{})},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),e(i,{span:_(p)==="sm"?12:8},{default:t(()=>[e(h,{path:"documentTypeId",label:"Tipo de Documento"},{default:t(()=>[e(k,{value:l.value.documentTypeId,"onUpdate:value":a[2]||(a[2]=n=>l.value.documentTypeId=n),clearable:"","virtual-scroll":!1,placeholder:"Seleccione",options:b.selectables.documentTypesItems},null,8,["value","options"])]),_:1})]),_:1},8,["span"]),e(i,{span:_(p)==="sm"?12:8},{default:t(()=>{var n;return[e(h,{path:"documentNumber",label:"Número de Documento",feedback:(n=r.value)==null?void 0:n.documentNumber},{default:t(()=>{var f;return[e(N,{value:l.value.documentNumber,"onUpdate:value":a[3]||(a[3]=g=>l.value.documentNumber=g),status:((f=r.value)==null?void 0:f.documentNumber)!=null?"error":"",onInput:a[4]||(a[4]=g=>r.value!=null?r.value.documentNumber=null:()=>{})},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),e(i,{span:_(p)==="sm"?24:8},{default:t(()=>{var n;return[e(h,{path:"name",label:"Nombre",feedback:(n=r.value)==null?void 0:n.name},{default:t(()=>{var f;return[e(N,{status:((f=r.value)==null?void 0:f.name)!=null?"error":"",value:l.value.name,"onUpdate:value":a[5]||(a[5]=g=>l.value.name=g),onInput:a[6]||(a[6]=g=>r.value!=null?r.value.name=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),e(i,{span:_(p)==="sm"?12:8},{default:t(()=>{var n;return[e(h,{path:"lastNameFather",label:"Apellido Paterno",feedback:(n=r.value)==null?void 0:n.lastNameFather},{default:t(()=>{var f;return[e(N,{status:((f=r.value)==null?void 0:f.lastNameFather)!=null?"error":"",value:l.value.lastNameFather,"onUpdate:value":a[7]||(a[7]=g=>l.value.lastNameFather=g),onInput:a[8]||(a[8]=g=>r.value!=null?r.value.lastNameFather=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),e(i,{span:_(p)==="sm"?12:8},{default:t(()=>{var n;return[e(h,{path:"lastNameMother",label:"Apellido Materno",feedback:(n=r.value)==null?void 0:n.lastNameMother},{default:t(()=>{var f;return[e(N,{status:((f=r.value)==null?void 0:f.lastNameMother)!=null?"error":"",value:l.value.lastNameMother,"onUpdate:value":a[9]||(a[9]=g=>l.value.lastNameMother=g),onInput:a[10]||(a[10]=g=>r.value!=null?r.value.lastNameMother=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),e(i,{span:_(p)==="sm"?12:6},{default:t(()=>[e(h,{path:"gender",label:"Genero"},{default:t(()=>[e(k,{value:l.value.gender,"onUpdate:value":a[11]||(a[11]=n=>l.value.gender=n),clearable:"",placeholder:"Seleccione","virtual-scroll":!1,options:_(ae)},null,8,["value","options"])]),_:1})]),_:1},8,["span"]),e(i,{span:_(p)==="sm"?12:6},{default:t(()=>[e(h,{path:"birthDate",label:"Fecha de Nacimiento"},{default:t(()=>[e(N,{value:l.value.dateOfBirth,"onUpdate:value":a[12]||(a[12]=n=>l.value.dateOfBirth=n),type:"date",clearable:"",placeholder:""},null,8,["value"])]),_:1})]),_:1},8,["span"]),e(i,{span:_(p)==="sm"?12:6},{default:t(()=>[e(h,{path:"email",label:"Correo Electrónico"},{default:t(()=>[e(N,{value:l.value.email,"onUpdate:value":a[13]||(a[13]=n=>l.value.email=n)},null,8,["value"])]),_:1})]),_:1},8,["span"]),e(i,{span:_(p)==="sm"?12:6},{default:t(()=>[e(h,{path:"phone",label:"Teléfono"},{default:t(()=>[e(N,{value:l.value.phone,"onUpdate:value":a[14]||(a[14]=n=>l.value.phone=n)},null,8,["value"])]),_:1})]),_:1},8,["span"]),e(i,{span:"24"},{default:t(()=>[e(C,{justify:"end"},{default:t(()=>[e(h,{"label-placement":"left",label:"¿Habilitado?",path:"isEnabled","show-feedback":!1},{default:t(()=>[e(x,{value:l.value.isEnabled,"onUpdate:value":a[15]||(a[15]=n=>l.value.isEnabled=n)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),Ee={style:{"border-bottom":"1px solid #e9e9e9"}},Se=D({__name:"DataTable",setup(s){const o=y(!1),d=y([]),u=y(!1),p=y(null),m=se({...A()}),c=y({search:null,page:m.page,pageSize:m.pageSize}),v=y({}),l=y({}),S=ye(i=>{p.value=i,u.value=!0},async i=>{await xe(i),await w()}),w=async()=>{c.value.page=1,await I()},I=async()=>{o.value=!0,v.value=await ke(c.value),d.value=v.value.data,m.total=v.value.total,m.pageSize=v.value.per_page,m.page=v.value.current_page,m.pageCount=v.value.last_page,o.value=!1},b=ce(()=>{w()},400),a=async i=>{c.value.page=i,await I()},N=async i=>{c.value.page=1,c.value.pageSize=i,await I()};return(async()=>{await I(),l.value.documentTypesItems=await ge()})(),(i,k)=>{const x=K,C=J,z=Q,M=ve;return U(),j(L,null,[H("div",Ee,[e(z,{gutter:12,style:{padding:"12px 16px"}},{default:t(()=>[e(x,{span:12}),e(x,{span:12},{default:t(()=>[e(C,{size:"large",placeholder:"Buscar",value:c.value.search,"onUpdate:value":k[0]||(k[0]=T=>c.value.search=T),onInput:_(b),clearable:""},{suffix:t(()=>[e(W,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),e(z,null,{default:t(()=>[e(x,{span:24},{default:t(()=>[e(M,{key:"id",remote:"","single-line":!1,columns:_(S),data:d.value,pagination:_(he)(m),"pagination-show-size-picker":!0,loading:o.value,"onUpdate:page":a,"onUpdate:pageSize":N},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),ue(i.$slots,"extra",{reLoadDataTable:w,selectables:l.value})]),e(X,{modelValue:u.value,"onUpdate:modelValue":k[1]||(k[1]=T=>u.value=T),item:p.value,onSuccess:w,selectables:l.value},null,8,["modelValue","item","selectables"])],64)}}}),qe=D({__name:"index",setup(s){const o=y(!1);return(d,u)=>{const p=B,m=q;return U(),j(L,null,[e(m,{segmented:{header:!0,content:!0}},{header:t(()=>u[2]||(u[2]=[H("h6",{style:{color:"#999",margin:"0"}},"Gestión de Docentes",-1),F(" Docentes ")])),"header-extra":t(()=>[e(p,{"render-icon":_(V)("additem"),onClick:u[0]||(u[0]=c=>o.value=!0)},{default:t(()=>u[3]||(u[3]=[F(" Agregar ")])),_:1},8,["render-icon"])]),_:1}),e(Se,null,{extra:t(({reLoadDataTable:c,selectables:v})=>[e(X,{modelValue:o.value,"onUpdate:modelValue":u[1]||(u[1]=l=>o.value=l),item:null,onSuccess:c,selectables:v},null,8,["modelValue","onSuccess","selectables"])]),_:1})],64)}}});export{qe as default};
