import{r as U,i as q}from"./DataTable.types-O1f2gI-n.js";import{_ as X,a as Y,b as Z,c as ee}from"./module.services-BRv_agxv.js";import{d as S,a9 as V,a4 as F,a6 as t,aa as e,ah as j,ag as B,h as R,e as ae,r as c,g as te,ae as O,ai as G,aj as le,a5 as ne,ak as oe,al as H,ac as W,ab as C,am as ue,_ as A}from"./index-DYxGiGyZ.js";import{_ as L,a as se,b as re}from"./FormItem-khv4guBG.js";import{N as P,_ as J,c as ie,a as de,b as K}from"./Col-1P6V_qQb.js";import{_ as ce}from"./Switch--OPcRDA5.js";import{u as pe}from"./composables-DM7s1Npn.js";import{_ as me}from"./Dropdown-B_S2k-69.js";import{d as _e}from"./debounce.utils-DqPPCsFD.js";import{_ as fe}from"./DataTable-CEAYLJVh.js";import{_ as ve}from"./selectables.services-CHFlFHJd.js";import"./get-B5_b6rDM.js";import"./ChevronRight-Dw_frzul.js";const ge=S({__name:"DataTableOp",props:{item:{}},emits:["edit","delete"],setup(p,{emit:_}){const o=pe(),r=_,m=[{label:"Editar",key:"edit",icon:U("edit-2"),props:{onClick:()=>r("edit")}},{label:"Eliminar",key:"delete",icon:U("trash","red"),props:{style:{color:"red"},onClick:()=>{o.warning({title:"Confirmar",content:"¿Está seguro que desea eliminar este registro?",positiveText:"Eliminar",negativeText:"Cancelar",closable:!1,showIcon:!1,negativeButtonProps:{secondary:!0,type:"tertiary",size:"large"},positiveButtonProps:{size:"large",type:"error"},onPositiveClick:()=>{r("delete")}})}}}];return(s,i)=>{const n=B,l=me;return V(),F(l,{options:m,placement:"bottom-start"},{default:t(()=>[e(n,null,{default:t(()=>[e(j,{"icon-name":"setting-5",size:"20"})]),_:1})]),_:1})}}}),be=(p,_)=>[{title:"Ops.",key:"ops",width:"80px",fixed:"left",render(o){const r=o;return R(ge,{onEdit:()=>{p(r)},onDelete:()=>{_(r)},item:r},{default:()=>"Editar"})}},{title:"Nombre",key:"name",minWidth:"300px"},{title:"Código",key:"code",minWidth:"150px"},{title:"Plan de estudio",key:"curriculum",minWidth:"150px"},{title:"Extracurricular",key:"isExtracurricular",width:"150px",render:o=>R(P,{type:o.isExtracurricular?"default":"info",tertiary:!0,bordered:!1,strong:!0},{default:()=>o.isExtracurricular?"SI":"NO"})},{title:"Habilitado",key:"isEnabled",width:"150px",render:o=>R(P,{type:o.isEnabled?"success":"error",tertiary:!0,bordered:!1,strong:!0},{default:()=>o.isEnabled?"	Habilitado":"Deshabilitado"})}],ye=(p=q())=>({page:p.page,total:p.total,pageSize:p.pageSize,pageCount:p.pageCount,showSizePicker:!0,pageSizes:[10,50,100,500,1e3,5e3],style:{paddingRight:"16px",paddingBottom:"12px"},prefix(){return`Total ${p.total} registros`}}),N=()=>({id:null,name:null,code:null,curriculumId:null,curriculum:null,isExtracurricular:!1,isEnabled:!0}),xe=()=>({name:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}],code:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}],curriculumId:[{type:"number",required:!0,trigger:["blur","input"],message:"Obligatorio"}]}),Q=S({__name:"ModuleForm",props:{item:{},modelValue:{type:Boolean},curriculumOptions:{}},emits:["update:modelValue","success"],setup(p,{emit:_}){const o=_,r=p,m=ae({get:()=>r.modelValue,set:v=>o("update:modelValue",v)}),s=c(!1),i=c(null),n=c(N()),l=c(null),f=c({...xe()}),D=async()=>{if(i.value){const v=await i.value.validate();let a=null;v?(s.value=!0,n.value.id?a=await X(n.value):a=await Y(n.value),a.status?(o("success"),m.value=!1):l.value=a.data):console.log("Formulario inválido")}s.value=!1},M=()=>{console.log("Inicializando formulario"),n.value=r.item?{...r.item}:N()};return te(m,v=>{v&&M()}),(v,a)=>{const y=L,x=se,w=J,T=ie,$=ce,d=de,k=K,I=re,E=B,z=G,h=le;return V(),F(h,{show:m.value,"onUpdate:show":a[9]||(a[9]=u=>m.value=u)},{default:t(()=>[e(z,{style:{width:"500px"},title:v.item?"EDITAR REGISTRO":"NUEVO REGISTRO",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:t(()=>[e(d,{justify:"end"},{default:t(()=>[e(E,{tertiary:"",size:"large",onClick:a[8]||(a[8]=u=>m.value=!1),disabled:s.value},{default:t(()=>a[10]||(a[10]=[O(" Cancelar ")])),_:1},8,["disabled"]),e(E,{size:"large",type:"primary",onClick:D,loading:s.value},{default:t(()=>a[11]||(a[11]=[O("Guardar")])),_:1},8,["loading"])]),_:1})]),default:t(()=>[e(I,{ref_key:"formRef",ref:i,model:n.value,rules:f.value,size:"large"},{default:t(()=>[e(k,null,{default:t(()=>[e(w,{span:"24"},{default:t(()=>{var u;return[e(x,{path:"code",label:"Código",feedback:(u=l.value)==null?void 0:u.code},{default:t(()=>{var g;return[e(y,{status:((g=l.value)==null?void 0:g.code)!=null?"error":"",value:n.value.code,"onUpdate:value":a[0]||(a[0]=b=>n.value.code=b),onInput:a[1]||(a[1]=b=>l.value!=null?l.value.code=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1}),e(w,{span:"24"},{default:t(()=>{var u;return[e(x,{path:"name",label:"Nombre",feedback:(u=l.value)==null?void 0:u.name},{default:t(()=>{var g;return[e(y,{status:((g=l.value)==null?void 0:g.name)!=null?"error":"",value:n.value.name,"onUpdate:value":a[2]||(a[2]=b=>n.value.name=b),onInput:a[3]||(a[3]=b=>l.value!=null?l.value.name=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1}),e(w,{span:"24"},{default:t(()=>{var u;return[e(x,{path:"curriculumId",label:"Plan de estudios",feedback:(u=l.value)==null?void 0:u.curriculumId},{default:t(()=>{var g;return[e(T,{clearable:"",placeholder:"Seleccione un plan de estudios",value:n.value.curriculumId,"onUpdate:value":a[4]||(a[4]=b=>n.value.curriculumId=b),options:v.curriculumOptions,"virtual-scroll":!1,status:((g=l.value)==null?void 0:g.curriculumId)!=null?"error":"",onInput:a[5]||(a[5]=b=>l.value!=null?l.value.curriculumId=null:()=>{})},null,8,["value","options","status"])]}),_:1},8,["feedback"])]}),_:1}),e(w,{span:"24"},{default:t(()=>[e(d,{justify:"end"},{default:t(()=>[e(x,{"label-placement":"left",label:"¿Extracurricular?",path:"isExtracurricular","show-feedback":!1},{default:t(()=>[e($,{value:n.value.isExtracurricular,"onUpdate:value":a[6]||(a[6]=u=>n.value.isExtracurricular=u)},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(w,{span:"24"},{default:t(()=>[e(d,{justify:"end"},{default:t(()=>[e(x,{"label-placement":"left",label:"¿Habilitado?",path:"isEnabled","show-feedback":!1},{default:t(()=>[e($,{value:n.value.isEnabled,"onUpdate:value":a[7]||(a[7]=u=>n.value.isEnabled=u)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),we={style:{"border-bottom":"1px solid #e9e9e9"}},ke=S({__name:"DataTable",props:{curriculumOptions:{}},setup(p){const _=ne(),o=c(!1),r=c([]),m=c(!1),s=c(null),i=oe({...q()}),n=c(""),l=c({search:null,page:i.page,pageSize:i.pageSize}),f=c({}),v=be(d=>{s.value=d,m.value=!0},async d=>{await ee(d),await a()}),a=async()=>{l.value.page=1,await y()},y=async()=>{o.value=!0,l.value.filters={curriculumId:n.value},f.value=await Z(l.value),r.value=f.value.data,i.total=f.value.total,i.pageSize=f.value.per_page,i.page=f.value.current_page,i.pageCount=f.value.last_page,o.value=!1},x=_e(()=>{a()},400),w=async d=>{l.value.page=d,await y()},T=async d=>{l.value.page=1,l.value.pageSize=d,await y()};return(async()=>{n.value=_.params.id??"",await y()})(),(d,k)=>{const I=J,E=L,z=K,h=fe;return V(),H(A,null,[W("div",we,[e(z,{gutter:12,style:{padding:"12px 16px"}},{default:t(()=>[e(I,{span:12}),e(I,{span:12},{default:t(()=>[e(E,{size:"large",placeholder:"Buscar",value:l.value.search,"onUpdate:value":k[0]||(k[0]=u=>l.value.search=u),onInput:C(x),clearable:""},{suffix:t(()=>[e(j,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),e(z,null,{default:t(()=>[e(I,{span:24},{default:t(()=>[e(h,{key:"id",remote:"","single-line":!1,columns:C(v),data:r.value,pagination:C(ye)(i),"pagination-show-size-picker":!0,loading:o.value,"onUpdate:page":w,"onUpdate:pageSize":T},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),ue(d.$slots,"extra",{reLoadDataTable:a})]),e(Q,{modelValue:m.value,"onUpdate:modelValue":k[1]||(k[1]=u=>m.value=u),item:s.value,curriculumOptions:d.curriculumOptions,onSuccess:a},null,8,["modelValue","item","curriculumOptions"])],64)}}}),De=S({__name:"index",setup(p){const _=c([]),o=c(!1);return(async()=>{_.value=await ve()})(),(m,s)=>{const i=B,n=G;return V(),H(A,null,[e(n,{segmented:{header:!0,content:!0}},{header:t(()=>s[2]||(s[2]=[W("h6",{style:{color:"#999",margin:"0"}},"Gestión de Modules academicas",-1),O(" Modules ")])),"header-extra":t(()=>[e(i,{"render-icon":C(U)("additem"),onClick:s[0]||(s[0]=l=>o.value=!0)},{default:t(()=>s[3]||(s[3]=[O(" Agregar ")])),_:1},8,["render-icon"])]),_:1}),e(ke,{curriculumOptions:_.value},{extra:t(({reLoadDataTable:l})=>[e(Q,{curriculumOptions:_.value,modelValue:o.value,"onUpdate:modelValue":s[1]||(s[1]=f=>o.value=f),item:null,onSuccess:l},null,8,["curriculumOptions","modelValue","onSuccess"])]),_:1},8,["curriculumOptions"])],64)}}});export{De as default};
