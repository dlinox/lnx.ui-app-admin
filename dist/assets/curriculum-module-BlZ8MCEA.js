import{b as K,r as Q}from"./LnxIcon.vue_vue_type_script_setup_true_lang-TYfemrMA.js";import{d as B,e as W,r as d,g as X,a3 as D,a4 as t,ae as Y,i as h,a7 as $,a8 as e,ab as M,aa as ee,ad as j,af as N,ag as ae,ah as P,ai as G,aj as le,Z as A,a5 as q,a9 as z,p as te,ac as ne}from"./index-DJ1jHABu.js";import{d as O,e as oe,b as ue,f as se}from"./form.configs-CYATX8Jp.js";import{_ as re,a as de,b as ie,c as me,d as pe,e as ce}from"./curriculumModule.services-utY4yJPb.js";import{l as _e,a as ve,b as H,c as fe,d as ge,e as L,f as be,i as Ie,g as we,_ as ye,h as Ve}from"./debounce.utils-JXFV_6GD.js";import{d as ke}from"./area.services-DwIq4L2q.js";import{d as Se}from"./module.services-CmGe2Dz2.js";import{d as xe}from"./curriculum.services-DklNfMqw.js";const Z=B({__name:"CurriculumModuleForm",props:{item:{},modelValue:{type:Boolean},selectables:{}},emits:["update:modelValue","success"],setup(R,{emit:v}){const _=h("curriculum"),c=v,b=R,i=W({get:()=>b.modelValue,set:u=>c("update:modelValue",u)}),o=d(!1),m=d(null),l=d(O()),n=d(null),S=d({...oe()}),x=async()=>{if(m.value){const u=await m.value.validate();let a=null;u?(o.value=!0,l.value.curriculumId=_.value.id,l.value.id?a=await re(l.value):a=await de(l.value),a.status?(c("success"),i.value=!1):n.value=a.data):console.log("Formulario inválido")}o.value=!1},T=async()=>{var u;(u=b.item)!=null&&u.id?l.value=await me(b.item.id):l.value=O()},y=async()=>{await T(),l.value.curriculumId=_.value.id};return X(i,u=>{u&&y()}),(u,a)=>{const C=_e,I=ve,V=H,r=ie,p=fe,w=ge,F=L,E=be,U=j,k=N,J=Y;return $(),D(J,{show:i.value,"onUpdate:show":a[10]||(a[10]=s=>i.value=s)},{default:t(()=>[e(k,{style:{width:"500px"},title:u.item?"EDITAR REGISTRO":"NUEVO REGISTRO",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:t(()=>[e(w,{justify:"end"},{default:t(()=>[e(U,{tertiary:"",size:"large",onClick:a[9]||(a[9]=s=>i.value=!1),disabled:o.value},{default:t(()=>a[11]||(a[11]=[M(" Cancelar ")])),_:1},8,["disabled"]),e(U,{size:"large",type:"primary",onClick:x,loading:o.value},{default:t(()=>a[12]||(a[12]=[M("Guardar")])),_:1},8,["loading"])]),_:1})]),default:t(()=>[e(E,{ref_key:"formRef",ref:m,model:l.value,rules:S.value,size:"large"},{default:t(()=>[e(F,null,{default:t(()=>[e(V,{span:"24"},{default:t(()=>{var s;return[e(I,{path:"areaId",label:"Área",feedback:(s=n.value)==null?void 0:s.areaId},{default:t(()=>{var f;return[e(C,{value:l.value.areaId,"onUpdate:value":a[0]||(a[0]=g=>l.value.areaId=g),options:u.selectables.areaItems,filterable:"","virtual-scroll":!1,status:((f=n.value)==null?void 0:f.areaId)!=null?"error":"","onOnUpdate:value":a[1]||(a[1]=g=>n.value!=null?n.value.areaId=null:()=>{})},null,8,["value","options","status"])]}),_:1},8,["feedback"])]}),_:1}),l.value.isExtracurricular?ee("",!0):($(),D(V,{key:0,span:"24"},{default:t(()=>{var s;return[e(I,{path:"moduleId",label:"Modulo",feedback:(s=n.value)==null?void 0:s.moduleId},{default:t(()=>{var f;return[e(C,{filterable:"",options:u.selectables.moduleItems,"virtual-scroll":!1,value:l.value.moduleId,"onUpdate:value":a[2]||(a[2]=g=>l.value.moduleId=g),status:((f=n.value)==null?void 0:f.moduleId)!=null?"error":"","onOnUpdate:value":a[3]||(a[3]=g=>n.value!=null?n.value.moduleId=null:()=>{})},null,8,["options","value","status"])]}),_:1},8,["feedback"])]}),_:1})),e(V,{span:"24"},{default:t(()=>{var s;return[e(I,{path:"order",label:"Orden",feedback:(s=n.value)==null?void 0:s.order},{default:t(()=>{var f;return[e(r,{style:{width:"100%"},clearable:"",value:l.value.order,"onUpdate:value":a[4]||(a[4]=g=>l.value.order=g),status:((f=n.value)==null?void 0:f.order)!=null?"error":"",onInput:a[5]||(a[5]=g=>n.value!=null?n.value.order=null:()=>{})},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1}),e(V,{span:"24"},{default:t(()=>[e(w,{justify:"end"},{default:t(()=>[e(I,{"label-placement":"left",label:"¿Extracurricular?",path:"isExtracurricular","show-feedback":!1},{default:t(()=>[e(p,{value:l.value.isExtracurricular,"onUpdate:value":[a[6]||(a[6]=s=>l.value.isExtracurricular=s),a[7]||(a[7]=s=>l.value.moduleId=null)]},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(V,{span:"24"},{default:t(()=>[e(w,{justify:"end"},{default:t(()=>[e(I,{"label-placement":"left",label:"¿Habilitado?",path:"isEnabled","show-feedback":!1},{default:t(()=>[e(p,{value:l.value.isEnabled,"onUpdate:value":a[8]||(a[8]=s=>l.value.isEnabled=s)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),Ce={style:{"border-bottom":"1px solid #e9e9e9"}},Ee=B({__name:"ModuleDataTable",setup(R){const v=q(),_=d({areaItems:[],moduleItems:[]}),c=d(!1),b=d([]),i=d(!1),o=d(null),m=ae({...Ie()}),l=d({search:null,page:m.page,pageSize:m.pageSize}),n=d({}),T=se(r=>{o.value=r,i.value=!0},async r=>{await ce(r),await y()}),y=async()=>{l.value.page=1,await u()},u=async()=>{var p;c.value=!0;const r=(p=v.params)==null?void 0:p.id;n.value=await pe(l.value,r),b.value=n.value.data,m.total=n.value.total,m.pageSize=n.value.per_page,m.page=n.value.current_page,m.pageCount=n.value.last_page,c.value=!1},a=we(()=>{y()},400),C=async r=>{l.value.page=r,await u()},I=async r=>{l.value.page=1,l.value.pageSize=r,await u()};return(async()=>{var p;await u();const r=(p=v.params)==null?void 0:p.id;_.value.areaItems=await ke(),_.value.moduleItems=await Se(r)})(),(r,p)=>{const w=H,F=ye,E=L,U=Ve;return $(),P(A,null,[G("div",Ce,[e(E,{gutter:12,style:{padding:"12px 16px"}},{default:t(()=>[e(w,{span:12}),e(w,{span:12},{default:t(()=>[e(F,{size:"large",placeholder:"Buscar",value:l.value.search,"onUpdate:value":p[0]||(p[0]=k=>l.value.search=k),onInput:z(a),clearable:""},{suffix:t(()=>[e(K,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),e(E,null,{default:t(()=>[e(w,{span:24},{default:t(()=>[e(U,{key:"id",remote:"","single-line":!1,columns:z(T),data:b.value,pagination:z(ue)(m),"pagination-show-size-picker":!0,loading:c.value,"onUpdate:page":C,"onUpdate:pageSize":I},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),le(r.$slots,"extra",{reLoadDataTable:y,selectables:_.value})]),e(Z,{modelValue:i.value,"onUpdate:modelValue":p[1]||(p[1]=k=>i.value=k),item:o.value,selectables:_.value,onSuccess:y},null,8,["modelValue","item","selectables"])],64)}}}),De=B({__name:"curriculum-module",setup(R){const v=d(),_=q(),c=d(!1);return(async()=>{var o;const i=(o=_.params)==null?void 0:o.id;i&&(v.value=await xe(i))})(),te("curriculum",v),(i,o)=>{const m=j,l=N;return $(),P(A,null,[e(l,{segmented:{header:!0,content:!0}},{header:t(()=>{var n;return[o[2]||(o[2]=G("h6",{style:{color:"#999",margin:"0"}},"Gestión del Plan de Estudio",-1)),M(" "+ne((n=v.value)==null?void 0:n.name),1)]}),"header-extra":t(()=>[e(m,{"render-icon":z(Q)("additem"),onClick:o[0]||(o[0]=n=>c.value=!0)},{default:t(()=>o[3]||(o[3]=[M(" Agregar ")])),_:1},8,["render-icon"])]),_:1}),e(Ee,null,{extra:t(({reLoadDataTable:n,selectables:S})=>[e(Z,{modelValue:c.value,"onUpdate:modelValue":o[1]||(o[1]=x=>c.value=x),item:null,onSuccess:n,selectables:S},null,8,["modelValue","onSuccess","selectables"])]),_:1})],64)}}});export{De as default};
