import{r as D}from"./icon.utils-DnuXdNV1.js";import{d as h,a7 as T,a3 as F,a4 as a,a8 as e,ac as R,h as N,aj as E,e as K,r as m,g as Q,ad as X,ab as z,ae as M,af as Y,ag as G,ah as j,ai as ee,Z as q,a9 as k}from"./index-Bqe-vxMq.js";import{i as H,_ as te,d as ae,a as A,b as ne,c as L}from"./DataTable.types-C3XSPyHT.js";import{_ as W}from"./Input-yPERYFUO.js";import{_ as oe,a as le}from"./FormItem-BBmdDte0.js";import{_ as se,d as re}from"./debounce.utils-rmPTix7t.js";import{a as Z,_ as ue}from"./LnxIcon.vue_vue_type_script_setup_true_lang-tM4SdBca.js";import{u as ie,_ as pe}from"./composables-B9b5AZp0.js";import"./get-C8gX6CwU.js";import"./use-keyboard-BPlN3GQF.js";import"./Forward-DN8GWHg-.js";const de=h({__name:"DataTableOp",props:{item:{}},emits:["edit","delete"],setup(l,{emit:t}){const i=ie(),n=t,p=[{label:"Editar",key:"edit",icon:D("edit-2"),props:{onClick:()=>n("edit")}},{label:"Eliminar",key:"delete",icon:D("trash","red"),props:{style:{color:"red"},onClick:()=>{i.warning({title:"Confirmar",content:"¿Está seguro que desea eliminar este registro?",positiveText:"Eliminar",negativeText:"Cancelar",closable:!1,showIcon:!1,negativeButtonProps:{secondary:!0,type:"tertiary",size:"large"},positiveButtonProps:{size:"large",type:"error"},onPositiveClick:()=>{n("delete")}})}}}];return(r,u)=>{const s=R,_=ue;return T(),F(_,{options:p,placement:"bottom-start"},{default:a(()=>[e(s,null,{default:a(()=>[e(Z,{"icon-name":"setting-5",size:"20"})]),_:1})]),_:1})}}}),me=(l,t)=>[{title:"Ops.",key:"ops",width:"80px",fixed:"left",render(i){const n=i;return N(de,{onEdit:()=>{l(n)},onDelete:()=>{t(n)},item:n},{default:()=>"Editar"})}},{title:"Nombre",key:"name",minWidth:"300px"},{title:"Habilitado",key:"isEnabled",width:"150px",render:i=>N(te,{type:i.isEnabled?"success":"error",tertiary:!0,bordered:!1,strong:!0},{default:()=>i.isEnabled?"	Habilitado":"Deshabilitado"})}],ce=(l=H())=>({page:l.page,total:l.total,pageSize:l.pageSize,pageCount:l.pageCount,showSizePicker:!0,pageSizes:[10,50,100,500,1e3,5e3],style:{paddingRight:"16px",paddingBottom:"12px"},prefix(){return`Total ${l.total} registros`}}),O=()=>({id:null,name:null,isEnabled:!0}),_e=()=>({name:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}]}),fe=async l=>{try{return(await E().post("/payment-type/load-data-table",l)).data.data}catch{return ae()}},ge=async l=>{try{return{status:!0,data:(await E().post("/payment-type",l)).data.data}}catch(t){return t.response.status===422?{status:!1,data:t.response.data.errors}:{status:!1,data:null}}},ve=async l=>{try{return{status:!0,data:(await E().put("/payment-type",l)).data.data}}catch(t){return t.response.status===422?{status:!1,data:t.response.data.errors}:{status:!1,data:null}}},ye=async l=>{try{return await E().delete("/payment-type",{data:{id:l.id}}),!0}catch{return!1}},J=h({__name:"PaymentTypeForm",props:{item:{},modelValue:{type:Boolean}},emits:["update:modelValue","success"],setup(l,{emit:t}){const i=t,n=l,p=K({get:()=>n.modelValue,set:d=>i("update:modelValue",d)}),r=m(!1),u=m(null),s=m(O()),_=m(null),P=m({..._e()}),C=async()=>{if(u.value){const d=await u.value.validate();let o=null;d?(r.value=!0,s.value.id?o=await ve(s.value):o=await ge(s.value),o.status?(i("success"),p.value=!1):_.value=o.data):console.log("Formulario inválido")}r.value=!1},v=()=>{console.log("Inicializando formulario"),s.value=n.item?{...n.item}:O()};return Q(p,d=>{d&&v()}),(d,o)=>{const I=W,x=oe,S=A,c=se,f=ne,y=L,V=le,b=R,$=M,w=X;return T(),F(w,{show:p.value,"onUpdate:show":o[4]||(o[4]=g=>p.value=g)},{default:a(()=>[e($,{style:{width:"500px"},title:d.item?"EDITAR REGISTRO":"NUEVO REGISTRO",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:a(()=>[e(f,{justify:"end"},{default:a(()=>[e(b,{tertiary:"",size:"large",onClick:o[3]||(o[3]=g=>p.value=!1),disabled:r.value},{default:a(()=>o[5]||(o[5]=[z(" Cancelar ")])),_:1},8,["disabled"]),e(b,{size:"large",type:"primary",onClick:C,loading:r.value},{default:a(()=>o[6]||(o[6]=[z("Guardar")])),_:1},8,["loading"])]),_:1})]),default:a(()=>[e(V,{ref_key:"formRef",ref:u,model:s.value,rules:P.value,size:"large"},{default:a(()=>[e(y,null,{default:a(()=>[e(S,{span:"24"},{default:a(()=>{var g;return[e(x,{path:"name",label:"Nombre",feedback:(g=_.value)==null?void 0:g.name},{default:a(()=>{var B;return[e(I,{status:((B=_.value)==null?void 0:B.name)!=null?"error":"",value:s.value.name,"onUpdate:value":o[0]||(o[0]=U=>s.value.name=U),onInput:o[1]||(o[1]=U=>_.value!=null?_.value.name=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1}),e(S,{span:"24"},{default:a(()=>[e(f,{justify:"end"},{default:a(()=>[e(x,{"label-placement":"left",label:"¿Habilitado?",path:"isEnabled","show-feedback":!1},{default:a(()=>[e(c,{value:s.value.isEnabled,"onUpdate:value":o[2]||(o[2]=g=>s.value.isEnabled=g)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),be={style:{"border-bottom":"1px solid #e9e9e9"}},we=h({__name:"DataTable",setup(l){const t=m(!1),i=m([]),n=m(!1),p=m(null),r=Y({...H()}),u=m({search:null,page:r.page,pageSize:r.pageSize}),s=m({}),C=me(c=>{p.value=c,n.value=!0},async c=>{await ye(c),await v()}),v=async()=>{u.value.page=1,await d()},d=async()=>{t.value=!0,s.value=await fe(u.value),i.value=s.value.data,r.total=s.value.total,r.pageSize=s.value.per_page,r.page=s.value.current_page,r.pageCount=s.value.last_page,t.value=!1},o=re(()=>{v()},400),I=async c=>{u.value.page=c,await d()},x=async c=>{u.value.page=1,u.value.pageSize=c,await d()};return(async()=>{await d()})(),(c,f)=>{const y=A,V=W,b=L,$=pe;return T(),G(q,null,[j("div",be,[e(b,{gutter:12,style:{padding:"12px 16px"}},{default:a(()=>[e(y,{span:12}),e(y,{span:12},{default:a(()=>[e(V,{size:"large",placeholder:"Buscar",value:u.value.search,"onUpdate:value":f[0]||(f[0]=w=>u.value.search=w),onInput:k(o),clearable:""},{suffix:a(()=>[e(Z,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),e(b,null,{default:a(()=>[e(y,{span:24},{default:a(()=>[e($,{key:"id",remote:"","single-line":!1,columns:k(C),data:i.value,pagination:k(ce)(r),"pagination-show-size-picker":!0,loading:t.value,"onUpdate:page":I,"onUpdate:pageSize":x},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),ee(c.$slots,"extra",{reLoadDataTable:v})]),e(J,{modelValue:n.value,"onUpdate:modelValue":f[1]||(f[1]=w=>n.value=w),item:p.value,onSuccess:v},null,8,["modelValue","item"])],64)}}}),De=h({__name:"index",setup(l){const t=m(!1);return(i,n)=>{const p=R,r=M;return T(),G(q,null,[e(r,{segmented:{header:!0,content:!0}},{header:a(()=>n[2]||(n[2]=[j("h6",{style:{color:"#999",margin:"0"}},"Gestión de Tipos de Documentos",-1),z(" Tipos de Documentos ")])),"header-extra":a(()=>[e(p,{"render-icon":k(D)("additem"),onClick:n[0]||(n[0]=u=>t.value=!0)},{default:a(()=>n[3]||(n[3]=[z(" Agregar ")])),_:1},8,["render-icon"])]),_:1}),e(we,null,{extra:a(({reLoadDataTable:u})=>[e(J,{modelValue:t.value,"onUpdate:modelValue":n[1]||(n[1]=s=>t.value=s),item:null,onSuccess:u},null,8,["modelValue","onSuccess"])]),_:1})],64)}}});export{De as default};
