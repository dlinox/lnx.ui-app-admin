import{r as $}from"./icon.utils-BrUbkzNf.js";import{_ as Q,a as X,b as Y,c as Z}from"./area.services-0K7e5ORn.js";import{d as S,aa as V,a5 as A,a8 as t,ab as e,ag as F,af as R,h as P,e as ee,r as p,g as ae,ah as O,ai as M,aj as te,a6 as ne,ak as oe,al as q,ad as G,ac as E,am as le,_ as j}from"./index-DErOr0AP.js";import{_ as H}from"./Input-j5r0X2o1.js";import{_ as ue,a as se}from"./FormItem-n4kq_3-q.js";import{_ as W,a as L}from"./Col-_50WYJb9.js";import{N as re,_ as ie}from"./Select-Cy4RUJ2X.js";import{_ as pe}from"./Switch-KlYhZevK.js";import{_ as me}from"./Space-DSo-Uj4Z.js";import{i as J}from"./DataTable.types-BfyqQUqo.js";import{u as ce}from"./composables-CTqibouk.js";import{_ as de}from"./Dropdown-D0l2jCAn.js";import{d as _e}from"./debounce.utils-DqPPCsFD.js";import{_ as fe}from"./DataTable-D03hb7st.js";import{_ as ge}from"./selectables.services-D0F7zURb.js";import"./index-E0H31oqx.js";import"./get-C_Ul0xsd.js";import"./Tooltip-BqTXu7HV.js";const ve=S({__name:"DataTableOp",props:{item:{}},emits:["edit","delete"],setup(c,{emit:_}){const l=ce(),s=_,d=[{label:"Editar",key:"edit",icon:$("edit-2"),props:{onClick:()=>s("edit")}},{label:"Eliminar",key:"delete",icon:$("trash","red"),props:{style:{color:"red"},onClick:()=>{l.warning({title:"Confirmar",content:"¿Está seguro que desea eliminar este registro?",positiveText:"Eliminar",negativeText:"Cancelar",closable:!1,showIcon:!1,negativeButtonProps:{secondary:!0,type:"tertiary",size:"large"},positiveButtonProps:{size:"large",type:"error"},onPositiveClick:()=>{s("delete")}})}}}];return(u,r)=>{const o=R,n=de;return V(),A(n,{options:d,placement:"bottom-start"},{default:t(()=>[e(o,null,{default:t(()=>[e(F,{"icon-name":"setting-5",size:"20"})]),_:1})]),_:1})}}}),be=(c,_)=>[{title:"Ops.",key:"ops",width:"80px",fixed:"left",render(l){const s=l;return P(ve,{onEdit:()=>{c(s)},onDelete:()=>{_(s)},item:s},{default:()=>"Editar"})}},{title:"Nombre",key:"name",minWidth:"200px"},{title:"Currículo",key:"curriculum",minWidth:"200px"},{title:"Habilitado",key:"isEnabled",width:"150px",render:l=>P(re,{type:l.isEnabled?"success":"error",tertiary:!0,bordered:!1,strong:!0},{default:()=>l.isEnabled?"	Habilitado":"Deshabilitado"})}],ye=(c=J())=>({page:c.page,total:c.total,pageSize:c.pageSize,pageCount:c.pageCount,showSizePicker:!0,pageSizes:[10,50,100,500,1e3,5e3],style:{paddingRight:"16px",paddingBottom:"12px"},prefix(){return`Total ${c.total} registros`}}),N=()=>({id:null,name:null,curriculumId:null,isEnabled:!0}),we=()=>({name:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}],curriculumId:[{type:"number",required:!0,trigger:["blur","input"],message:"Obligatorio"}]}),K=S({__name:"AreaForm",props:{item:{},modelValue:{type:Boolean},curriculumOptions:{}},emits:["update:modelValue","success"],setup(c,{emit:_}){const l=_,s=c,d=ee({get:()=>s.modelValue,set:g=>l("update:modelValue",g)}),u=p(!1),r=p(null),o=p(N()),n=p(null),f=p({...we()}),B=async()=>{if(r.value){const g=await r.value.validate();let a=null;g?(u.value=!0,o.value.id?a=await Q(o.value):a=await X(o.value),a.status?(l("success"),d.value=!1):n.value=a.data):console.log("Formulario inválido")}u.value=!1},D=()=>{console.log("Inicializando formulario"),o.value=s.item?{...s.item}:N()};return ae(d,g=>{g&&D()}),(g,a)=>{const v=H,y=ue,w=W,h=ie,U=pe,m=me,b=L,I=se,z=R,C=M,T=te;return V(),A(T,{show:d.value,"onUpdate:show":a[6]||(a[6]=i=>d.value=i)},{default:t(()=>[e(C,{style:{width:"500px"},title:g.item?"EDITAR REGISTRO":"NUEVO REGISTRO",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:t(()=>[e(m,{justify:"end"},{default:t(()=>[e(z,{tertiary:"",size:"large",onClick:a[5]||(a[5]=i=>d.value=!1),disabled:u.value},{default:t(()=>a[7]||(a[7]=[O(" Cancelar ")])),_:1},8,["disabled"]),e(z,{size:"large",type:"primary",onClick:B,loading:u.value},{default:t(()=>a[8]||(a[8]=[O("Guardar")])),_:1},8,["loading"])]),_:1})]),default:t(()=>[e(I,{ref_key:"formRef",ref:r,model:o.value,rules:f.value,size:"large"},{default:t(()=>[e(b,null,{default:t(()=>[e(w,{span:"24"},{default:t(()=>{var i;return[e(y,{path:"name",label:"Nombre",feedback:(i=n.value)==null?void 0:i.name},{default:t(()=>{var k;return[e(v,{status:((k=n.value)==null?void 0:k.name)!=null?"error":"",value:o.value.name,"onUpdate:value":a[0]||(a[0]=x=>o.value.name=x),onInput:a[1]||(a[1]=x=>n.value!=null?n.value.name=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1}),e(w,{span:"24"},{default:t(()=>{var i;return[e(y,{path:"curriculumId",label:"Plan de estudios",feedback:(i=n.value)==null?void 0:i.curriculumId},{default:t(()=>{var k;return[e(h,{clearable:"",placeholder:"Seleccione un plan de estudios",value:o.value.curriculumId,"onUpdate:value":a[2]||(a[2]=x=>o.value.curriculumId=x),options:g.curriculumOptions,"virtual-scroll":!1,status:((k=n.value)==null?void 0:k.curriculumId)!=null?"error":"",onInput:a[3]||(a[3]=x=>n.value!=null?n.value.curriculumId=null:()=>{})},null,8,["value","options","status"])]}),_:1},8,["feedback"])]}),_:1}),e(w,{span:"24"},{default:t(()=>[e(m,{justify:"end"},{default:t(()=>[e(y,{"label-placement":"left",label:"¿Habilitado?",path:"isEnabled","show-feedback":!1},{default:t(()=>[e(U,{value:o.value.isEnabled,"onUpdate:value":a[4]||(a[4]=i=>o.value.isEnabled=i)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),Ie={style:{"border-bottom":"1px solid #e9e9e9"}},ke=S({__name:"DataTable",props:{curriculumOptions:{}},setup(c){const _=ne(),l=p(!1),s=p([]),d=p(!1),u=p(null),r=oe({...J()}),o=p(""),n=p({search:null,page:r.page,pageSize:r.pageSize}),f=p({}),g=be(m=>{u.value=m,d.value=!0},async m=>{await Z(m),await a()}),a=async()=>{n.value.page=1,await v()},v=async()=>{l.value=!0,n.value.filters={curriculumId:o.value},f.value=await Y(n.value),s.value=f.value.data,r.total=f.value.total,r.pageSize=f.value.per_page,r.page=f.value.current_page,r.pageCount=f.value.last_page,l.value=!1},y=_e(()=>{a()},400),w=async m=>{n.value.page=m,await v()},h=async m=>{n.value.page=1,n.value.pageSize=m,await v()};return(async()=>{o.value=_.params.id??"",await v()})(),(m,b)=>{const I=W,z=H,C=L,T=fe;return V(),q(j,null,[G("div",Ie,[e(C,{gutter:12,style:{padding:"12px 16px"}},{default:t(()=>[e(I,{span:12}),e(I,{span:12},{default:t(()=>[e(z,{size:"large",placeholder:"Buscar",value:n.value.search,"onUpdate:value":b[0]||(b[0]=i=>n.value.search=i),onInput:E(y),clearable:""},{suffix:t(()=>[e(F,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),e(C,null,{default:t(()=>[e(I,{span:24},{default:t(()=>[e(T,{key:"id",remote:"","single-line":!1,columns:E(g),data:s.value,pagination:E(ye)(r),"pagination-show-size-picker":!0,loading:l.value,"onUpdate:page":w,"onUpdate:pageSize":h},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),le(m.$slots,"extra",{reLoadDataTable:a})]),e(K,{modelValue:d.value,"onUpdate:modelValue":b[1]||(b[1]=i=>d.value=i),curriculumOptions:m.curriculumOptions,item:u.value,onSuccess:a},null,8,["modelValue","curriculumOptions","item"])],64)}}}),Me=S({__name:"index",setup(c){const _=p([]),l=p(!1);return(async()=>{_.value=await ge()})(),(d,u)=>{const r=R,o=M;return V(),q(j,null,[e(o,{segmented:{header:!0,content:!0}},{header:t(()=>u[2]||(u[2]=[G("h6",{style:{color:"#999",margin:"0"}},"Gestión de Areas academicas",-1),O(" Areas ")])),"header-extra":t(()=>[e(r,{"render-icon":E($)("additem"),onClick:u[0]||(u[0]=n=>l.value=!0)},{default:t(()=>u[3]||(u[3]=[O(" Agregar ")])),_:1},8,["render-icon"])]),_:1}),e(ke,{curriculumOptions:_.value},{extra:t(({reLoadDataTable:n})=>[e(K,{modelValue:l.value,"onUpdate:modelValue":u[1]||(u[1]=f=>l.value=f),curriculumOptions:_.value,item:null,onSuccess:n},null,8,["modelValue","curriculumOptions","onSuccess"])]),_:1},8,["curriculumOptions"])],64)}}});export{Me as default};
