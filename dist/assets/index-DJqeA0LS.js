import{r as q}from"./icon.utils-72mRZSRr.js";import{d as V,a3 as j,a9 as U,ad as J,ae as p,aa as h,ab as u,ac as a,ag as A,aH as K,h as H,e as re,r as m,j as ie,aB as L,aA as D,aI as de,a5 as pe,aJ as me,aG as Q,_ as X,af as W,aK as ce,a8 as ve}from"./index-CTX32WvQ.js";import{_ as G,a as _e,b as fe,c as ge,d as be,e as ye,f as Ie,g as ke}from"./course.services-BZ-KLaFd.js";import{u as we}from"./useBreakpoints-D9msJ4X0.js";import{d as xe}from"./area.services-vUxAEHUW.js";import{d as Ce}from"./module.services-B1pvfLR2.js";import{_ as he,a as $e}from"./FormItem-TvXBxsfn.js";import{_ as Y,a as Z}from"./Col-BZe6vIUY.js";import{_ as ee}from"./Input-BFgcVtgn.js";import{_ as ze}from"./Select-DwwM8esp.js";import{_ as Oe}from"./InputNumber-DMyBujQ0.js";import{_ as Pe}from"./Space-Cg-Z5G16.js";import{_ as Se}from"./Switch-CA1UdJhI.js";import{i as ae}from"./DataTable.types-BEg5m_To.js";import{u as Te}from"./composables-D1Wne75x.js";import{_ as Re}from"./Dropdown-BaTvtVNI.js";import{_ as Ue}from"./Tag-vB_kF6B0.js";import{d as Ve}from"./debounce.utils-DqPPCsFD.js";import{_ as Ee}from"./DataTable-5d21Xmwy.js";import{_ as Be}from"./selectables.services-C8JJYSBR.js";import"./get-B5VZIcfe.js";import"./Suffix-CZHvrjpx.js";import"./use-merged-state-xCl8VPUK.js";import"./Popover-D4J2dXPN.js";import"./Tooltip-C_mRvc3x.js";const qe=V({__name:"DataTableOp",props:{item:{}},emits:["edit","delete"],setup(f,{emit:I}){const{hasPermission:r}=j(),v=Te(),b=I,y=[{show:r(["area.edit"]),label:"Editar",key:"edit",icon:q("edit-2"),props:{onClick:()=>b("edit")}},{show:r(["area.delete"]),label:"Eliminar",key:"delete",icon:q("trash","red"),props:{style:{color:"red"},onClick:()=>{v.warning({title:"Confirmar",content:"¿Está seguro que desea eliminar este registro?",positiveText:"Eliminar",negativeText:"Cancelar",closable:!1,showIcon:!1,negativeButtonProps:{secondary:!0,type:"tertiary",size:"large"},positiveButtonProps:{size:"large",type:"error"},onPositiveClick:()=>{b("delete")}})}}}];return(i,k)=>{const l=A,t=Re;return p(r)(["module.edit","module.delete"])?(h(),U(t,{key:0,options:y,placement:"bottom-start"},{default:u(()=>[a(l,null,{default:u(()=>[a(K,{"icon-name":"setting-5",size:"20"})]),_:1})]),_:1})):J("",!0)}}}),De=(f,I)=>[{title:"Ops.",key:"ops",width:"80px",fixed:"left",render(r){const v=r;return H(qe,{onEdit:()=>{f(v)},onDelete:()=>{I(v)},item:v},{default:()=>"Editar"})}},{title:"Nombre",key:"name",minWidth:"300px"},{title:"Código",key:"code",minWidth:"80px"},{title:"Horas de práctica",key:"hoursPractice",minWidth:"80px"},{title:"Horas de teoría",key:"hoursTheory",minWidth:"80px"},{title:"Créditos",key:"credits",minWidth:"80px"},{title:"Área",key:"area",minWidth:"150px"},{title:"Módulo",key:"module",minWidth:"150px"},{title:"Currículo",key:"curriculum",minWidth:"150px"},{title:"Prerrequisito",key:"preRequisite",minWidth:"150px"},{title:"Descripción",key:"description",minWidth:"350px"},{title:"Habilitado",key:"isEnabled",width:"150px",render:r=>H(Ue,{type:r.isEnabled?"success":"error",tertiary:!0,bordered:!1,strong:!0},{default:()=>r.isEnabled?"	Habilitado":"Deshabilitado"})}],We=(f=ae())=>({page:f.page,total:f.total,pageSize:f.pageSize,pageCount:f.pageCount,showSizePicker:!0,pageSizes:[10,50,100,500,1e3,5e3],style:{paddingRight:"16px",paddingBottom:"12px"},prefix(){return`Total ${f.total} registros`}}),te=V({__name:"CourseForm",props:{item:{},modelValue:{type:Boolean},curriculumOptions:{}},emits:["update:modelValue","success"],setup(f,{emit:I}){const{screenSize:r}=we(),v=I,b=f,y=re({get:()=>b.modelValue,set:d=>v("update:modelValue",d)}),i=m(!1),k=m(null),l=m(G()),t=m(null),$=m({..._e()}),z=m([]),S=m([]),w=m([]),x=async()=>{w.value=await be({curriculumId:l.value.curriculumId})},E=async()=>{z.value=await xe({curriculumId:l.value.curriculumId})},B=async()=>{S.value=await Ce({curriculumId:l.value.curriculumId})},T=async(d=!1)=>{t.value&&(t.value.curriculumId=null),d||(l.value.areaId=null,l.value.moduleId=null,l.value.preRequisiteId=null),await E(),await B(),await x()},F=async()=>{if(k.value){const d=await k.value.validate();let e=null;d?(i.value=!0,l.value.id?e=await fe(l.value):e=await ge(l.value),e.status?(v("success"),y.value=!1):t.value=e.data):console.log("Formulario inválido")}i.value=!1},g=async()=>{var d;(d=b.item)!=null&&d.id?(l.value=await ye(b.item.id),await T(!0)):l.value=G()},C=async()=>{await g()};return ie(y,d=>{d&&C()}),(d,e)=>{const O=ee,_=$e,c=Z,R=ze,P=Oe,le=Se,M=Pe,ue=Y,oe=he,N=A,ne=L,se=de;return h(),U(se,{show:y.value,"onUpdate:show":e[24]||(e[24]=o=>y.value=o)},{default:u(()=>[a(ne,{style:{width:"800px"},title:d.item?"EDITAR REGISTRO":"NUEVO REGISTRO",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:u(()=>[a(M,{justify:"end"},{default:u(()=>[a(N,{tertiary:"",size:"large",onClick:e[23]||(e[23]=o=>y.value=!1),disabled:i.value},{default:u(()=>e[25]||(e[25]=[D(" Cancelar ")])),_:1},8,["disabled"]),a(N,{size:"large",type:"primary",onClick:F,loading:i.value},{default:u(()=>e[26]||(e[26]=[D("Guardar")])),_:1},8,["loading"])]),_:1})]),default:u(()=>[a(oe,{ref_key:"formRef",ref:k,model:l.value,rules:$.value,size:"large"},{default:u(()=>[a(ue,{gutter:16},{default:u(()=>[a(c,{span:p(r)==="sm"?12:4},{default:u(()=>{var o;return[a(_,{path:"code",label:"Código",feedback:(o=t.value)==null?void 0:o.code},{default:u(()=>{var n;return[a(O,{value:l.value.code,"onUpdate:value":[e[0]||(e[0]=s=>l.value.code=s),e[1]||(e[1]=s=>t.value!=null?t.value.code=null:()=>{})],status:((n=t.value)==null?void 0:n.code)!=null?"error":""},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(c,{span:p(r)==="sm"?12:20},{default:u(()=>{var o;return[a(_,{path:"name",label:"Nombre",feedback:(o=t.value)==null?void 0:o.name},{default:u(()=>{var n;return[a(O,{value:l.value.name,"onUpdate:value":[e[2]||(e[2]=s=>l.value.name=s),e[3]||(e[3]=s=>t.value!=null?t.value.name=null:()=>{})],status:((n=t.value)==null?void 0:n.name)!=null?"error":""},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(c,{span:"24"},{default:u(()=>{var o;return[a(_,{path:"curriculumId",label:"Plan de estudios",feedback:(o=t.value)==null?void 0:o.curriculumId},{default:u(()=>{var n;return[a(R,{value:l.value.curriculumId,"onUpdate:value":[e[4]||(e[4]=s=>l.value.curriculumId=s),e[5]||(e[5]=s=>T(!1))],options:d.curriculumOptions,filterable:"",clearable:"","virtual-scroll":!1,status:((n=t.value)==null?void 0:n.curriculumId)!=null?"error":""},null,8,["value","options","status"])]}),_:1},8,["feedback"])]}),_:1}),a(c,{span:p(r)==="sm"?24:12},{default:u(()=>{var o;return[a(_,{path:"areaId",label:"Área",feedback:(o=t.value)==null?void 0:o.areaId},{default:u(()=>{var n;return[a(R,{value:l.value.areaId,"onUpdate:value":[e[6]||(e[6]=s=>l.value.areaId=s),e[7]||(e[7]=s=>t.value!=null?t.value.areaId=null:()=>{})],options:z.value,disabled:l.value.curriculumId==null,filterable:"",clearable:"","virtual-scroll":!1,status:((n=t.value)==null?void 0:n.areaId)!=null?"error":""},null,8,["value","options","disabled","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(c,{span:p(r)==="sm"?24:12},{default:u(()=>{var o;return[a(_,{path:"moduleId",label:"Módulo",feedback:(o=t.value)==null?void 0:o.moduleId},{default:u(()=>{var n;return[a(R,{value:l.value.moduleId,"onUpdate:value":[e[8]||(e[8]=s=>l.value.moduleId=s),e[9]||(e[9]=s=>t.value!=null?t.value.moduleId=null:()=>{})],options:S.value,disabled:l.value.curriculumId==null,filterable:"",clearable:"","virtual-scroll":!1,status:((n=t.value)==null?void 0:n.moduleId)!=null?"error":""},null,8,["value","options","disabled","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(c,{span:p(r)==="sm"?12:4},{default:u(()=>{var o;return[a(_,{path:"order",label:"Orden",feedback:(o=t.value)==null?void 0:o.order},{default:u(()=>{var n;return[a(P,{style:{width:"100%"},clearable:"",value:l.value.order,"onUpdate:value":e[10]||(e[10]=s=>l.value.order=s),status:((n=t.value)==null?void 0:n.order)!=null?"error":"",onInput:e[11]||(e[11]=s=>t.value!=null?t.value.order=null:()=>{})},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(c,{span:p(r)==="sm"?12:4},{default:u(()=>{var o;return[a(_,{path:"credits",label:"Créditos",feedback:(o=t.value)==null?void 0:o.credits},{default:u(()=>{var n;return[a(P,{style:{width:"100%"},clearable:"",value:l.value.credits,"onUpdate:value":e[12]||(e[12]=s=>l.value.credits=s),status:((n=t.value)==null?void 0:n.credits)!=null?"error":"",onInput:e[13]||(e[13]=s=>t.value!=null?t.value.credits=null:()=>{})},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(c,{span:p(r)==="sm"?12:4},{default:u(()=>{var o;return[a(_,{path:"units",label:"Unidad",feedback:(o=t.value)==null?void 0:o.units},{default:u(()=>{var n;return[a(P,{style:{width:"100%"},clearable:"",value:l.value.units,"onUpdate:value":e[14]||(e[14]=s=>l.value.units=s),status:((n=t.value)==null?void 0:n.units)!=null?"error":"",onInput:e[15]||(e[15]=s=>t.value!=null?t.value.units=null:()=>{})},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(c,{span:p(r)==="sm"?12:6},{default:u(()=>{var o;return[a(_,{path:"hoursPractice",label:"Horas Practicas",feedback:(o=t.value)==null?void 0:o.hoursPractice},{default:u(()=>{var n;return[a(P,{style:{width:"100%"},clearable:"",value:l.value.hoursPractice,"onUpdate:value":e[16]||(e[16]=s=>l.value.hoursPractice=s),status:((n=t.value)==null?void 0:n.hoursPractice)!=null?"error":"",onInput:e[17]||(e[17]=s=>t.value!=null?t.value.hoursPractice=null:()=>{})},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(c,{span:p(r)==="sm"?12:6},{default:u(()=>{var o;return[a(_,{path:"hoursTheory",label:"Horas Teoricas",feedback:(o=t.value)==null?void 0:o.hoursTheory},{default:u(()=>{var n;return[a(P,{style:{width:"100%"},clearable:"",value:l.value.hoursTheory,"onUpdate:value":e[18]||(e[18]=s=>l.value.hoursTheory=s),status:((n=t.value)==null?void 0:n.hoursTheory)!=null?"error":"",onInput:e[19]||(e[19]=s=>t.value!=null?t.value.hoursTheory=null:()=>{})},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(c,{span:(p(r)==="sm",24)},{default:u(()=>{var o;return[a(_,{path:"preRequisiteId",label:"Pre-Requisito",feedback:(o=t.value)==null?void 0:o.preRequisiteId},{default:u(()=>{var n;return[a(R,{clearable:"",filterable:"",options:w.value,disabled:l.value.curriculumId==null,placeholder:"Seleccione un curso","virtual-scroll":!1,value:l.value.preRequisiteId,"onUpdate:value":[e[20]||(e[20]=s=>l.value.preRequisiteId=s),e[21]||(e[21]=s=>t.value!=null?t.value.preRequisiteId=null:()=>{})],status:((n=t.value)==null?void 0:n.preRequisiteId)!=null?"error":""},null,8,["options","disabled","value","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(c,{span:"24"},{default:u(()=>[a(M,{justify:"end"},{default:u(()=>[a(_,{"label-placement":"left",label:"¿Habilitado?",path:"isEnabled","show-feedback":!1},{default:u(()=>[a(le,{value:l.value.isEnabled,"onUpdate:value":e[22]||(e[22]=o=>l.value.isEnabled=o)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),Ae={style:{"border-bottom":"1px solid #e9e9e9"}},Fe=V({__name:"DataTable",props:{curriculumOptions:{}},setup(f){const I=pe(),r=m(!1),v=m([]),b=m(!1),y=m(null),i=me({...ae()}),k=m(""),l=m({search:null,page:i.page,pageSize:i.pageSize}),t=m({}),S=De(g=>{y.value=g,b.value=!0},async g=>{await ke(g),await w()}),w=async()=>{l.value.page=1,await x()},x=async()=>{r.value=!0,l.value.filters={curriculumId:k.value},t.value=await Ie(l.value),v.value=t.value.data,i.total=t.value.total,i.pageSize=t.value.per_page,i.page=t.value.current_page,i.pageCount=t.value.last_page,r.value=!1},E=Ve(()=>{w()},400),B=async g=>{l.value.page=g,await x()},T=async g=>{l.value.page=1,l.value.pageSize=g,await x()};return(async()=>{k.value=I.params.id??"",await x()})(),(g,C)=>{const d=Z,e=ee,O=Y,_=Ee;return h(),Q(X,null,[W("div",Ae,[a(O,{gutter:12,style:{padding:"12px 16px"}},{default:u(()=>[a(d,{span:12}),a(d,{span:12},{default:u(()=>[a(e,{size:"large",placeholder:"Buscar",value:l.value.search,"onUpdate:value":C[0]||(C[0]=c=>l.value.search=c),onInput:p(E),clearable:""},{suffix:u(()=>[a(K,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),a(O,null,{default:u(()=>[a(d,{span:24},{default:u(()=>[a(_,{key:"id",remote:"",size:"small","single-line":!1,columns:p(S),data:v.value,pagination:p(We)(i),"pagination-show-size-picker":!0,loading:r.value,"onUpdate:page":B,"onUpdate:pageSize":T},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),ce(g.$slots,"extra",{reLoadDataTable:w})]),a(te,{modelValue:b.value,"onUpdate:modelValue":C[1]||(C[1]=c=>b.value=c),item:y.value,onSuccess:w,curriculumOptions:g.curriculumOptions},null,8,["modelValue","item","curriculumOptions"])],64)}}}),ca=V({__name:"index",setup(f){const{hasPermission:I}=j(),r=m([]),v=m(!1);return(async()=>{r.value=await Be()})(),(y,i)=>{const k=A,l=L,t=ve("AppNotAuthorization");return p(I)(["course.create","course.edit","course.delete"])?(h(),Q(X,{key:0},[a(l,{segmented:{header:!0,content:!0}},{header:u(()=>i[2]||(i[2]=[W("span",{class:"text-sm text-slate-500"}," Gestión de Cursos ",-1),W("h5",{class:"text-lg font-bold text-slate-800"},"Cursos",-1)])),"header-extra":u(()=>[p(I)(["course.create"])?(h(),U(k,{key:0,size:"large",type:"primary","render-icon":p(q)("additem"),onClick:i[0]||(i[0]=$=>v.value=!0)},{default:u(()=>i[3]||(i[3]=[D(" Agregar ")])),_:1},8,["render-icon"])):J("",!0)]),_:1}),a(Fe,{curriculumOptions:r.value},{extra:u(({reLoadDataTable:$})=>[a(te,{curriculumOptions:r.value,modelValue:v.value,"onUpdate:modelValue":i[1]||(i[1]=z=>v.value=z),item:null,onSuccess:$},null,8,["curriculumOptions","modelValue","onSuccess"])]),_:1},8,["curriculumOptions"])],64)):(h(),U(t,{key:1}))}}});export{ca as default};
