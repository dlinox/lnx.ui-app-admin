import{r as D,i as V}from"./DataTable.types-CWkwFvml.js";import{_ as W,a as Y,u as H,b as K,c as Q}from"./period.stores-BzAVm1e5.js";import{d as A,a9 as x,a4 as B,a6 as n,aa as t,ah as X,ag as h,h as z,e as ee,r as c,g as te,ae as O,ab as E,ai as $,aj as ae,ak as ne,a8 as le,al as L,am as oe,ac as F,_ as q}from"./index-BzGjg7HW.js";import{_ as se}from"./InputNumber-G1DKpt-n.js";import{a as ue,b as re,_ as ie}from"./FormItem-Baka7rSs.js";import{N as pe,_ as G,c as de,b as Z,a as me}from"./Col-B1xrStaH.js";import{u as _e,_ as ce}from"./composables-D42LVHns.js";import{_ as ve}from"./Dropdown-Q3lX7PM3.js";import{d as ge}from"./debounce.utils-DqPPCsFD.js";import"./get-Q-alL0iz.js";import"./ChevronRight-DqgmWN6z.js";const fe=A({__name:"DataTableOp",props:{item:{}},emits:["edit","delete"],setup(p,{emit:d}){const s=_e(),a=d,u=[{label:"Editar",key:"edit",icon:D("edit-2"),props:{onClick:()=>a("edit")}},{label:"Eliminar",key:"delete",icon:D("trash","red"),props:{style:{color:"red"},onClick:()=>{s.warning({title:"Confirmar",content:"¿Está seguro que desea eliminar este registro?",positiveText:"Eliminar",negativeText:"Cancelar",closable:!1,showIcon:!1,negativeButtonProps:{secondary:!0,type:"tertiary",size:"large"},positiveButtonProps:{size:"large",type:"error"},onPositiveClick:()=>{a("delete")}})}}}];return(g,r)=>{const l=h,o=ve;return x(),B(o,{options:u,placement:"bottom-start"},{default:n(()=>[t(l,null,{default:n(()=>[t(X,{"icon-name":"setting-5",size:"20"})]),_:1})]),_:1})}}}),j=[{value:1,label:"ENERO"},{value:2,label:"FEBRERO"},{value:3,label:"MARZO"},{value:4,label:"ABRIL"},{value:5,label:"MAYO"},{value:6,label:"JUNIO"},{value:7,label:"JULIO"},{value:8,label:"AGOSTO"},{value:9,label:"SEPTIEMBRE"},{value:10,label:"OCTUBRE"},{value:11,label:"NOVIEMBRE"},{value:12,label:"DICIEMBRE"}],be=(p,d)=>[{title:"Ops.",key:"ops",width:"80px",fixed:"left",render(s){const a=s;return z(fe,{onEdit:()=>{p(a)},onDelete:()=>{d(a)},item:a},{default:()=>"Editar"})}},{title:"Año",key:"year",minWidth:"150px"},{title:"Mes",key:"month",minWidth:"150px",render:s=>{const a=j.find(u=>u.value===s.month);return z("span",a==null?void 0:a.label)}},{title:"Estado",key:"status",width:"150px",render:s=>z(pe,{type:s.status=="FINALIZADO"?"default":s.status=="CANCELADO"?"error":s.status=="EN CURSO"?"success":s.status=="MATRICULA"?"info":"warning",tertiary:!0,bordered:!1,strong:!0},{default:()=>s.status})}],ye=(p=V())=>({page:p.page,total:p.total,pageSize:p.pageSize,pageCount:p.pageCount,showSizePicker:!0,pageSizes:[10,50,100,500,1e3,5e3],style:{paddingRight:"16px",paddingBottom:"12px"},prefix(){return`Total ${p.total} registros`}}),Ee=[{value:"PENDIENTE",label:"PENDIENTE"},{value:"MATRICULA",label:"MATRICULA"},{value:"EN CURSO",label:"EN CURSO"},{value:"FINALIZADO",label:"FINALIZADO"},{value:"CANCELADO",label:"CANCELADO"}],P=()=>({id:null,year:new Date().getFullYear(),month:new Date().getMonth()+1,status:null}),Ie=()=>({year:[{type:"number",required:!0,trigger:["blur","input"],message:"Obligatorio"}],month:[{type:"number",required:!0,trigger:["blur","input"],message:"Obligatorio"}],status:[{required:!0,trigger:["blur","change"],message:"Obligatorio"}]}),J=A({__name:"PeriodForm",props:{item:{},modelValue:{type:Boolean}},emits:["update:modelValue","success"],setup(p,{emit:d}){const s=d,a=p,u=ee({get:()=>a.modelValue,set:m=>s("update:modelValue",m)}),g=c(!1),r=c(null),l=c(P()),o=c(null),U=c({...Ie()}),M=async()=>{if(r.value){const m=await r.value.validate();let e=null;m?(g.value=!0,l.value.id?e=await W(l.value):e=await Y(l.value),e.status?(s("success"),u.value=!1):o.value=e.data):console.log("Formulario inválido")}g.value=!1},S=()=>{console.log("Inicializando formulario"),l.value=a.item?{...a.item}:P()};return te(u,m=>{m&&S()}),(m,e)=>{const R=se,I=ue,C=G,T=de,v=Z,b=re,y=h,k=me,N=$,w=ae;return x(),B(w,{show:u.value,"onUpdate:show":e[7]||(e[7]=i=>u.value=i)},{default:n(()=>[t(N,{style:{width:"500px"},title:m.item?"EDITAR REGISTRO":"NUEVO REGISTRO",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:n(()=>[t(k,{justify:"end"},{default:n(()=>[t(y,{tertiary:"",size:"large",onClick:e[6]||(e[6]=i=>u.value=!1),disabled:g.value},{default:n(()=>e[8]||(e[8]=[O(" Cancelar ")])),_:1},8,["disabled"]),t(y,{size:"large",type:"primary",onClick:M,loading:g.value},{default:n(()=>e[9]||(e[9]=[O("Guardar")])),_:1},8,["loading"])]),_:1})]),default:n(()=>[t(b,{ref_key:"formRef",ref:r,model:l.value,rules:U.value,size:"large"},{default:n(()=>[t(v,{gutter:16},{default:n(()=>[t(C,{span:"12"},{default:n(()=>{var i;return[t(I,{path:"year",label:"Año",feedback:(i=o.value)==null?void 0:i.year},{default:n(()=>{var _;return[t(R,{clearable:"",maxlength:"4",status:((_=o.value)==null?void 0:_.year)!=null?"error":"",value:l.value.year,"onUpdate:value":e[0]||(e[0]=f=>l.value.year=f),valueModifiers:{number:!0},onInput:e[1]||(e[1]=f=>o.value!=null?o.value.year=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1}),t(C,{span:"12"},{default:n(()=>{var i;return[t(I,{path:"month",label:"Mes",feedback:(i=o.value)==null?void 0:i.month},{default:n(()=>{var _;return[t(T,{clearable:"",value:l.value.month,"onUpdate:value":e[2]||(e[2]=f=>l.value.month=f),options:E(j),"virtual-scroll":!1,status:((_=o.value)==null?void 0:_.month)!=null?"error":"",onInput:e[3]||(e[3]=f=>o.value!=null?o.value.month=null:()=>{})},null,8,["value","options","status"])]}),_:1},8,["feedback"])]}),_:1}),t(C,{span:"24"},{default:n(()=>{var i;return[t(I,{path:"status",label:"Estado",feedback:(i=o.value)==null?void 0:i.status},{default:n(()=>{var _;return[t(T,{clearable:"",value:l.value.status,"onUpdate:value":e[4]||(e[4]=f=>l.value.status=f),options:E(Ee),"virtual-scroll":!1,status:((_=o.value)==null?void 0:_.status)!=null?"error":"",onInput:e[5]||(e[5]=f=>o.value!=null?o.value.status=null:()=>{})},null,8,["value","options","status"])]}),_:1},8,["feedback"])]}),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),Ce={style:{"border-bottom":"1px solid #e9e9e9"}},we=A({__name:"DataTable",setup(p){const d=H(),s=c(!1),a=c([]),u=c(!1),g=c(null),r=ne({...V()}),l=c({search:null,page:r.page,pageSize:r.pageSize}),o=c({}),S=be(v=>{g.value=v,u.value=!0},async v=>{await Q(v),await m()}),m=async()=>{l.value.page=1,await e()},e=async()=>{s.value=!0,await d.getCurrent(),await d.getEnrollment(),o.value=await K(l.value),a.value=o.value.data,r.total=o.value.total,r.pageSize=o.value.per_page,r.page=o.value.current_page,r.pageCount=o.value.last_page,s.value=!1},R=ge(()=>{m()},400),I=async v=>{l.value.page=v,await e()},C=async v=>{l.value.page=1,l.value.pageSize=v,await e()};return(async()=>{await e()})(),(v,b)=>{const y=G,k=le("LnxIcon"),N=ie,w=Z,i=ce;return x(),L(q,null,[oe(v.$slots,"extra",{reLoadDataTable:m}),F("div",Ce,[t(w,{gutter:12,style:{padding:"12px 16px"}},{default:n(()=>[t(y,{span:12}),t(y,{span:12},{default:n(()=>[t(N,{size:"large",placeholder:"Buscar",value:l.value.search,"onUpdate:value":b[0]||(b[0]=_=>l.value.search=_),onInput:E(R),clearable:""},{suffix:n(()=>[t(k,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),t(w,null,{default:n(()=>[t(y,{span:24},{default:n(()=>[t(i,{key:"id",remote:"","single-line":!1,columns:E(S),data:a.value,pagination:E(ye)(r),"pagination-show-size-picker":!0,loading:s.value,"onUpdate:page":I,"onUpdate:pageSize":C},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1})]),t(J,{modelValue:u.value,"onUpdate:modelValue":b[1]||(b[1]=_=>u.value=_),item:g.value,onSuccess:m},null,8,["modelValue","item"])],64)}}}),Ue=A({__name:"index",setup(p){const d=c(!1);return(s,a)=>{const u=h,g=$;return x(),L(q,null,[t(g,{segmented:{header:!0,content:!0,footer:!0}},{header:n(()=>a[2]||(a[2]=[F("h6",{style:{"font-size":"14px",color:"#999",margin:"0"}}," Gestión Periodos Académicos ",-1),O(" Periodos Académicos ")])),"header-extra":n(()=>[t(u,{"render-icon":E(D)("additem"),onClick:a[0]||(a[0]=r=>d.value=!0)},{default:n(()=>a[3]||(a[3]=[O(" Agregar ")])),_:1},8,["render-icon"])]),_:1}),t(we,null,{extra:n(({reLoadDataTable:r})=>[t(J,{modelValue:d.value,"onUpdate:modelValue":a[1]||(a[1]=l=>d.value=l),item:null,onSuccess:r},null,8,["modelValue","onSuccess"])]),_:1})],64)}}});export{Ue as default};
