import{d as ne,a5 as le,r as m,aI as oe,a9 as r,aj as h,aa as o,a6 as e,ac as l,ae as _,ab as p,ao as u,_ as S,az as A,a4 as g,ad as E,al as ae,ag as ue}from"./index-BDy3jz-R.js";import{r as se}from"./icon.utils-BzaQiRL0.js";import{u as re}from"./useBreakpoints-3aRiryBT.js";import{_ as de,a as ie,b as me,c as _e}from"./EditEnrollmentGroup.vue_vue_type_script_setup_true_lang-0bhR_yRn.js";import{h as ce}from"./student.services-EGZtlMWC.js";import{_ as pe}from"./selectables.services-Dh18oZu3.js";import{u as fe}from"./period.stores-BvmieFtA.js";import{_ as ge,a as ve,b as be,c as ye,d as Ie}from"./EnrollmentModuleForm.vue_vue_type_script_setup_true_lang-CMl7ENFf.js";import{c as he,b as we,_ as ke,N as Ee,a as Ne}from"./Col-C2AyWxkb.js";import{_ as Se}from"./Spin-RpCxu1RK.js";import{a as Ce,b as xe,_ as Me}from"./Thing-Db17URGU.js";import"./Alert-BTRVvkM7.js";import"./FormItem-DAU9UqDA.js";import"./get-I814HMgj.js";import"./DataTable.types-DKc2i3jV.js";import"./composables-D20BIpNr.js";import"./Dropdown-DschnT-y.js";const Ve={class:"p-4"},Be={class:"flex justify-end bg-gray-100 p-4 -mx-6 -mt-6 mb-4"},$e={class:"text-lg font-semibold w-full text-blue-800 p-2"},Re={key:1},Ye=ne({__name:"EnrollmentStudentView",setup(Ae){const{screenSize:F}=re(),T=le(),v=fe(),C=m(!1),x=m(!1),b=m(null),G=m(null),M=m([]),V=m(!0),d=m({}),D=m(!0),P=m(null),U=m(null),z=m(null),W=async f=>{let t=await _e({id:f}),I=new Blob([t],{type:"application/pdf"}),w=window.URL.createObjectURL(I),c=document.getElementById("printFrame");c.src=w,c.onload=function(){var k;(k=c.contentWindow)==null||k.print()}},q=async()=>{const f=T.params.id;V.value=!0,d.value=await ce(f),V.value=!1},y=async()=>{var I;const f=T.params.id,t=(I=G.value)==null?void 0:I.id;D.value=!0,P.value=await ie(f,b.value,t),D.value=!1},B=(f,t=null)=>{U.value=f,z.value=t,x.value=!0},H=async()=>{M.value=await pe(),b.value=M.value[0].value,q(),y()};return oe(()=>{H()}),(f,t)=>{const I=he,w=ae,c=ve,k=we,J=Se,L=ke,$=Ee,R=ue,K=ye,Q=Ce,X=xe,Y=Me,Z=Ie,ee=be,te=Ne;return r(),h(S,null,[o(w,{segmented:{header:!0,footer:!0,content:!0}},{header:e(()=>t[4]||(t[4]=[l("h6",{style:{color:"#999",margin:"0"}},"Matricular estudiante",-1),_(" Nombre del estudiante ")])),"header-extra":e(()=>[o(I,{value:b.value,"onUpdate:value":[t[0]||(t[0]=n=>b.value=n),y],placeholder:"Seleccionar Plan de estudio",filterable:"",options:M.value,"virtual-scroll":!1,"default-value":1},null,8,["value","options"])]),action:e(()=>t[5]||(t[5]=[])),_:1}),l("div",Ve,[o(te,{gutter:16},{default:e(()=>[o(L,{span:p(F)=="lg"?6:24},{default:e(()=>[o(w,{segmented:{header:!0,content:!0},title:"InformaciÃ³n Personal",subtitle:"Datos del estudiante"},{default:e(()=>[o(J,{show:V.value},{default:e(()=>[o(k,{vertical:""},{default:e(()=>[o(c,{class:"small",label:"Tipo de estudiante"},{default:e(()=>{var n;return[_(u((n=d.value)==null?void 0:n.studentType),1)]}),_:1}),o(c,{class:"small",label:"Documento"},{default:e(()=>{var n,s;return[_(u((n=d.value)!=null&&n.documentNumber?(s=d.value)==null?void 0:s.documentNumber:"No registrado"),1)]}),_:1}),o(c,{class:"small",label:"Nombres"},{default:e(()=>{var n;return[_(u((n=d.value)==null?void 0:n.fullName),1)]}),_:1}),o(c,{class:"small",label:"Correo electronico"},{default:e(()=>{var n,s;return[_(u((n=d.value)!=null&&n.email?(s=d.value)==null?void 0:s.email:"No registrado"),1)]}),_:1}),o(c,{class:"small",label:"Telefono"},{default:e(()=>{var n,s;return[_(u((n=d.value)!=null&&n.phone?(s=d.value)==null?void 0:s.phone:"No registrado"),1)]}),_:1})]),_:1})]),_:1},8,["show"])]),_:1})]),_:1},8,["span"]),o(L,{span:p(F)=="lg"?18:24},{default:e(()=>[o(w,{segmented:{header:!0,content:!0},title:"Matricula"},{"header-extra":e(()=>[o($,{bordered:!1,type:p(v).enrollment?"info":"error"},{default:e(()=>{var n;return[l("strong",null,u(p(v).enrollment?(n=p(v).enrollment)==null?void 0:n.name:"No habilitado"),1)]}),_:1},8,["type"])]),default:e(()=>[l("div",Be,[o(R,{type:"primary",onClick:t[1]||(t[1]=n=>C.value=!0),disabled:!p(v).enrollment},{default:e(()=>t[6]||(t[6]=[_(" Agregar Modulo ")])),_:1},8,["disabled"])]),o(ee,null,{default:e(()=>{var n;return[(r(!0),h(S,null,A((n=P.value)==null?void 0:n.enrollments,s=>(r(),g(Z,{key:s.moduleId,name:s.moduleId},{header:e(()=>[l("h2",$e,u(s.moduleName)+" "+u(s.isExtracurricular?"(Extracurricular)":""),1)]),default:e(()=>[o(Y,{hoverable:"",clickable:""},{default:e(()=>[(r(!0),h(S,null,A(s.courses,i=>(r(),g(X,{key:i.id},{default:e(()=>[o(Q,{title:`${i.code} - ${i.name}`},{"header-extra":e(()=>[i.enrollmentGroups.length==0||Math.max(...i.enrollmentGroups.map(a=>a.grade))<11&&i.enrollmentGroups.filter(a=>a.groupStatus=="ABIERTO").length==0?(r(),g(R,{key:0,type:"primary",onClick:a=>B(i.id)},{default:e(()=>t[7]||(t[7]=[_(" Matricular ")])),_:2},1032,["onClick"])):E("",!0)]),description:e(()=>[o(k,{size:"small"},{default:e(()=>[o($,{bordered:!1,size:"small"},{default:e(()=>[_(" Area: "+u(i.area),1)]),_:2},1024)]),_:2},1024)]),default:e(()=>[i.enrollmentGroups.length>0?(r(),g(K,{key:0,"single-line":!1},{default:e(()=>[t[9]||(t[9]=l("thead",null,[l("tr",null,[l("th",{colspan:"2"},"Matricula"),l("th",{colspan:"3"},"Grupo"),l("th",{colspan:"2"})]),l("tr",null,[l("th",null,"Periodo"),l("th",null,"Estado"),l("th",null,"Grupo"),l("th",null,"Modalidad"),l("th",null,"Estado"),l("th",{rowspan:"2"},"Nota"),l("th",null,"Acciones")])],-1)),l("tbody",null,[(r(!0),h(S,null,A(i.enrollmentGroups,a=>{var j,O;return r(),h("tr",null,[l("td",null,[((j=p(v).enrollment)==null?void 0:j.name)==a.period?(r(),g($,{key:0,type:"info"},{default:e(()=>[_(u(a.period),1)]),_:2},1024)):(r(),h("span",Re,u(a.period),1))]),l("td",null,u(a.enrollmentStatus),1),l("td",null,u(a.groupName),1),l("td",null,u(a.groupModality),1),l("td",null,u(a.groupStatus),1),l("td",null,u(a.grade),1),l("td",null,[((O=p(v).enrollment)==null?void 0:O.name)==a.period?(r(),g(me,{key:0,item:a,onResetEnrollment:N=>B(i.id,N),onChangeGroup:N=>B(i.id,N),onReserveEnrollment:y,onCancelEnrollment:y},null,8,["item","onResetEnrollment","onChangeGroup"])):E("",!0),a.enrollmentStatus==="MATRICULADO"?(r(),g(R,{key:1,"render-icon":p(se)("printer"),onClick:N=>W(a.id)},{default:e(()=>t[8]||(t[8]=[_(" Ficha ")])),_:2},1032,["render-icon","onClick"])):E("",!0)])])}),256))])]),_:2},1024)):E("",!0)]),_:2},1032,["title"])]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["name"]))),128))]}),_:1})]),_:1})]),_:1},8,["span"])]),_:1})]),t[10]||(t[10]=l("iframe",{id:"printFrame",style:{display:"none"}},null,-1)),d.value?(r(),g(ge,{key:0,modelValue:C.value,"onUpdate:modelValue":t[2]||(t[2]=n=>C.value=n),studentId:d.value.id,curriculumId:b.value,onSuccess:y},null,8,["modelValue","studentId","curriculumId"])):E("",!0),o(de,{modelValue:x.value,"onUpdate:modelValue":t[3]||(t[3]=n=>x.value=n),studentId:d.value.id,curriculumId:b.value,courseId:U.value,enrollmetGroup:z.value,onSuccess:y},null,8,["modelValue","studentId","curriculumId","courseId","enrollmetGroup"])],64)}}});export{Ye as default};
