import{r as B}from"./icon.utils-CmxuJXeQ.js";import{d as $,a3 as H,a9 as V,ad as M,ae as f,aa as k,ab as t,ac as e,ag as U,aH as q,h as F,az as ee,e as te,r as c,j as ae,aB as j,aA as D,aI as ne,aJ as oe,aG as L,_ as J,af as N,aK as se,a8 as le}from"./index-CHKdQ-q5.js";import{i as K,a as re}from"./DataTable.types-BEg5m_To.js";import{_ as ie}from"./InputNumber-BQNEmfKd.js";import{_ as ue,a as pe}from"./FormItem-BobmnhmY.js";import{_ as W,a as Q}from"./Col-G0czzw1d.js";import{_ as X}from"./Input-C-7cIp0X.js";import{_ as me}from"./Space-WaWU-eRg.js";import{_ as de}from"./Switch-Cam2dNBn.js";import{d as ce}from"./debounce.utils-DqPPCsFD.js";import{u as _e}from"./composables-CsGV-aUD.js";import{_ as ge}from"./Dropdown-CRs7219k.js";import{N as fe}from"./Tag-Cy27tpc_.js";import{_ as ve}from"./DataTable-COM0A82O.js";import"./Suffix-C8CazGck.js";import"./use-merged-state-CFtIg60l.js";import"./get-_S_LWlCl.js";import"./Popover-CP6C22MG.js";import"./Tooltip-BVDsciO5.js";import"./Select-CjOGNBL7.js";const ye=$({__name:"DataTableOp",props:{item:{}},emits:["edit","delete"],setup(l,{emit:o}){const{hasPermission:r}=H(),p=_e(),n=o,i=[{label:"Editar",key:"edit",icon:B("edit-2"),show:r(["payment-type.edit"]),props:{onClick:()=>n("edit")}},{label:"Eliminar",key:"delete",icon:B("trash","red"),show:r(["payment-type.delete"]),props:{style:{color:"red"},onClick:()=>{p.warning({title:"Confirmar",content:"¿Está seguro que desea eliminar este registro?",positiveText:"Eliminar",negativeText:"Cancelar",closable:!1,showIcon:!1,negativeButtonProps:{secondary:!0,type:"tertiary",size:"large"},positiveButtonProps:{size:"large",type:"error"},onPositiveClick:()=>{n("delete")}})}}}];return(m,s)=>{const u=U,v=ge;return f(r)(["payment-type.edit","payment-type.delete"])?(k(),V(v,{key:0,options:i,placement:"bottom-start"},{default:t(()=>[e(u,null,{default:t(()=>[e(q,{"icon-name":"setting-5",size:"20"})]),_:1})]),_:1})):M("",!0)}}}),be=(l,o)=>[{title:"Ops.",key:"ops",width:"80px",fixed:"left",render(r){const p=r;return F(ye,{onEdit:()=>{l(p)},onDelete:()=>{o(p)},item:p},{default:()=>"Editar"})}},{title:"Nombre",key:"name",minWidth:"300px"},{title:"Comisión (S/.)",key:"commission",width:"120px",align:"right"},{title:"Habilitado",key:"isEnabled",width:"150px",render:r=>F(fe,{type:r.isEnabled?"success":"error",tertiary:!0,bordered:!1,strong:!0},{default:()=>r.isEnabled?"	Habilitado":"Deshabilitado"})}],we=(l=K())=>({page:l.page,total:l.total,pageSize:l.pageSize,pageCount:l.pageCount,showSizePicker:!0,pageSizes:[10,50,100,500,1e3,5e3],style:{paddingRight:"16px",paddingBottom:"12px"},prefix(){return`Total ${l.total} registros`}}),G=()=>({id:null,name:null,commission:0,isEnabled:!0}),ke=()=>({name:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}],commission:[{type:"number",required:!0,trigger:["blur","input"],message:"Obligatorio"}]}),A=ee(),O="/payment-type",xe=async l=>{try{return(await A.post(`${O}/load-data-table`,l)).data.data}catch{return re()}},ze=async l=>{try{return{status:!0,data:(await A.post(`${O}/save`,l)).data.data}}catch(o){return o.response.status===422?{status:!1,data:o.response.data.errors}:{status:!1,data:null}}},he=async l=>{try{return await A.delete(`${O}`,{data:{id:l.id}}),!0}catch{return!1}},Y=$({__name:"PaymentTypeForm",props:{item:{},modelValue:{type:Boolean}},emits:["update:modelValue","success"],setup(l,{emit:o}){const r=o,p=l,n=te({get:()=>p.modelValue,set:d=>r("update:modelValue",d)}),i=c(!1),m=c(null),s=c(G()),u=c(null),v=c({...ke()}),I=async()=>{if(m.value){const d=await m.value.validate();let a=null;d?(i.value=!0,a=await ze(s.value),a.status?(r("success"),n.value=!1):u.value=a.data):console.log("Formulario inválido")}i.value=!1},y=()=>{s.value=p.item?{...p.item}:G()};return ae(n,d=>{d&&y()}),(d,a)=>{const P=X,x=pe,E=Q,_=ie,b=de,w=me,R=W,S=ue,T=U,z=j,Z=ne;return k(),V(Z,{show:n.value,"onUpdate:show":a[6]||(a[6]=g=>n.value=g)},{default:t(()=>[e(z,{style:{width:"500px"},title:d.item?"EDITAR REGISTRO":"NUEVO REGISTRO",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:t(()=>[e(w,{justify:"end"},{default:t(()=>[e(T,{tertiary:"",size:"large",onClick:a[5]||(a[5]=g=>n.value=!1),disabled:i.value},{default:t(()=>a[7]||(a[7]=[D(" Cancelar ")])),_:1},8,["disabled"]),e(T,{size:"large",type:"primary",onClick:I,loading:i.value},{default:t(()=>a[8]||(a[8]=[D("Guardar")])),_:1},8,["loading"])]),_:1})]),default:t(()=>[e(S,{ref_key:"formRef",ref:m,model:s.value,rules:v.value,size:"large"},{default:t(()=>[e(R,null,{default:t(()=>[e(E,{span:"24"},{default:t(()=>{var g;return[e(x,{path:"name",label:"Nombre",feedback:(g=u.value)==null?void 0:g.name},{default:t(()=>{var h;return[e(P,{status:((h=u.value)==null?void 0:h.name)!=null?"error":"",value:s.value.name,"onUpdate:value":a[0]||(a[0]=C=>s.value.name=C),onInput:a[1]||(a[1]=C=>u.value!=null?u.value.name=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1}),e(E,{span:"24"},{default:t(()=>{var g;return[e(x,{path:"commission",label:"Comisión (S/.)",feedback:(g=u.value)==null?void 0:g.commission},{default:t(()=>{var h;return[e(_,{class:"w-full",min:0,status:((h=u.value)==null?void 0:h.commission)!=null?"error":"",value:s.value.commission,"onUpdate:value":a[2]||(a[2]=C=>s.value.commission=C),onInput:a[3]||(a[3]=C=>u.value!=null?u.value.commission=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1}),e(E,{span:"24"},{default:t(()=>[e(w,{justify:"end"},{default:t(()=>[e(x,{"label-placement":"left",label:"¿Habilitado?",path:"isEnabled","show-feedback":!1},{default:t(()=>[e(b,{value:s.value.isEnabled,"onUpdate:value":a[4]||(a[4]=g=>s.value.isEnabled=g)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),Ce={style:{"border-bottom":"1px solid #e9e9e9"}},Ee=$({__name:"DataTable",setup(l){const o=c(!1),r=c([]),p=c(!1),n=c(null),i=oe({...K()}),m=c({search:null,page:i.page,pageSize:i.pageSize}),s=c({}),I=be(_=>{n.value=_,p.value=!0},async _=>{await he(_),await y()}),y=async()=>{m.value.page=1,await d()},d=async()=>{o.value=!0,s.value=await xe(m.value),r.value=s.value.data,i.total=s.value.total,i.pageSize=s.value.per_page,i.page=s.value.current_page,i.pageCount=s.value.last_page,o.value=!1},a=ce(()=>{y()},400),P=async _=>{m.value.page=_,await d()},x=async _=>{m.value.page=1,m.value.pageSize=_,await d()};return(async()=>{await d()})(),(_,b)=>{const w=Q,R=X,S=W,T=ve;return k(),L(J,null,[N("div",Ce,[e(S,{gutter:12,style:{padding:"12px 16px"}},{default:t(()=>[e(w,{span:12}),e(w,{span:12},{default:t(()=>[e(R,{size:"large",placeholder:"Buscar",value:m.value.search,"onUpdate:value":b[0]||(b[0]=z=>m.value.search=z),onInput:f(a),clearable:""},{suffix:t(()=>[e(q,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),e(S,null,{default:t(()=>[e(w,{span:24},{default:t(()=>[e(T,{key:"id",remote:"",size:"small","single-line":!1,columns:f(I),data:r.value,pagination:f(we)(i),"pagination-show-size-picker":!0,loading:o.value,"onUpdate:page":P,"onUpdate:pageSize":x},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),se(_.$slots,"extra",{reLoadDataTable:y})]),e(Y,{modelValue:p.value,"onUpdate:modelValue":b[1]||(b[1]=z=>p.value=z),item:n.value,onSuccess:y},null,8,["modelValue","item"])],64)}}}),Je=$({__name:"index",setup(l){const{hasPermission:o}=H(),r=c(!1);return(p,n)=>{const i=U,m=j,s=le("AppNotAuthorization");return f(o)(["payment-type.create","payment-type.update","payment-type.delete"])?(k(),L(J,{key:0},[e(m,{segmented:{header:!0,content:!0}},{header:t(()=>n[2]||(n[2]=[N("span",{class:"text-sm text-slate-500"}," Gestionar los tipos de pago ",-1),N("h5",{class:"text-lg font-bold text-slate-800"},"Tipos de pago",-1)])),"header-extra":t(()=>[f(o)(["payment-type.create"])?(k(),V(i,{key:0,type:"primary",size:"large","render-icon":f(B)("additem"),onClick:n[0]||(n[0]=u=>r.value=!0)},{default:t(()=>n[3]||(n[3]=[D(" Agregar ")])),_:1},8,["render-icon"])):M("",!0)]),_:1}),e(Ee,null,{extra:t(({reLoadDataTable:u})=>[e(Y,{modelValue:r.value,"onUpdate:modelValue":n[1]||(n[1]=v=>r.value=v),item:null,onSuccess:u},null,8,["modelValue","onSuccess"])]),_:1})],64)):(k(),V(s,{key:1}))}}});export{Je as default};
