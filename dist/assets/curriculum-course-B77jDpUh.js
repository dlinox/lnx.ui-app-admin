import{r as X}from"./icon.utils-Co33Gfj7.js";import{al as P,d as D,e as Y,r as f,g as ee,a3 as ae,a4 as l,ah as te,i as le,a7 as M,a8 as a,ab as x,a9 as g,ac as j,ai as O,aj as ue,ad as G,af as N,ak as se,Z as A,a5 as H,p as ne,ag as oe}from"./index-q5WTydet.js";import{h,i as re,e as de,j as ie,k as pe}from"./curriculum.services-xrwXmPh7.js";import{_ as ce}from"./LnxIcon.vue_vue_type_script_setup_true_lang-BrDmhFYV.js";import{f as me,g as ve,_ as L,a as fe,b as _e,c as Z,i as be,d as ge,e as Ie}from"./debounce.utils-CNomnN_y.js";import{d as ye,e as we}from"./course.services-Cj383jwa.js";import{d as ke}from"./area.services-CyK_Sv1b.js";import{d as Ce}from"./module.services-BXRQHIft.js";import{u as $e}from"./useBreakpoints-FeJJ1KSa.js";import{_ as Re}from"./InputNumber-CBBO-FqA.js";import{a as Ue,_ as J,b as Se}from"./FormItem-CfLS_ziG.js";import"./get-C77LKGbM.js";import"./format-length-B-p6aW7q.js";import"./Remove-8GogKFWM.js";const z="/curriculum/course",Ve=async _=>{try{return(await P().post(`${z}/load-data-table`,_)).data.data}catch{return me()}},Te=async _=>{try{return{status:!0,data:(await P().post(z,_)).data.data}}catch(r){return r.response.status===422?{status:!1,data:r.response.data.errors}:{status:!1,data:null}}},Pe=async _=>{try{return{status:!0,data:(await P().put(z,_)).data.data}}catch(r){return r.response.status===422?{status:!1,data:r.response.data.errors}:{status:!1,data:null}}},ze=async _=>{try{return await P().delete(z,{data:{id:_.id}}),!0}catch{return!1}},Ee=async _=>{try{return(await P().get(`${z}/get-item-by-id/${_}`)).data.data}catch{return h()}},K=D({__name:"CurriculumCourseForm",props:{item:{},modelValue:{type:Boolean},selectables:{}},emits:["update:modelValue","success"],setup(_,{emit:r}){const{screenSize:i}=$e(),w=le("curriculum"),C=r,y=_,d=Y({get:()=>y.modelValue,set:c=>C("update:modelValue",c)}),m=f(!1),b=f(null),t=f(h()),u=f(null),E=f({...re()}),F=async()=>{if(b.value){const c=await b.value.validate();let e=null;c?(m.value=!0,t.value.curriculumId=w.value.id,t.value.id?e=await Pe(t.value):e=await Te(t.value),e.status?(C("success"),d.value=!1):u.value=e.data):console.log("Formulario inválido")}m.value=!1},$=async()=>{var c;(c=y.item)!=null&&c.id?t.value=await Ee(y.item.id):t.value=h()},R=async()=>{await $(),t.value.curriculumId=w.value.id};return ee(d,c=>{c&&R()}),(c,e)=>{const U=ve,I=Ue,v=L,p=Re,k=J,S=fe,T=_e,q=Z,B=Se,V=j,Q=O,W=te;return M(),ae(W,{show:d.value,"onUpdate:show":e[22]||(e[22]=s=>d.value=s)},{default:l(()=>[a(Q,{style:{width:"800px"},title:c.item?"EDITAR REGISTRO":"NUEVO REGISTRO",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:l(()=>[a(T,{justify:"end"},{default:l(()=>[a(V,{tertiary:"",size:"large",onClick:e[21]||(e[21]=s=>d.value=!1),disabled:m.value},{default:l(()=>e[23]||(e[23]=[x(" Cancelar ")])),_:1},8,["disabled"]),a(V,{size:"large",type:"primary",onClick:F,loading:m.value},{default:l(()=>e[24]||(e[24]=[x("Guardar")])),_:1},8,["loading"])]),_:1})]),default:l(()=>[a(B,{ref_key:"formRef",ref:b,model:t.value,rules:E.value,size:"large"},{default:l(()=>[a(q,{gutter:16},{default:l(()=>[a(v,{span:g(i)==="sm"?24:12},{default:l(()=>{var s;return[a(I,{path:"areaId",label:"Área",feedback:(s=u.value)==null?void 0:s.areaId},{default:l(()=>{var n;return[a(U,{value:t.value.areaId,"onUpdate:value":e[0]||(e[0]=o=>t.value.areaId=o),options:c.selectables.areaItems,filterable:"",clearable:"","virtual-scroll":!1,status:((n=u.value)==null?void 0:n.areaId)!=null?"error":"","onOnUpdate:value":e[1]||(e[1]=o=>u.value!=null?u.value.areaId=null:()=>{})},null,8,["value","options","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(v,{span:g(i)==="sm"?24:12},{default:l(()=>{var s;return[a(I,{path:"moduleId",label:"Módulo",feedback:(s=u.value)==null?void 0:s.moduleId},{default:l(()=>{var n;return[a(U,{value:t.value.moduleId,"onUpdate:value":e[2]||(e[2]=o=>t.value.moduleId=o),options:c.selectables.moduleItems,filterable:"",clearable:"","virtual-scroll":!1,status:((n=u.value)==null?void 0:n.moduleId)!=null?"error":"","onOnUpdate:value":e[3]||(e[3]=o=>u.value!=null?u.value.moduleId=null:()=>{})},null,8,["value","options","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(v,{span:g(i)==="sm"?12:4},{default:l(()=>{var s;return[a(I,{path:"order",label:"Orden",feedback:(s=u.value)==null?void 0:s.order},{default:l(()=>{var n;return[a(p,{style:{width:"100%"},clearable:"",value:t.value.order,"onUpdate:value":e[4]||(e[4]=o=>t.value.order=o),status:((n=u.value)==null?void 0:n.order)!=null?"error":"",onInput:e[5]||(e[5]=o=>u.value!=null?u.value.order=null:()=>{})},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(v,{span:g(i)==="sm"?12:4},{default:l(()=>{var s;return[a(I,{path:"code",label:"Código",feedback:(s=u.value)==null?void 0:s.code},{default:l(()=>{var n;return[a(k,{value:t.value.code,"onUpdate:value":[e[6]||(e[6]=o=>t.value.code=o),e[7]||(e[7]=o=>u.value!=null?u.value.code=null:()=>{})],status:((n=u.value)==null?void 0:n.code)!=null?"error":""},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(v,{span:g(i)==="sm"?24:16},{default:l(()=>{var s;return[a(I,{path:"courseId",label:"Curso",feedback:(s=u.value)==null?void 0:s.courseId},{default:l(()=>{var n;return[a(U,{filterable:"",clearable:"",options:c.selectables.courseItems,"virtual-scroll":!1,value:t.value.courseId,"onUpdate:value":[e[8]||(e[8]=o=>t.value.courseId=o),e[9]||(e[9]=o=>u.value!=null?u.value.courseId=null:()=>{})],status:((n=u.value)==null?void 0:n.courseId)!=null?"error":""},null,8,["options","value","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(v,{span:g(i)==="sm"?24:8},{default:l(()=>{var s;return[a(I,{path:"credits",label:"Créditos",feedback:(s=u.value)==null?void 0:s.credits},{default:l(()=>{var n;return[a(p,{style:{width:"100%"},clearable:"",value:t.value.credits,"onUpdate:value":e[10]||(e[10]=o=>t.value.credits=o),status:((n=u.value)==null?void 0:n.credits)!=null?"error":"",onInput:e[11]||(e[11]=o=>u.value!=null?u.value.credits=null:()=>{})},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(v,{span:g(i)==="sm"?24:8},{default:l(()=>{var s;return[a(I,{path:"hoursPractice",label:"Horas Practicas",feedback:(s=u.value)==null?void 0:s.hoursPractice},{default:l(()=>{var n;return[a(p,{style:{width:"100%"},clearable:"",value:t.value.hoursPractice,"onUpdate:value":e[12]||(e[12]=o=>t.value.hoursPractice=o),status:((n=u.value)==null?void 0:n.hoursPractice)!=null?"error":"",onInput:e[13]||(e[13]=o=>u.value!=null?u.value.hoursPractice=null:()=>{})},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(v,{span:g(i)==="sm"?24:8},{default:l(()=>{var s;return[a(I,{path:"hoursTheory",label:"Horas Teoricas",feedback:(s=u.value)==null?void 0:s.hoursTheory},{default:l(()=>{var n;return[a(p,{style:{width:"100%"},clearable:"",value:t.value.hoursTheory,"onUpdate:value":e[14]||(e[14]=o=>t.value.hoursTheory=o),status:((n=u.value)==null?void 0:n.hoursTheory)!=null?"error":"",onInput:e[15]||(e[15]=o=>u.value!=null?u.value.hoursTheory=null:()=>{})},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(v,{span:(g(i)==="sm",24)},{default:l(()=>{var s;return[a(I,{path:"preRequisiteId",label:"Pre-Requisito",feedback:(s=u.value)==null?void 0:s.preRequisiteId},{default:l(()=>{var n;return[a(U,{clearable:"",filterable:"",options:c.selectables.preRequisiteItems,"virtual-scroll":!1,value:t.value.preRequisiteId,"onUpdate:value":[e[16]||(e[16]=o=>t.value.preRequisiteId=o),e[17]||(e[17]=o=>u.value!=null?u.value.preRequisiteId=null:()=>{})],status:((n=u.value)==null?void 0:n.preRequisiteId)!=null?"error":""},null,8,["options","value","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(v,{span:"24"},{default:l(()=>[a(T,{justify:"end"},{default:l(()=>[a(I,{"label-placement":"left",label:"¿Extracurricular?",path:"isExtracurricular","show-feedback":!1},{default:l(()=>[a(S,{value:t.value.isExtracurricular,"onUpdate:value":[e[18]||(e[18]=s=>t.value.isExtracurricular=s),e[19]||(e[19]=s=>t.value.moduleId=null)]},null,8,["value"])]),_:1})]),_:1})]),_:1}),a(v,{span:"24"},{default:l(()=>[a(T,{justify:"end"},{default:l(()=>[a(I,{"label-placement":"left",label:"¿Habilitado?",path:"isEnabled","show-feedback":!1},{default:l(()=>[a(S,{value:t.value.isEnabled,"onUpdate:value":e[20]||(e[20]=s=>t.value.isEnabled=s)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),qe={style:{"border-bottom":"1px solid #e9e9e9"}},xe=D({__name:"CurriculumCourseDataTable",setup(_){var v;const r=H(),i=f({areaItems:[],moduleItems:[],courseItems:[],preRequisiteItems:[]}),w=f(!1),C=f([]),y=f(!1),d=f(null),m=ue({...be()}),b=f({search:null,page:m.page,pageSize:m.pageSize,filters:{curriculumId:(v=r.params)==null?void 0:v.id}}),t=f({}),F=ie(p=>{d.value=p,y.value=!0},async p=>{await ze(p),await $()}),$=async()=>{b.value.page=1,await R()},R=async()=>{w.value=!0,t.value=await Ve(b.value),C.value=t.value.data,m.total=t.value.total,m.pageSize=t.value.per_page,m.page=t.value.current_page,m.pageCount=t.value.last_page,w.value=!1},c=ge(()=>{$()},400),e=async p=>{b.value.page=p,await R()},U=async p=>{b.value.page=1,b.value.pageSize=p,await R()};return(async()=>{var k;await R();const p=(k=r.params)==null?void 0:k.id;i.value.areaItems=await ke(),i.value.moduleItems=await Ce(p),i.value.courseItems=await ye(),i.value.preRequisiteItems=await we(p)})(),(p,k)=>{const S=L,T=J,q=Z,B=Ie;return M(),G(A,null,[N("div",qe,[a(q,{gutter:12,style:{padding:"12px 16px"}},{default:l(()=>[a(S,{span:12}),a(S,{span:12},{default:l(()=>[a(T,{size:"large",placeholder:"Buscar",value:b.value.search,"onUpdate:value":k[0]||(k[0]=V=>b.value.search=V),onInput:g(c),clearable:""},{suffix:l(()=>[a(ce,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),a(q,null,{default:l(()=>[a(S,{span:24},{default:l(()=>[a(B,{key:"id",remote:"","single-line":!1,columns:g(F),data:C.value,pagination:g(de)(m),"pagination-show-size-picker":!0,loading:w.value,"onUpdate:page":e,"onUpdate:pageSize":U},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),se(p.$slots,"extra",{reLoadDataTable:$,selectables:i.value})]),a(K,{modelValue:y.value,"onUpdate:modelValue":k[1]||(k[1]=V=>y.value=V),item:d.value,selectables:i.value,onSuccess:$},null,8,["modelValue","item","selectables"])],64)}}}),Ke=D({__name:"curriculum-course",setup(_){const r=f(),i=H(),w=f(!1);return(async()=>{var d;const y=(d=i.params)==null?void 0:d.id;y&&(r.value=await pe(y))})(),ne("curriculum",r),(y,d)=>{const m=j,b=O;return M(),G(A,null,[a(b,{segmented:{header:!0,content:!0}},{header:l(()=>{var t;return[d[2]||(d[2]=N("h6",{style:{color:"#999",margin:"0"}},"Gestión del Plan de Estudio",-1)),x(" "+oe((t=r.value)==null?void 0:t.name),1)]}),"header-extra":l(()=>[a(m,{"render-icon":g(X)("additem"),onClick:d[0]||(d[0]=t=>w.value=!0)},{default:l(()=>d[3]||(d[3]=[x(" Agregar curso ")])),_:1},8,["render-icon"])]),_:1}),a(xe,null,{extra:l(({reLoadDataTable:t,selectables:u})=>[a(K,{modelValue:w.value,"onUpdate:modelValue":d[1]||(d[1]=E=>w.value=E),item:null,selectables:u,onSuccess:t},null,8,["modelValue","selectables","onSuccess"])]),_:1})],64)}}});export{Ke as default};
