import{r as $,i as A}from"./DataTable.types-lGKYD9lW.js";import{_ as Q,a as X,b as Y,c as Z}from"./area.services-DeZjfa49.js";import{d as S,a9 as V,a4 as F,a6 as t,aa as e,ah as M,ag as R,h as P,e as ee,r as p,g as ae,ae as O,ai as q,aj as te,a5 as ne,ak as oe,al as G,ac as j,ab as E,am as le,_ as H}from"./index-CuctqQ8B.js";import{_ as W,a as ue,b as se}from"./FormItem-B4x8FwVv.js";import{N as re,_ as L,c as ie,a as pe,b as J}from"./Col-HCWaYKjr.js";import{_ as ce}from"./Switch-GUvqzs87.js";import{u as de}from"./composables-B00wY7wo.js";import{_ as me}from"./Dropdown-DgVa-fAf.js";import{d as _e}from"./debounce.utils-DqPPCsFD.js";import{_ as ge}from"./DataTable-h55vb7wl.js";import{_ as fe}from"./selectables.services-B3XLMGVi.js";import"./get-Bcid4ErW.js";import"./ChevronRight-BKkkeGe-.js";const ve=S({__name:"DataTableOp",props:{item:{}},emits:["edit","delete"],setup(d,{emit:_}){const l=de(),s=_,m=[{label:"Editar",key:"edit",icon:$("edit-2"),props:{onClick:()=>s("edit")}},{label:"Eliminar",key:"delete",icon:$("trash","red"),props:{style:{color:"red"},onClick:()=>{l.warning({title:"Confirmar",content:"¿Está seguro que desea eliminar este registro?",positiveText:"Eliminar",negativeText:"Cancelar",closable:!1,showIcon:!1,negativeButtonProps:{secondary:!0,type:"tertiary",size:"large"},positiveButtonProps:{size:"large",type:"error"},onPositiveClick:()=>{s("delete")}})}}}];return(u,r)=>{const o=R,n=me;return V(),F(n,{options:m,placement:"bottom-start"},{default:t(()=>[e(o,null,{default:t(()=>[e(M,{"icon-name":"setting-5",size:"20"})]),_:1})]),_:1})}}}),be=(d,_)=>[{title:"Ops.",key:"ops",width:"80px",fixed:"left",render(l){const s=l;return P(ve,{onEdit:()=>{d(s)},onDelete:()=>{_(s)},item:s},{default:()=>"Editar"})}},{title:"Nombre",key:"name",minWidth:"200px"},{title:"Currículo",key:"curriculum",minWidth:"200px"},{title:"Habilitado",key:"isEnabled",width:"150px",render:l=>P(re,{type:l.isEnabled?"success":"error",tertiary:!0,bordered:!1,strong:!0},{default:()=>l.isEnabled?"	Habilitado":"Deshabilitado"})}],ye=(d=A())=>({page:d.page,total:d.total,pageSize:d.pageSize,pageCount:d.pageCount,showSizePicker:!0,pageSizes:[10,50,100,500,1e3,5e3],style:{paddingRight:"16px",paddingBottom:"12px"},prefix(){return`Total ${d.total} registros`}}),N=()=>({id:null,name:null,curriculumId:null,isEnabled:!0}),we=()=>({name:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}],curriculumId:[{type:"number",required:!0,trigger:["blur","input"],message:"Obligatorio"}]}),K=S({__name:"AreaForm",props:{item:{},modelValue:{type:Boolean},curriculumOptions:{}},emits:["update:modelValue","success"],setup(d,{emit:_}){const l=_,s=d,m=ee({get:()=>s.modelValue,set:f=>l("update:modelValue",f)}),u=p(!1),r=p(null),o=p(N()),n=p(null),g=p({...we()}),B=async()=>{if(r.value){const f=await r.value.validate();let a=null;f?(u.value=!0,o.value.id?a=await Q(o.value):a=await X(o.value),a.status?(l("success"),m.value=!1):n.value=a.data):console.log("Formulario inválido")}u.value=!1},D=()=>{console.log("Inicializando formulario"),o.value=s.item?{...s.item}:N()};return ae(m,f=>{f&&D()}),(f,a)=>{const v=W,y=ue,w=L,h=ie,U=ce,c=pe,b=J,I=se,z=R,C=q,T=te;return V(),F(T,{show:m.value,"onUpdate:show":a[6]||(a[6]=i=>m.value=i)},{default:t(()=>[e(C,{style:{width:"500px"},title:f.item?"EDITAR REGISTRO":"NUEVO REGISTRO",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:t(()=>[e(c,{justify:"end"},{default:t(()=>[e(z,{tertiary:"",size:"large",onClick:a[5]||(a[5]=i=>m.value=!1),disabled:u.value},{default:t(()=>a[7]||(a[7]=[O(" Cancelar ")])),_:1},8,["disabled"]),e(z,{size:"large",type:"primary",onClick:B,loading:u.value},{default:t(()=>a[8]||(a[8]=[O("Guardar")])),_:1},8,["loading"])]),_:1})]),default:t(()=>[e(I,{ref_key:"formRef",ref:r,model:o.value,rules:g.value,size:"large"},{default:t(()=>[e(b,null,{default:t(()=>[e(w,{span:"24"},{default:t(()=>{var i;return[e(y,{path:"name",label:"Nombre",feedback:(i=n.value)==null?void 0:i.name},{default:t(()=>{var k;return[e(v,{status:((k=n.value)==null?void 0:k.name)!=null?"error":"",value:o.value.name,"onUpdate:value":a[0]||(a[0]=x=>o.value.name=x),onInput:a[1]||(a[1]=x=>n.value!=null?n.value.name=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1}),e(w,{span:"24"},{default:t(()=>{var i;return[e(y,{path:"curriculumId",label:"Plan de estudios",feedback:(i=n.value)==null?void 0:i.curriculumId},{default:t(()=>{var k;return[e(h,{clearable:"",placeholder:"Seleccione un plan de estudios",value:o.value.curriculumId,"onUpdate:value":a[2]||(a[2]=x=>o.value.curriculumId=x),options:f.curriculumOptions,"virtual-scroll":!1,status:((k=n.value)==null?void 0:k.curriculumId)!=null?"error":"",onInput:a[3]||(a[3]=x=>n.value!=null?n.value.curriculumId=null:()=>{})},null,8,["value","options","status"])]}),_:1},8,["feedback"])]}),_:1}),e(w,{span:"24"},{default:t(()=>[e(c,{justify:"end"},{default:t(()=>[e(y,{"label-placement":"left",label:"¿Habilitado?",path:"isEnabled","show-feedback":!1},{default:t(()=>[e(U,{value:o.value.isEnabled,"onUpdate:value":a[4]||(a[4]=i=>o.value.isEnabled=i)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),Ie={style:{"border-bottom":"1px solid #e9e9e9"}},ke=S({__name:"DataTable",props:{curriculumOptions:{}},setup(d){const _=ne(),l=p(!1),s=p([]),m=p(!1),u=p(null),r=oe({...A()}),o=p(""),n=p({search:null,page:r.page,pageSize:r.pageSize}),g=p({}),f=be(c=>{u.value=c,m.value=!0},async c=>{await Z(c),await a()}),a=async()=>{n.value.page=1,await v()},v=async()=>{l.value=!0,n.value.filters={curriculumId:o.value},g.value=await Y(n.value),s.value=g.value.data,r.total=g.value.total,r.pageSize=g.value.per_page,r.page=g.value.current_page,r.pageCount=g.value.last_page,l.value=!1},y=_e(()=>{a()},400),w=async c=>{n.value.page=c,await v()},h=async c=>{n.value.page=1,n.value.pageSize=c,await v()};return(async()=>{o.value=_.params.id??"",await v()})(),(c,b)=>{const I=L,z=W,C=J,T=ge;return V(),G(H,null,[j("div",Ie,[e(C,{gutter:12,style:{padding:"12px 16px"}},{default:t(()=>[e(I,{span:12}),e(I,{span:12},{default:t(()=>[e(z,{size:"large",placeholder:"Buscar",value:n.value.search,"onUpdate:value":b[0]||(b[0]=i=>n.value.search=i),onInput:E(y),clearable:""},{suffix:t(()=>[e(M,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),e(C,null,{default:t(()=>[e(I,{span:24},{default:t(()=>[e(T,{key:"id",remote:"","single-line":!1,columns:E(f),data:s.value,pagination:E(ye)(r),"pagination-show-size-picker":!0,loading:l.value,"onUpdate:page":w,"onUpdate:pageSize":h},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),le(c.$slots,"extra",{reLoadDataTable:a})]),e(K,{modelValue:m.value,"onUpdate:modelValue":b[1]||(b[1]=i=>m.value=i),curriculumOptions:c.curriculumOptions,item:u.value,onSuccess:a},null,8,["modelValue","curriculumOptions","item"])],64)}}}),Ue=S({__name:"index",setup(d){const _=p([]),l=p(!1);return(async()=>{_.value=await fe()})(),(m,u)=>{const r=R,o=q;return V(),G(H,null,[e(o,{segmented:{header:!0,content:!0}},{header:t(()=>u[2]||(u[2]=[j("h6",{style:{color:"#999",margin:"0"}},"Gestión de Areas academicas",-1),O(" Areas ")])),"header-extra":t(()=>[e(r,{"render-icon":E($)("additem"),onClick:u[0]||(u[0]=n=>l.value=!0)},{default:t(()=>u[3]||(u[3]=[O(" Agregar ")])),_:1},8,["render-icon"])]),_:1}),e(ke,{curriculumOptions:_.value},{extra:t(({reLoadDataTable:n})=>[e(K,{modelValue:l.value,"onUpdate:modelValue":u[1]||(u[1]=g=>l.value=g),curriculumOptions:_.value,item:null,onSuccess:n},null,8,["modelValue","curriculumOptions","onSuccess"])]),_:1},8,["curriculumOptions"])],64)}}});export{Ue as default};
