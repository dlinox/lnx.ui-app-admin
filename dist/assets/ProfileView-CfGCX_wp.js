import{az as G,d as E,e as k,r as w,j as O,a9 as j,aa as S,ab as s,ac as t,aB as U,ag as z,aA as C,aI as L,bl as M,aG as D,af as r,ah as V,_ as H}from"./index-Dga6ANj1.js";import{_ as T,a as J}from"./FormItem-DNGP1HoV.js";import{_ as K,a as Q}from"./Col-CQISFbwN.js";import{_ as W}from"./Input-Cdqf_kvO.js";import{_ as X}from"./Space-j9I4BA4b.js";import{a as Y,_ as Z}from"./ListItem-DQ5YGrPE.js";import"./get-CRgnu-Rv.js";import"./Suffix-NjKowPKN.js";import"./use-merged-state-BuNcl0OG.js";const B=()=>({password:"",newPassword:"",confirmPassword:""}),h=_=>({password:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}],newPassword:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}],confirmPassword:[{required:!0,trigger:["blur","input"],message:"Obligatorio"},{validator:(u,d,i)=>{d!==_.newPassword?i(new Error("Las contraseñas no coinciden")):i()},trigger:["blur","input"]}]}),ee=G(),te="/user/profile",ae=async _=>{try{return{status:!0,data:(await ee.post(`${te}/change-password`,_)).data.data}}catch(u){return u.response.status===422?{status:!1,data:u.response.data.errors}:{status:!1,data:null}}},se=E({__name:"Form",props:{modelValue:{type:Boolean}},emits:["update:modelValue","success"],setup(_,{emit:u}){const d=u,i=_,f=k({get:()=>i.modelValue,set:c=>d("update:modelValue",c)}),a=w(!1),v=w(null),l=w({...B()}),o=w(null),b=k(()=>h(l.value)),g=async()=>{if(v.value){const c=await v.value.validate();let e=null;c&&(a.value=!0,e=await ae(l.value),e.status?(d("success"),f.value=!1):o.value=e.data)}a.value=!1},I=()=>{l.value={...B()},o.value=null};return O(f,c=>{c&&(o.value=null,I())}),(c,e)=>{const x=W,P=J,y=Q,N=K,R=T,$=z,F=X,q=U,A=L;return S(),j(A,{show:f.value,"onUpdate:show":e[7]||(e[7]=n=>f.value=n)},{default:s(()=>[t(q,{style:{width:"500px"},title:"Cambiar contraseña",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:s(()=>[t(F,{justify:"end"},{default:s(()=>[t($,{tertiary:"",size:"large",onClick:e[6]||(e[6]=n=>f.value=!1),disabled:a.value},{default:s(()=>e[8]||(e[8]=[C(" Cancelar ")])),_:1},8,["disabled"]),t($,{size:"large",type:"primary",onClick:g,loading:a.value},{default:s(()=>e[9]||(e[9]=[C("Guardar")])),_:1},8,["loading"])]),_:1})]),default:s(()=>[t(R,{ref_key:"formRef",ref:v,model:l.value,rules:b.value,size:"large"},{default:s(()=>[t(N,null,{default:s(()=>[t(y,{span:"24"},{default:s(()=>{var n;return[t(P,{path:"password",label:"Contraseña",feedback:(n=o.value)==null?void 0:n.password},{default:s(()=>{var p;return[t(x,{placeholder:"Escribe tu contraseña",type:"password",status:((p=o.value)==null?void 0:p.password)!=null?"error":"",value:l.value.password,"onUpdate:value":e[0]||(e[0]=m=>l.value.password=m),onInput:e[1]||(e[1]=m=>o.value!=null?o.value.password=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1}),t(y,{span:"24"},{default:s(()=>{var n;return[t(P,{path:"newPassword",label:"Nueva contraseña",feedback:(n=o.value)==null?void 0:n.newPassword},{default:s(()=>{var p;return[t(x,{placeholder:"Escribe tu nueva contraseña",type:"password",status:((p=o.value)==null?void 0:p.newPassword)!=null?"error":"",value:l.value.newPassword,"onUpdate:value":e[2]||(e[2]=m=>l.value.newPassword=m),onInput:e[3]||(e[3]=m=>o.value!=null?o.value.newPassword=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1}),t(y,{span:"24"},{default:s(()=>{var n;return[t(P,{path:"confirmPassword",label:"Confirmar contraseña",feedback:(n=o.value)==null?void 0:n.confirmPassword},{default:s(()=>{var p;return[t(x,{placeholder:"Escribe tu nueva contraseña",type:"password",status:((p=o.value)==null?void 0:p.confirmPassword)!=null?"error":"",value:l.value.confirmPassword,"onUpdate:value":e[4]||(e[4]=m=>l.value.confirmPassword=m),onInput:e[5]||(e[5]=m=>o.value!=null?o.value.confirmPassword=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1},8,["show"])}}}),oe={class:"mx-auto mt-4 max-w-2xl px-4"},le={class:"text-base font-bold text-slate-800"},ne={class:"text-base font-bold text-slate-800"},re={class:"text-base font-bold text-slate-800"},we=E({__name:"ProfileView",setup(_){const u=M(),d=w(!1),i=k(()=>u.authState.user);return(f,a)=>{const v=U,l=Z,o=z,b=Y;return S(),D(H,null,[t(v,{segmented:{header:!0,content:!0}},{header:s(()=>a[2]||(a[2]=[r("span",{class:"text-sm text-slate-500"}," Gestionar tu cuenta de usuario ",-1),r("h5",{class:"text-lg font-bold text-slate-800"},"Perfil de usuario",-1)])),_:1}),r("div",oe,[t(v,null,{default:s(()=>[t(b,null,{default:s(()=>[t(l,null,{default:s(()=>[a[3]||(a[3]=r("div",{class:"text-small text-slate-500"},"Nombre",-1)),r("div",le,V(i.value.name),1)]),_:1}),t(l,null,{default:s(()=>[a[4]||(a[4]=r("div",{class:"text-small text-slate-500"},"Correo electrónico",-1)),r("div",ne,V(i.value.email),1)]),_:1}),t(l,null,{default:s(()=>[a[5]||(a[5]=r("div",{class:"text-small text-slate-500"},"Rol",-1)),r("div",re,V(i.value.role),1)]),_:1}),t(l,null,{suffix:s(()=>[t(o,{onClick:a[0]||(a[0]=g=>d.value=!0),type:"primary"},{default:s(()=>a[6]||(a[6]=[C(" Cambiar contraseña ")])),_:1})]),default:s(()=>[a[7]||(a[7]=r("div",{class:"text-small text-slate-500"},"Contraseña",-1)),a[8]||(a[8]=r("div",{class:"text-base font-bold text-slate-800"},"************",-1))]),_:1})]),_:1})]),_:1}),t(se,{modelValue:d.value,"onUpdate:modelValue":a[1]||(a[1]=g=>d.value=g)},null,8,["modelValue"])])],64)}}});export{we as default};
