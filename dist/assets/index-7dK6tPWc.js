import{r as q}from"./icon.utils-BQfYQcDe.js";import{_ as H,a as L,b as D,c as J,d as K,e as Q,f as W,g as X}from"./curriculum.services-egbuGaCx.js";import{d as T,e as Y,r,g as Z,aa as $,a5 as ee,a8 as a,ab as e,ah as C,af as h,ai as F,aj as ae,ak as ne,al as M,ad as N,ac as V,ag as te,am as oe,_ as G}from"./index-BOXL2TiF.js";import{_ as P}from"./Input-C8gwYOc9.js";import{_ as le,a as se}from"./FormItem-C4wDlZap.js";import{_ as j,a as O}from"./Col-BTffZrwQ.js";import{_ as ue}from"./Switch-TLL8GsvW.js";import{_ as re}from"./Space-CbJKgSxe.js";import{i as ie}from"./DataTable.types-B90ErchY.js";import{d as me}from"./debounce.utils-DqPPCsFD.js";import{_ as pe}from"./DataTable-D2zYKQJM.js";import"./ButtonGroup-B_7OBABk.js";import"./composables-DOSSxa7-.js";import"./Dropdown-d17eZhwV.js";import"./get-DOtZouVG.js";import"./Select-Biy6SjtC.js";import"./index-ChN7EhXt.js";import"./Tooltip-BHYxHC_t.js";const A=T({__name:"CurriculumForm",props:{item:{},modelValue:{type:Boolean}},emits:["update:modelValue","success"],setup(I,{emit:p}){const c=p,o=I,m=Y({get:()=>o.modelValue,set:u=>c("update:modelValue",u)}),l=r(!1),s=r(null),t=r(D()),f=r(null),E=r({...J()}),z=async()=>{if(s.value){const u=await s.value.validate();let n=null;u?(l.value=!0,t.value.id?n=await H(t.value):n=await L(t.value),n.status?(c("success"),m.value=!1):f.value=n.data):console.log("Formulario inválido")}l.value=!1},v=()=>{console.log("Inicializando formulario"),t.value=o.item?{...o.item}:D()};return Z(m,u=>{u&&v()}),(u,n)=>{const k=P,y=le,x=j,i=ue,_=re,g=O,S=se,b=h,R=F,w=ae;return $(),ee(w,{show:m.value,"onUpdate:show":n[4]||(n[4]=d=>m.value=d)},{default:a(()=>[e(R,{style:{width:"500px"},title:u.item?"EDITAR REGISTRO":"NUEVO REGISTRO",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:a(()=>[e(_,{justify:"end"},{default:a(()=>[e(b,{tertiary:"",size:"large",onClick:n[3]||(n[3]=d=>m.value=!1),disabled:l.value},{default:a(()=>n[5]||(n[5]=[C(" Cancelar ")])),_:1},8,["disabled"]),e(b,{size:"large",type:"primary",onClick:z,loading:l.value},{default:a(()=>n[6]||(n[6]=[C("Guardar")])),_:1},8,["loading"])]),_:1})]),default:a(()=>[e(S,{ref_key:"formRef",ref:s,model:t.value,rules:E.value,size:"large"},{default:a(()=>[e(g,null,{default:a(()=>[e(x,{span:"24"},{default:a(()=>{var d;return[e(y,{path:"name",label:"Nombre",feedback:(d=f.value)==null?void 0:d.name},{default:a(()=>{var U;return[e(k,{value:t.value.name,"onUpdate:value":n[0]||(n[0]=B=>t.value.name=B),status:((U=f.value)==null?void 0:U.name)!=null?"error":"",onInput:n[1]||(n[1]=B=>f.value!=null?f.value.name=null:()=>{})},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1}),e(x,{span:"24"},{default:a(()=>[e(_,{justify:"end"},{default:a(()=>[e(y,{"label-placement":"left",label:"¿Habilitado?",path:"isEnabled","show-feedback":!1},{default:a(()=>[e(i,{value:t.value.isEnabled,"onUpdate:value":n[2]||(n[2]=d=>t.value.isEnabled=d)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),_e={style:{"border-bottom":"1px solid #e9e9e9"}},de=T({__name:"DataTable",setup(I){const p=r(!1),c=r([]),o=r(!1),m=r(null),l=ne({...ie()}),s=r({search:null,page:l.page,pageSize:l.pageSize}),t=r({}),z=Q(i=>{m.value=i,o.value=!0},async i=>{await X(i),await v()}),v=async()=>{s.value.page=1,await u()},u=async()=>{p.value=!0,t.value=await W(s.value),c.value=t.value.data,l.total=t.value.total,l.pageSize=t.value.per_page,l.page=t.value.current_page,l.pageCount=t.value.last_page,p.value=!1},n=me(()=>{v()},400),k=async i=>{s.value.page=i,await u()},y=async i=>{s.value.page=1,s.value.pageSize=i,await u()};return(async()=>{await u()})(),(i,_)=>{const g=j,S=P,b=O,R=pe;return $(),M(G,null,[N("div",_e,[e(b,{gutter:12,style:{padding:"12px 16px"}},{default:a(()=>[e(g,{span:12}),e(g,{span:12},{default:a(()=>[e(S,{size:"large",placeholder:"Buscar",value:s.value.search,"onUpdate:value":_[0]||(_[0]=w=>s.value.search=w),onInput:V(n),clearable:""},{suffix:a(()=>[e(te,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),e(b,null,{default:a(()=>[e(g,{span:24},{default:a(()=>[e(R,{key:"id",remote:"","single-line":!1,columns:V(z),data:c.value,pagination:V(K)(l),"pagination-show-size-picker":!0,loading:p.value,"onUpdate:page":k,"onUpdate:pageSize":y},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),oe(i.$slots,"extra",{reLoadDataTable:v})]),e(A,{modelValue:o.value,"onUpdate:modelValue":_[1]||(_[1]=w=>o.value=w),item:m.value,onSuccess:v},null,8,["modelValue","item"])],64)}}}),Ue=T({__name:"index",setup(I){const p=r(!1);return(c,o)=>{const m=h,l=F;return $(),M(G,null,[e(l,{segmented:{header:!0,content:!0}},{header:a(()=>o[2]||(o[2]=[N("h6",{style:{color:"#999",margin:"0"}},"Gestión Curricular",-1),C(" Curriculo ")])),"header-extra":a(()=>[e(m,{"render-icon":V(q)("additem"),onClick:o[0]||(o[0]=s=>p.value=!0)},{default:a(()=>o[3]||(o[3]=[C(" Agregar ")])),_:1},8,["render-icon"])]),_:1}),e(de,null,{extra:a(({reLoadDataTable:s})=>[e(A,{modelValue:p.value,"onUpdate:modelValue":o[1]||(o[1]=t=>p.value=t),item:null,onSuccess:s},null,8,["modelValue","onSuccess"])]),_:1})],64)}}});export{Ue as default};
