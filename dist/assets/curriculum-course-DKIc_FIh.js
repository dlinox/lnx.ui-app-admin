import{r as Y}from"./icon.utils-D7BmKQQ8.js";import{az as Z,d as M,i as ee,e as ae,r as f,j as te,a9 as le,aa as j,ab as l,ac as a,aB as O,ae as g,ag as G,aA as B,aI as se,a5 as H,aJ as ue,aG as A,_ as N,af as F,aK as oe,aH as ne,ah as re,p as ie}from"./index-VnlbSWoD.js";import{h as D,i as de,d as pe,j as me,k as ce}from"./curriculum.services-jIWHJxSm.js";import{d as ve}from"./debounce.utils-DqPPCsFD.js";import{a as fe,i as _e}from"./DataTable.types-BEg5m_To.js";import{d as be,h as ge}from"./course.services-DzKT3GWV.js";import{d as Ie}from"./area.services-aDDzohuR.js";import{e as ye}from"./module.services-C4tWsDmR.js";import{u as we}from"./useBreakpoints-BH0TdeY-.js";import{_ as ke,a as Ce}from"./FormItem-wbeg7Rmc.js";import{_ as J,a as K}from"./Col-D62vBcWk.js";import{_ as $e}from"./Select-Df7rPK9_.js";import{_ as Re}from"./InputNumber-BqynPJB_.js";import{_ as L}from"./Input-BjvMqLmR.js";import{_ as Ue}from"./Space-BYw6XnFF.js";import{_ as Se}from"./Switch-DcbwJYPH.js";import{_ as Ve}from"./DataTable-ChFE3RLO.js";import"./ButtonGroup-D1O-oMVn.js";import"./composables-bTB8ALIv.js";import"./Dropdown-FcmlDduf.js";import"./Popover-CxKYmMF9.js";import"./get-C6YDaK3p.js";import"./use-merged-state-DLxtUdHo.js";import"./Tag-D-Mvyznn.js";import"./Suffix-DHkxWb8H.js";import"./Tooltip-CrDeGSkE.js";const x="/curriculum/course",z=Z(),Te=async _=>{try{return(await z.post(`${x}/load-data-table`,_)).data.data}catch{return fe()}},xe=async _=>{try{return{status:!0,data:(await z.post(x,_)).data.data}}catch(r){return r.response.status===422?{status:!1,data:r.response.data.errors}:{status:!1,data:null}}},ze=async _=>{try{return{status:!0,data:(await z.put(x,_)).data.data}}catch(r){return r.response.status===422?{status:!1,data:r.response.data.errors}:{status:!1,data:null}}},Pe=async _=>{try{return await z.delete(x,{data:{id:_.id}}),!0}catch{return!1}},Ee=async _=>{try{return(await z.get(`${x}/get-item-by-id/${_}`)).data.data}catch{return D()}},Q=M({__name:"CurriculumCourseForm",props:{item:{},modelValue:{type:Boolean},selectables:{}},emits:["update:modelValue","success"],setup(_,{emit:r}){const{screenSize:p}=we(),w=ee("curriculum"),C=r,y=_,i=ae({get:()=>y.modelValue,set:m=>C("update:modelValue",m)}),c=f(!1),b=f(null),t=f(D()),s=f(null),P=f({...de()}),q=async()=>{if(b.value){const m=await b.value.validate();let e=null;m?(c.value=!0,t.value.curriculumId=w.value.id,t.value.id?e=await ze(t.value):e=await xe(t.value),e.status?(C("success"),i.value=!1):s.value=e.data):console.log("Formulario inválido")}c.value=!1},$=async()=>{var m;(m=y.item)!=null&&m.id?t.value=await Ee(y.item.id):t.value=D()},R=async()=>{await $(),t.value.curriculumId=w.value.id};return te(i,m=>{m&&R()}),(m,e)=>{const U=$e,I=Ce,v=K,d=Re,k=L,S=Se,T=Ue,E=J,h=ke,V=G,W=O,X=se;return j(),le(X,{show:i.value,"onUpdate:show":e[22]||(e[22]=u=>i.value=u)},{default:l(()=>[a(W,{style:{width:"800px"},title:m.item?"EDITAR REGISTRO":"NUEVO REGISTRO",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:l(()=>[a(T,{justify:"end"},{default:l(()=>[a(V,{tertiary:"",size:"large",onClick:e[21]||(e[21]=u=>i.value=!1),disabled:c.value},{default:l(()=>e[23]||(e[23]=[B(" Cancelar ")])),_:1},8,["disabled"]),a(V,{size:"large",type:"primary",onClick:q,loading:c.value},{default:l(()=>e[24]||(e[24]=[B("Guardar")])),_:1},8,["loading"])]),_:1})]),default:l(()=>[a(h,{ref_key:"formRef",ref:b,model:t.value,rules:P.value,size:"large"},{default:l(()=>[a(E,{gutter:16},{default:l(()=>[a(v,{span:g(p)==="sm"?24:12},{default:l(()=>{var u;return[a(I,{path:"areaId",label:"Área",feedback:(u=s.value)==null?void 0:u.areaId},{default:l(()=>{var o;return[a(U,{value:t.value.areaId,"onUpdate:value":e[0]||(e[0]=n=>t.value.areaId=n),options:m.selectables.areaItems,filterable:"",clearable:"","virtual-scroll":!1,status:((o=s.value)==null?void 0:o.areaId)!=null?"error":"","onOnUpdate:value":e[1]||(e[1]=n=>s.value!=null?s.value.areaId=null:()=>{})},null,8,["value","options","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(v,{span:g(p)==="sm"?24:12},{default:l(()=>{var u;return[a(I,{path:"moduleId",label:"Módulo",feedback:(u=s.value)==null?void 0:u.moduleId},{default:l(()=>{var o;return[a(U,{value:t.value.moduleId,"onUpdate:value":e[2]||(e[2]=n=>t.value.moduleId=n),options:m.selectables.moduleItems,filterable:"",clearable:"","virtual-scroll":!1,status:((o=s.value)==null?void 0:o.moduleId)!=null?"error":"","onOnUpdate:value":e[3]||(e[3]=n=>s.value!=null?s.value.moduleId=null:()=>{})},null,8,["value","options","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(v,{span:g(p)==="sm"?12:4},{default:l(()=>{var u;return[a(I,{path:"order",label:"Orden",feedback:(u=s.value)==null?void 0:u.order},{default:l(()=>{var o;return[a(d,{style:{width:"100%"},clearable:"",value:t.value.order,"onUpdate:value":e[4]||(e[4]=n=>t.value.order=n),status:((o=s.value)==null?void 0:o.order)!=null?"error":"",onInput:e[5]||(e[5]=n=>s.value!=null?s.value.order=null:()=>{})},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(v,{span:g(p)==="sm"?12:4},{default:l(()=>{var u;return[a(I,{path:"code",label:"Código",feedback:(u=s.value)==null?void 0:u.code},{default:l(()=>{var o;return[a(k,{value:t.value.code,"onUpdate:value":[e[6]||(e[6]=n=>t.value.code=n),e[7]||(e[7]=n=>s.value!=null?s.value.code=null:()=>{})],status:((o=s.value)==null?void 0:o.code)!=null?"error":""},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(v,{span:g(p)==="sm"?24:16},{default:l(()=>{var u;return[a(I,{path:"courseId",label:"Curso",feedback:(u=s.value)==null?void 0:u.courseId},{default:l(()=>{var o;return[a(U,{filterable:"",clearable:"",options:m.selectables.courseItems,"virtual-scroll":!1,value:t.value.courseId,"onUpdate:value":[e[8]||(e[8]=n=>t.value.courseId=n),e[9]||(e[9]=n=>s.value!=null?s.value.courseId=null:()=>{})],status:((o=s.value)==null?void 0:o.courseId)!=null?"error":""},null,8,["options","value","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(v,{span:g(p)==="sm"?24:8},{default:l(()=>{var u;return[a(I,{path:"credits",label:"Créditos",feedback:(u=s.value)==null?void 0:u.credits},{default:l(()=>{var o;return[a(d,{style:{width:"100%"},clearable:"",value:t.value.credits,"onUpdate:value":e[10]||(e[10]=n=>t.value.credits=n),status:((o=s.value)==null?void 0:o.credits)!=null?"error":"",onInput:e[11]||(e[11]=n=>s.value!=null?s.value.credits=null:()=>{})},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(v,{span:g(p)==="sm"?24:8},{default:l(()=>{var u;return[a(I,{path:"hoursPractice",label:"Horas Practicas",feedback:(u=s.value)==null?void 0:u.hoursPractice},{default:l(()=>{var o;return[a(d,{style:{width:"100%"},clearable:"",value:t.value.hoursPractice,"onUpdate:value":e[12]||(e[12]=n=>t.value.hoursPractice=n),status:((o=s.value)==null?void 0:o.hoursPractice)!=null?"error":"",onInput:e[13]||(e[13]=n=>s.value!=null?s.value.hoursPractice=null:()=>{})},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(v,{span:g(p)==="sm"?24:8},{default:l(()=>{var u;return[a(I,{path:"hoursTheory",label:"Horas Teoricas",feedback:(u=s.value)==null?void 0:u.hoursTheory},{default:l(()=>{var o;return[a(d,{style:{width:"100%"},clearable:"",value:t.value.hoursTheory,"onUpdate:value":e[14]||(e[14]=n=>t.value.hoursTheory=n),status:((o=s.value)==null?void 0:o.hoursTheory)!=null?"error":"",onInput:e[15]||(e[15]=n=>s.value!=null?s.value.hoursTheory=null:()=>{})},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(v,{span:(g(p)==="sm",24)},{default:l(()=>{var u;return[a(I,{path:"preRequisiteId",label:"Pre-Requisito",feedback:(u=s.value)==null?void 0:u.preRequisiteId},{default:l(()=>{var o;return[a(U,{clearable:"",filterable:"",options:m.selectables.preRequisiteItems,"virtual-scroll":!1,value:t.value.preRequisiteId,"onUpdate:value":[e[16]||(e[16]=n=>t.value.preRequisiteId=n),e[17]||(e[17]=n=>s.value!=null?s.value.preRequisiteId=null:()=>{})],status:((o=s.value)==null?void 0:o.preRequisiteId)!=null?"error":""},null,8,["options","value","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(v,{span:"24"},{default:l(()=>[a(T,{justify:"end"},{default:l(()=>[a(I,{"label-placement":"left",label:"¿Extracurricular?",path:"isExtracurricular","show-feedback":!1},{default:l(()=>[a(S,{value:t.value.isExtracurricular,"onUpdate:value":[e[18]||(e[18]=u=>t.value.isExtracurricular=u),e[19]||(e[19]=u=>t.value.moduleId=null)]},null,8,["value"])]),_:1})]),_:1})]),_:1}),a(v,{span:"24"},{default:l(()=>[a(T,{justify:"end"},{default:l(()=>[a(I,{"label-placement":"left",label:"¿Habilitado?",path:"isEnabled","show-feedback":!1},{default:l(()=>[a(S,{value:t.value.isEnabled,"onUpdate:value":e[20]||(e[20]=u=>t.value.isEnabled=u)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),qe={style:{"border-bottom":"1px solid #e9e9e9"}},he=M({__name:"CurriculumCourseDataTable",setup(_){var v;const r=H(),p=f({areaItems:[],moduleItems:[],courseItems:[],preRequisiteItems:[]}),w=f(!1),C=f([]),y=f(!1),i=f(null),c=ue({..._e()}),b=f({search:null,page:c.page,pageSize:c.pageSize,filters:{curriculumId:(v=r.params)==null?void 0:v.id}}),t=f({}),q=me(d=>{i.value=d,y.value=!0},async d=>{await Pe(d),await $()}),$=async()=>{b.value.page=1,await R()},R=async()=>{w.value=!0,t.value=await Te(b.value),C.value=t.value.data,c.total=t.value.total,c.pageSize=t.value.per_page,c.page=t.value.current_page,c.pageCount=t.value.last_page,w.value=!1},m=ve(()=>{$()},400),e=async d=>{b.value.page=d,await R()},U=async d=>{b.value.page=1,b.value.pageSize=d,await R()};return(async()=>{var k;await R();const d=(k=r.params)==null?void 0:k.id;p.value.areaItems=await Ie(d),p.value.moduleItems=await ye(d),p.value.courseItems=await be(d),p.value.preRequisiteItems=await ge(d)})(),(d,k)=>{const S=K,T=L,E=J,h=Ve;return j(),A(N,null,[F("div",qe,[a(E,{gutter:12,style:{padding:"12px 16px"}},{default:l(()=>[a(S,{span:12}),a(S,{span:12},{default:l(()=>[a(T,{size:"large",placeholder:"Buscar",value:b.value.search,"onUpdate:value":k[0]||(k[0]=V=>b.value.search=V),onInput:g(m),clearable:""},{suffix:l(()=>[a(ne,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),a(E,null,{default:l(()=>[a(S,{span:24},{default:l(()=>[a(h,{key:"id",remote:"","single-line":!1,columns:g(q),data:C.value,pagination:g(pe)(c),"pagination-show-size-picker":!0,loading:w.value,"onUpdate:page":e,"onUpdate:pageSize":U},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),oe(d.$slots,"extra",{reLoadDataTable:$,selectables:p.value})]),a(Q,{modelValue:y.value,"onUpdate:modelValue":k[1]||(k[1]=V=>y.value=V),item:i.value,selectables:p.value,onSuccess:$},null,8,["modelValue","item","selectables"])],64)}}}),Be={class:"text-lg font-bold text-slate-800"},ia=M({__name:"curriculum-course",setup(_){const r=f(),p=H(),w=f(!1);return(async()=>{var i;const y=(i=p.params)==null?void 0:i.id;y&&(r.value=await ce(y))})(),ie("curriculum",r),(y,i)=>{const c=G,b=O;return j(),A(N,null,[a(b,{segmented:{header:!0,content:!0}},{header:l(()=>{var t;return[i[2]||(i[2]=F("span",{class:"text-sm text-slate-500"}," Gestión del Plan de Estudio ",-1)),F("h5",Be,re((t=r.value)==null?void 0:t.name),1)]}),"header-extra":l(()=>[a(c,{"render-icon":g(Y)("additem"),onClick:i[0]||(i[0]=t=>w.value=!0)},{default:l(()=>i[3]||(i[3]=[B(" Agregar curso ")])),_:1},8,["render-icon"])]),_:1}),a(he,null,{extra:l(({reLoadDataTable:t,selectables:s})=>[a(Q,{modelValue:w.value,"onUpdate:modelValue":i[1]||(i[1]=P=>w.value=P),item:null,selectables:s,onSuccess:t},null,8,["modelValue","selectables","onSuccess"])]),_:1})],64)}}});export{ia as default};
