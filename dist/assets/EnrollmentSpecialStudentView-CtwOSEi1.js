import{d as le,a3 as oe,a5 as ae,r as m,aD as se,a8 as re,aG as h,a9 as g,ae as _,aa as u,ac as o,af as t,ab as e,aB as ue,aA as c,ah as a,_ as w,aU as A,ad as N,ag as ie}from"./index-BOyx2DGO.js";import{r as de}from"./icon.utils-BZ_5fGn6.js";import{u as me}from"./useBreakpoints-DhNa-nJn.js";import{d as pe,e as _e,f as ce,h as fe}from"./EditEnrollmentGroup.vue_vue_type_script_setup_true_lang-CzAZkrsj.js";import"./studentType.services-Dv6g504T.js";import{i as ge}from"./student.services-AZcb6zHl.js";import"./documentType.services-CuAw_OVC.js";import{_ as ve}from"./selectables.services-C_NjbCfl.js";import{u as he}from"./period.stores-BRXwuw8f.js";import{_ as ye}from"./Select-CP6PIrTl.js";import{a as be,_ as Ie}from"./Col-Ddh-mtwO.js";import{_ as Ee}from"./Spin-CUmuCpSg.js";import{_ as Se}from"./Space-Bq9hZ6L8.js";import{_ as ke}from"./Statistic-FoNc7FQ6.js";import{_ as we,a as Ne}from"./CollapseItem-CESbHm2g.js";import{a as xe,_ as Ce}from"./ListItem-Dxt3JRC8.js";import{_ as $e}from"./Thing-BxYJ11Ic.js";import{_ as Be}from"./Table-BGTCguME.js";import{_ as Me}from"./Tag-DM5krFKW.js";import"./Alert-DWB3U6zN.js";import"./FormItem-BNNBpqpK.js";import"./get-BgSbcy5X.js";import"./Input-CA42N3nM.js";import"./Suffix-3kzIsxrs.js";import"./use-merged-state-PebSr71T.js";import"./DataTable.types-BEg5m_To.js";import"./composables-C-nEvORv.js";import"./Dropdown-DquLRH-c.js";import"./Popover-C3xoDLDW.js";const Ae={class:"p-4"},Ve={class:"text-lg font-semibold w-full text-blue-800 p-2"},Pe={key:1},mt=le({__name:"EnrollmentSpecialStudentView",setup(Re){const{hasPermission:G}=oe(),{screenSize:V}=me(),P=ae(),y=he(),x=m(!1),b=m(null),j=m(null),C=m([]),$=m(!0),d=m({}),R=m(!0),D=m(null),F=m(null),T=m(null),W=async f=>{let l=await ce({id:f}),v=new Blob([l],{type:"application/pdf"}),E=window.URL.createObjectURL(v),p=document.getElementById("printFrame");p.src=E,p.onload=function(){var S;(S=p.contentWindow)==null||S.print()}},q=async()=>{const f=P.params.id;$.value=!0,d.value=await ge(f),$.value=!1},I=async()=>{var v;const f=P.params.id,l=(v=j.value)==null?void 0:v.id;R.value=!0,D.value=await fe(f,b.value,l),R.value=!1},B=(f,l=null)=>{F.value=f,T.value=l,x.value=!0},H=async()=>{C.value=await ve(),b.value=C.value[0].value,q(),I()};return se(()=>{H()}),(f,l)=>{const v=ye,E=ue,p=ke,S=Se,J=Ee,U=be,M=Me,z=ie,K=Be,Q=$e,X=Ce,Y=xe,Z=Ne,ee=we,te=Ie,ne=re("AppNotAuthorization");return _(G)(["enrollment.create-special"])?(u(),h(w,{key:0},[o(E,{segmented:{header:!0,footer:!0,content:!0}},{header:e(()=>l[2]||(l[2]=[t("span",{class:"text-sm text-slate-500"}," Matricular estudiante ",-1),t("h5",{class:"text-lg font-bold text-slate-800"},"Matricula Especial",-1)])),"header-extra":e(()=>[o(v,{value:b.value,"onUpdate:value":[l[0]||(l[0]=n=>b.value=n),I],placeholder:"Seleccionar Plan de estudio",filterable:"",options:C.value,"virtual-scroll":!1,"default-value":1},null,8,["value","options"])]),action:e(()=>l[3]||(l[3]=[])),_:1}),t("div",Ae,[o(te,{gutter:16},{default:e(()=>[o(U,{span:_(V)=="lg"?6:24},{default:e(()=>[o(E,{segmented:{header:!0,content:!0},title:"InformaciÃ³n Personal",subtitle:"Datos del estudiante"},{default:e(()=>[o(J,{show:$.value},{default:e(()=>[o(S,{vertical:""},{default:e(()=>[o(p,{class:"small",label:"Tipo de estudiante"},{default:e(()=>{var n;return[c(a((n=d.value)==null?void 0:n.studentType),1)]}),_:1}),o(p,{class:"small",label:"Documento"},{default:e(()=>{var n,r;return[c(a((n=d.value)!=null&&n.documentNumber?(r=d.value)==null?void 0:r.documentNumber:"No registrado"),1)]}),_:1}),o(p,{class:"small",label:"Nombres"},{default:e(()=>{var n;return[c(a((n=d.value)==null?void 0:n.fullName),1)]}),_:1}),o(p,{class:"small",label:"Correo electronico"},{default:e(()=>{var n,r;return[c(a((n=d.value)!=null&&n.email?(r=d.value)==null?void 0:r.email:"No registrado"),1)]}),_:1}),o(p,{class:"small",label:"Telefono"},{default:e(()=>{var n,r;return[c(a((n=d.value)!=null&&n.phone?(r=d.value)==null?void 0:r.phone:"No registrado"),1)]}),_:1})]),_:1})]),_:1},8,["show"])]),_:1})]),_:1},8,["span"]),o(U,{span:_(V)=="lg"?18:24},{default:e(()=>[o(E,{segmented:{header:!0,content:!0},title:"Matricula"},{"header-extra":e(()=>[o(M,{bordered:!1,type:_(y).enrollment?"info":"error"},{default:e(()=>{var n;return[t("strong",null,a(_(y).enrollment?(n=_(y).enrollment)==null?void 0:n.period:"No habilitado"),1)]}),_:1},8,["type"])]),default:e(()=>[o(ee,null,{default:e(()=>{var n;return[(u(!0),h(w,null,A((n=D.value)==null?void 0:n.enrollments,r=>(u(),g(Z,{key:r.moduleId,name:r.moduleId},{header:e(()=>[t("h2",Ve,a(r.moduleName)+" "+a(r.isExtracurricular?"(Extracurricular)":""),1)]),default:e(()=>[o(Y,{hoverable:"",clickable:""},{default:e(()=>[(u(!0),h(w,null,A(r.courses,i=>(u(),g(X,{key:i.id},{default:e(()=>[o(Q,{title:`${i.code} - ${i.name}`},{"header-extra":e(()=>[i.enrollmentGroups.length==0||i.enrollmentGroups.filter(s=>s.groupStatus=="ABIERTO").length==0?(u(),g(z,{key:0,type:"primary",onClick:s=>B(i.id)},{default:e(()=>l[4]||(l[4]=[c(" Matricular ")])),_:2},1032,["onClick"])):N("",!0)]),description:e(()=>[o(S,{size:"small"},{default:e(()=>[o(M,{bordered:!1,size:"small"},{default:e(()=>[c(" Area: "+a(i.area),1)]),_:2},1024)]),_:2},1024)]),default:e(()=>[i.enrollmentGroups.length>0?(u(),g(K,{key:0,"single-line":!1},{default:e(()=>[l[6]||(l[6]=t("thead",null,[t("tr",null,[t("th",{colspan:"2"},"Matricula"),t("th",{colspan:"3"},"Grupo"),t("th",{colspan:"2"})]),t("tr",null,[t("th",null,"Periodo"),t("th",null,"Estado"),t("th",null,"Grupo"),t("th",null,"Modalidad"),t("th",null,"Estado"),t("th",{rowspan:"2"},"Nota"),t("th",null,"Acciones")])],-1)),t("tbody",null,[(u(!0),h(w,null,A(i.enrollmentGroups,s=>{var L,O;return u(),h("tr",null,[t("td",null,[((L=_(y).enrollment)==null?void 0:L.period)==s.period?(u(),g(M,{key:0,type:"info"},{default:e(()=>[c(a(s.period),1)]),_:2},1024)):(u(),h("span",Pe,a(s.period),1))]),t("td",null,a(s.enrollmentStatus),1),t("td",null,a(s.groupName),1),t("td",null,a(s.groupModality),1),t("td",null,a(s.groupStatus),1),t("td",null,a(s.grade),1),t("td",null,[((O=_(y).enrollment)==null?void 0:O.period)==s.period?(u(),g(pe,{key:0,item:s,onResetEnrollment:k=>B(i.id,k),onChangeGroup:k=>B(i.id,k),onReserveEnrollment:I,onCancelEnrollment:I},null,8,["item","onResetEnrollment","onChangeGroup"])):N("",!0),s.enrollmentStatus==="MATRICULADO"?(u(),g(z,{key:1,"render-icon":_(de)("printer"),onClick:k=>W(s.id)},{default:e(()=>l[5]||(l[5]=[c(" Ficha ")])),_:2},1032,["render-icon","onClick"])):N("",!0)])])}),256))])]),_:2},1024)):N("",!0)]),_:2},1032,["title"])]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["name"]))),128))]}),_:1})]),_:1})]),_:1},8,["span"])]),_:1})]),l[7]||(l[7]=t("iframe",{id:"printFrame",style:{display:"none"}},null,-1)),o(_e,{modelValue:x.value,"onUpdate:modelValue":l[1]||(l[1]=n=>x.value=n),studentId:d.value.id,curriculumId:b.value,courseId:F.value,enrollmetGroup:T.value,isSpecial:!0,onSuccess:I},null,8,["modelValue","studentId","curriculumId","courseId","enrollmetGroup"])],64)):(u(),g(ne,{key:1}))}}});export{mt as default};
