import{r as P}from"./icon.utils-D7BmKQQ8.js";import{d as N,a3 as G,a9 as h,ad as W,ae as w,aa as E,ab as a,ac as e,ag as M,aH as j,h as U,e as te,r as p,j as ae,aN as le,aB as H,w as ne,aA as R,aI as oe,a5 as ue,aJ as re,aG as J,_ as K,af as B,aK as se,a8 as ie}from"./index-VnlbSWoD.js";import{_ as de,a as pe,b as ce,c as me}from"./module.services-C4tWsDmR.js";import{_ as _e,a as ve}from"./FormItem-wbeg7Rmc.js";import{_ as L,a as Q}from"./Col-D62vBcWk.js";import{_ as fe}from"./Select-Df7rPK9_.js";import{_ as X}from"./Input-BjvMqLmR.js";import{_ as ge}from"./InputNumber-BqynPJB_.js";import{_ as be}from"./Space-BYw6XnFF.js";import{_ as ye}from"./Switch-DcbwJYPH.js";import{i as Y}from"./DataTable.types-BEg5m_To.js";import{u as xe}from"./composables-bTB8ALIv.js";import{_ as ke}from"./Dropdown-FcmlDduf.js";import{N as q}from"./Tag-D-Mvyznn.js";import{d as we}from"./debounce.utils-DqPPCsFD.js";import{_ as Ie}from"./DataTable-ChFE3RLO.js";import{_ as Ee}from"./selectables.services-BWztZSf7.js";import"./get-C6YDaK3p.js";import"./Popover-CxKYmMF9.js";import"./use-merged-state-DLxtUdHo.js";import"./Suffix-DHkxWb8H.js";import"./Tooltip-CrDeGSkE.js";const ze=N({__name:"DataTableOp",props:{item:{}},emits:["edit","delete"],setup(_,{emit:f}){const{hasPermission:o}=G(),s=xe(),c=f,g=[{show:o(["module.edit"]),label:"Editar",key:"edit",icon:P("edit-2"),props:{onClick:()=>c("edit")}},{show:o(["module.delete"]),label:"Eliminar",key:"delete",icon:P("trash","red"),props:{style:{color:"red"},onClick:()=>{s.warning({title:"Confirmar",content:"¿Está seguro que desea eliminar este registro?",positiveText:"Eliminar",negativeText:"Cancelar",closable:!1,showIcon:!1,negativeButtonProps:{secondary:!0,type:"tertiary",size:"large"},positiveButtonProps:{size:"large",type:"error"},onPositiveClick:()=>{c("delete")}})}}}];return(u,n)=>{const l=M,v=ke;return w(o)(["module.edit","module.delete"])?(E(),h(v,{key:0,options:g,placement:"bottom-start"},{default:a(()=>[e(l,null,{default:a(()=>[e(j,{"icon-name":"setting-5",size:"20"})]),_:1})]),_:1})):W("",!0)}}}),Ce=(_,f)=>[{title:"Ops.",key:"ops",width:"80px",fixed:"left",render(o){const s=o;return U(ze,{onEdit:()=>{_(s)},onDelete:()=>{f(s)},item:s},{default:()=>"Editar"})}},{title:"Nombre",key:"name",minWidth:"300px"},{title:"Código",key:"code",minWidth:"150px"},{title:"Descripción",key:"description",minWidth:"300px"},{title:"Nivel",key:"level",minWidth:"50px"},{title:"Plan de estudio",key:"curriculum",minWidth:"150px"},{title:"Extracurricular",key:"isExtracurricular",width:"150px",render:o=>U(q,{type:o.isExtracurricular?"info":"default",tertiary:!0,bordered:!1,strong:!0},{default:()=>o.isExtracurricular?"SI":"NO"})},{title:"Habilitado",key:"isEnabled",width:"150px",render:o=>U(q,{type:o.isEnabled?"success":"error",tertiary:!0,bordered:!1,strong:!0},{default:()=>o.isEnabled?"	Habilitado":"Deshabilitado"})}],Oe=(_=Y())=>({page:_.page,total:_.total,pageSize:_.pageSize,pageCount:_.pageCount,showSizePicker:!0,pageSizes:[10,50,100,500,1e3,5e3],style:{paddingRight:"16px",paddingBottom:"12px"},prefix(){return`Total ${_.total} registros`}}),F=()=>({id:null,name:null,code:null,description:null,level:null,curriculumId:null,curriculum:null,isExtracurricular:!1,isEnabled:!0}),Se=()=>({name:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}],code:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}],level:[{type:"number",required:!0,trigger:["blur","input"],message:"Obligatorio"}],description:[],curriculumId:[{type:"number",required:!0,trigger:["blur","input"],message:"Obligatorio"}]}),Z=N({__name:"ModuleForm",props:{item:{},modelValue:{type:Boolean},curriculumOptions:{}},emits:["update:modelValue","success"],setup(_,{emit:f}){const o=f,s=_,c=te({get:()=>s.modelValue,set:b=>o("update:modelValue",b)}),g=p(!1),u=p(null),n=p(F()),l=p(null),v=p({...Se()}),z=async()=>{if(u.value){const b=await u.value.validate();let t=null;b?(g.value=!0,n.value.id?t=await de(n.value):t=await pe(n.value),t.status?(o("success"),c.value=!1):l.value=t.data):console.log("Formulario inválido")}g.value=!1},$=()=>{console.log("Inicializando formulario"),n.value=s.item?{...s.item}:F()};return ae(c,b=>{b&&$()}),(b,t)=>{const I=fe,y=ve,x=Q,C=X,A=ge,m=ye,k=be,O=L,T=_e,S=M,D=H,V=oe,ee=le("upper-case");return E(),h(V,{show:c.value,"onUpdate:show":t[13]||(t[13]=r=>c.value=r)},{default:a(()=>[e(D,{style:{width:"500px"},title:b.item?"EDITAR REGISTRO":"NUEVO REGISTRO",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:a(()=>[e(k,{justify:"end"},{default:a(()=>[e(S,{tertiary:"",size:"large",onClick:t[12]||(t[12]=r=>c.value=!1),disabled:g.value},{default:a(()=>t[14]||(t[14]=[R(" Cancelar ")])),_:1},8,["disabled"]),e(S,{size:"large",type:"primary",onClick:z,loading:g.value},{default:a(()=>t[15]||(t[15]=[R("Guardar")])),_:1},8,["loading"])]),_:1})]),default:a(()=>[e(T,{ref_key:"formRef",ref:u,model:n.value,rules:v.value,size:"large"},{default:a(()=>[e(O,{gutter:"12"},{default:a(()=>[e(x,{span:"24"},{default:a(()=>{var r;return[e(y,{path:"curriculumId",label:"Plan de estudios",feedback:(r=l.value)==null?void 0:r.curriculumId},{default:a(()=>{var i;return[e(I,{clearable:"",placeholder:"Seleccione un plan de estudios",value:n.value.curriculumId,"onUpdate:value":t[0]||(t[0]=d=>n.value.curriculumId=d),options:b.curriculumOptions,"virtual-scroll":!1,status:((i=l.value)==null?void 0:i.curriculumId)!=null?"error":"",onInput:t[1]||(t[1]=d=>l.value!=null?l.value.curriculumId=null:()=>{})},null,8,["value","options","status"])]}),_:1},8,["feedback"])]}),_:1}),e(x,{span:"12"},{default:a(()=>{var r;return[e(y,{path:"code",label:"Código",feedback:(r=l.value)==null?void 0:r.code},{default:a(()=>{var i;return[ne(e(C,{status:((i=l.value)==null?void 0:i.code)!=null?"error":"",value:n.value.code,"onUpdate:value":t[2]||(t[2]=d=>n.value.code=d),onInput:t[3]||(t[3]=d=>l.value!=null?l.value.code=null:()=>{})},null,8,["status","value"]),[[ee]])]}),_:1},8,["feedback"])]}),_:1}),e(x,{span:"12"},{default:a(()=>{var r;return[e(y,{path:"level",label:"Nivel",feedback:(r=l.value)==null?void 0:r.level},{default:a(()=>{var i;return[e(A,{min:1,clearable:"",placeholder:"Ingrese el nivel",value:n.value.level,"onUpdate:value":t[4]||(t[4]=d=>n.value.level=d),status:((i=l.value)==null?void 0:i.level)!=null?"error":"",onInput:t[5]||(t[5]=d=>l.value!=null?l.value.level=null:()=>{})},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1}),e(x,{span:"24"},{default:a(()=>{var r;return[e(y,{path:"name",label:"Nombre",feedback:(r=l.value)==null?void 0:r.name},{default:a(()=>{var i;return[e(C,{status:((i=l.value)==null?void 0:i.name)!=null?"error":"",value:n.value.name,"onUpdate:value":t[6]||(t[6]=d=>n.value.name=d),onInput:t[7]||(t[7]=d=>l.value!=null?l.value.name=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1}),e(x,{span:"24"},{default:a(()=>{var r;return[e(y,{path:"description",label:"Descripción",feedback:(r=l.value)==null?void 0:r.description},{default:a(()=>{var i;return[e(C,{type:"textarea",status:((i=l.value)==null?void 0:i.description)!=null?"error":"",value:n.value.description,"onUpdate:value":t[8]||(t[8]=d=>n.value.description=d),onInput:t[9]||(t[9]=d=>l.value!=null?l.value.description=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1}),e(x,{span:"24"},{default:a(()=>[e(k,{justify:"end"},{default:a(()=>[e(y,{"label-placement":"left",label:"¿Extracurricular?",path:"isExtracurricular","show-feedback":!1},{default:a(()=>[e(m,{value:n.value.isExtracurricular,"onUpdate:value":t[10]||(t[10]=r=>n.value.isExtracurricular=r)},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(x,{span:"24"},{default:a(()=>[e(k,{justify:"end"},{default:a(()=>[e(y,{"label-placement":"left",label:"¿Habilitado?",path:"isEnabled","show-feedback":!1},{default:a(()=>[e(m,{value:n.value.isEnabled,"onUpdate:value":t[11]||(t[11]=r=>n.value.isEnabled=r)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),Ve={style:{"border-bottom":"1px solid #e9e9e9"}},$e=N({__name:"DataTable",props:{curriculumOptions:{}},setup(_){const f=ue(),o=p(!1),s=p([]),c=p(!1),g=p(null),u=re({...Y()}),n=p(""),l=p({search:null,page:u.page,pageSize:u.pageSize}),v=p({}),b=Ce(m=>{g.value=m,c.value=!0},async m=>{await me(m),await t()}),t=async()=>{l.value.page=1,await I()},I=async()=>{o.value=!0,l.value.filters={curriculumId:n.value},v.value=await ce(l.value),s.value=v.value.data,u.total=v.value.total,u.pageSize=v.value.per_page,u.page=v.value.current_page,u.pageCount=v.value.last_page,o.value=!1},y=we(()=>{t()},400),x=async m=>{l.value.page=m,await I()},C=async m=>{l.value.page=1,l.value.pageSize=m,await I()};return(async()=>{n.value=f.params.id??"",await I()})(),(m,k)=>{const O=Q,T=X,S=L,D=Ie;return E(),J(K,null,[B("div",Ve,[e(S,{gutter:12,style:{padding:"12px 16px"}},{default:a(()=>[e(O,{span:12}),e(O,{span:12},{default:a(()=>[e(T,{size:"large",placeholder:"Buscar",value:l.value.search,"onUpdate:value":k[0]||(k[0]=V=>l.value.search=V),onInput:w(y),clearable:""},{suffix:a(()=>[e(j,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),e(S,null,{default:a(()=>[e(O,{span:24},{default:a(()=>[e(D,{key:"id",remote:"",size:"small","single-line":!1,columns:w(b),data:s.value,pagination:w(Oe)(u),"pagination-show-size-picker":!0,loading:o.value,"onUpdate:page":x,"onUpdate:pageSize":C},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),se(m.$slots,"extra",{reLoadDataTable:t})]),e(Z,{modelValue:c.value,"onUpdate:modelValue":k[1]||(k[1]=V=>c.value=V),item:g.value,curriculumOptions:m.curriculumOptions,onSuccess:t},null,8,["modelValue","item","curriculumOptions"])],64)}}}),Ze=N({__name:"index",setup(_){const{hasPermission:f}=G(),o=p([]),s=p(!1);return(async()=>{o.value=await Ee()})(),(g,u)=>{const n=M,l=H,v=ie("AppNotAuthorization");return w(f)(["module.create","module.edit","module.delete"])?(E(),J(K,{key:0},[e(l,{segmented:{header:!0,content:!0}},{header:a(()=>u[2]||(u[2]=[B("span",{class:"text-sm text-slate-500"}," Gestión de modulos académicos ",-1),B("h5",{class:"text-lg font-bold text-slate-800"},"Modulos",-1)])),"header-extra":a(()=>[w(f)(["module.create"])?(E(),h(n,{key:0,size:"large",type:"primary","render-icon":w(P)("additem"),onClick:u[0]||(u[0]=z=>s.value=!0)},{default:a(()=>u[3]||(u[3]=[R(" Agregar ")])),_:1},8,["render-icon"])):W("",!0)]),_:1}),e($e,{curriculumOptions:o.value},{extra:a(({reLoadDataTable:z})=>[e(Z,{curriculumOptions:o.value,modelValue:s.value,"onUpdate:modelValue":u[1]||(u[1]=$=>s.value=$),item:null,onSuccess:z},null,8,["curriculumOptions","modelValue","onSuccess"])]),_:1},8,["curriculumOptions"])],64)):(E(),h(v,{key:1}))}}});export{Ze as default};
