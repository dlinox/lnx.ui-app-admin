import{r as X}from"./icon.utils-upfZx_ME.js";import{_ as Y,a as Z,b as ee,c as ae}from"./module.services-CoFUrjEc.js";import{d as S,a8 as F,a9 as $,aa as t,ab as e,af as B,aG as G,h as U,e as le,r as m,j as te,aL as ne,aA as W,w as ue,az as R,aH as oe,a4 as re,aI as se,aF as j,_ as H,ae as h,aJ as ie,ad as C}from"./index-C2oNslvg.js";import{_ as de,a as pe}from"./FormItem-DXyfdPQq.js";import{_ as A,a as L}from"./Col-BtUCTmqt.js";import{_ as ce}from"./Select-DaUiqjpd.js";import{_ as J}from"./Input-BQ3poveX.js";import{_ as me}from"./Space-G3ZiPI5e.js";import{_ as ve}from"./Switch-6rDtgWDf.js";import{i as K}from"./DataTable.types-BEg5m_To.js";import{u as _e}from"./composables-CkauXcFl.js";import{_ as fe}from"./Dropdown-tA5u1ub_.js";import{_ as N}from"./Tag-Dwx6Rgco.js";import{d as ge}from"./debounce.utils-DqPPCsFD.js";import{_ as be}from"./DataTable-ByPH7O8r.js";import{_ as Ie}from"./selectables.services-BXwSu-ds.js";import"./get-2__u8Ul3.js";import"./Popover-C-qVBvl0.js";import"./use-merged-state-CDxsXcm8.js";import"./Suffix-DF6h_xjA.js";import"./Tooltip-DX3_NcDh.js";const ye=S({__name:"DataTableOp",props:{item:{}},emits:["edit","delete"],setup(v,{emit:f}){const o=_e(),s=f,_=[{label:"Editar",key:"edit",icon:X("edit-2"),props:{onClick:()=>s("edit")}},{label:"Eliminar",key:"delete",icon:X("trash","red"),props:{style:{color:"red"},onClick:()=>{o.warning({title:"Confirmar",content:"¿Está seguro que desea eliminar este registro?",positiveText:"Eliminar",negativeText:"Cancelar",closable:!1,showIcon:!1,negativeButtonProps:{secondary:!0,type:"tertiary",size:"large"},positiveButtonProps:{size:"large",type:"error"},onPositiveClick:()=>{s("delete")}})}}}];return(r,i)=>{const n=B,l=fe;return $(),F(l,{options:_,placement:"bottom-start"},{default:t(()=>[e(n,null,{default:t(()=>[e(G,{"icon-name":"setting-5",size:"20"})]),_:1})]),_:1})}}}),xe=(v,f)=>[{title:"Ops.",key:"ops",width:"80px",fixed:"left",render(o){const s=o;return U(ye,{onEdit:()=>{v(s)},onDelete:()=>{f(s)},item:s},{default:()=>"Editar"})}},{title:"Nombre",key:"name",minWidth:"300px"},{title:"Código",key:"code",minWidth:"150px"},{title:"Descripción",key:"description",minWidth:"300px"},{title:"Nivel",key:"level",minWidth:"50px"},{title:"Plan de estudio",key:"curriculum",minWidth:"150px"},{title:"Extracurricular",key:"isExtracurricular",width:"150px",render:o=>U(N,{type:o.isExtracurricular?"info":"default",tertiary:!0,bordered:!1,strong:!0},{default:()=>o.isExtracurricular?"SI":"NO"})},{title:"Habilitado",key:"isEnabled",width:"150px",render:o=>U(N,{type:o.isEnabled?"success":"error",tertiary:!0,bordered:!1,strong:!0},{default:()=>o.isEnabled?"	Habilitado":"Deshabilitado"})}],ke=(v=K())=>({page:v.page,total:v.total,pageSize:v.pageSize,pageCount:v.pageCount,showSizePicker:!0,pageSizes:[10,50,100,500,1e3,5e3],style:{paddingRight:"16px",paddingBottom:"12px"},prefix(){return`Total ${v.total} registros`}}),q=()=>({id:null,name:null,code:null,description:null,level:null,curriculumId:null,curriculum:null,isExtracurricular:!1,isEnabled:!0}),we=()=>({name:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}],code:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}],level:[{type:"number",required:!0,trigger:["blur","input"],message:"Obligatorio"}],description:[],curriculumId:[{type:"number",required:!0,trigger:["blur","input"],message:"Obligatorio"}]}),Q=S({__name:"ModuleForm",props:{item:{},modelValue:{type:Boolean},curriculumOptions:{}},emits:["update:modelValue","success"],setup(v,{emit:f}){const o=f,s=v,_=le({get:()=>s.modelValue,set:b=>o("update:modelValue",b)}),r=m(!1),i=m(null),n=m(q()),l=m(null),g=m({...we()}),P=async()=>{if(i.value){const b=await i.value.validate();let a=null;b?(r.value=!0,n.value.id?a=await Y(n.value):a=await Z(n.value),a.status?(o("success"),_.value=!1):l.value=a.data):console.log("Formulario inválido")}r.value=!1},M=()=>{console.log("Inicializando formulario"),n.value=s.item?{...s.item}:q()};return te(_,b=>{b&&M()}),(b,a)=>{const x=ce,I=pe,y=L,w=J,D=ve,d=me,k=A,E=de,z=B,O=W,T=oe,V=ne("upper-case");return $(),F(T,{show:_.value,"onUpdate:show":a[13]||(a[13]=u=>_.value=u)},{default:t(()=>[e(O,{style:{width:"500px"},title:b.item?"EDITAR REGISTRO":"NUEVO REGISTRO",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:t(()=>[e(d,{justify:"end"},{default:t(()=>[e(z,{tertiary:"",size:"large",onClick:a[12]||(a[12]=u=>_.value=!1),disabled:r.value},{default:t(()=>a[14]||(a[14]=[R(" Cancelar ")])),_:1},8,["disabled"]),e(z,{size:"large",type:"primary",onClick:P,loading:r.value},{default:t(()=>a[15]||(a[15]=[R("Guardar")])),_:1},8,["loading"])]),_:1})]),default:t(()=>[e(E,{ref_key:"formRef",ref:i,model:n.value,rules:g.value,size:"large"},{default:t(()=>[e(k,{gutter:"12"},{default:t(()=>[e(y,{span:"24"},{default:t(()=>{var u;return[e(I,{path:"curriculumId",label:"Plan de estudios",feedback:(u=l.value)==null?void 0:u.curriculumId},{default:t(()=>{var p;return[e(x,{clearable:"",placeholder:"Seleccione un plan de estudios",value:n.value.curriculumId,"onUpdate:value":a[0]||(a[0]=c=>n.value.curriculumId=c),options:b.curriculumOptions,"virtual-scroll":!1,status:((p=l.value)==null?void 0:p.curriculumId)!=null?"error":"",onInput:a[1]||(a[1]=c=>l.value!=null?l.value.curriculumId=null:()=>{})},null,8,["value","options","status"])]}),_:1},8,["feedback"])]}),_:1}),e(y,{span:"12"},{default:t(()=>{var u;return[e(I,{path:"code",label:"Código",feedback:(u=l.value)==null?void 0:u.code},{default:t(()=>{var p;return[ue(e(w,{status:((p=l.value)==null?void 0:p.code)!=null?"error":"",value:n.value.code,"onUpdate:value":a[2]||(a[2]=c=>n.value.code=c),onInput:a[3]||(a[3]=c=>l.value!=null?l.value.code=null:()=>{})},null,8,["status","value"]),[[V]])]}),_:1},8,["feedback"])]}),_:1}),e(y,{span:"12"},{default:t(()=>{var u;return[e(I,{path:"level",label:"Nivel",feedback:(u=l.value)==null?void 0:u.level},{default:t(()=>{var p;return[e(x,{clearable:"",placeholder:"Seleccione un nivel",value:n.value.level,"onUpdate:value":a[4]||(a[4]=c=>n.value.level=c),options:[{label:"I",value:1},{label:"II",value:2},{label:"III",value:3},{label:"IV",value:4},{label:"V",value:5},{label:"VI",value:6},{label:"VII",value:7},{label:"VIII",value:8},{label:"IX",value:9},{label:"X",value:10},{label:"XI",value:11},{label:"XII",value:12},{label:"XIII",value:13},{label:"XIV",value:14},{label:"XV",value:15},{label:"XVI",value:16},{label:"XVII",value:17},{label:"XVIII",value:18},{label:"XIX",value:19},{label:"XX",value:20}],"virtual-scroll":!1,status:((p=l.value)==null?void 0:p.level)!=null?"error":"",onInput:a[5]||(a[5]=c=>l.value!=null?l.value.level=null:()=>{})},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1}),e(y,{span:"24"},{default:t(()=>{var u;return[e(I,{path:"name",label:"Nombre",feedback:(u=l.value)==null?void 0:u.name},{default:t(()=>{var p;return[e(w,{status:((p=l.value)==null?void 0:p.name)!=null?"error":"",value:n.value.name,"onUpdate:value":a[6]||(a[6]=c=>n.value.name=c),onInput:a[7]||(a[7]=c=>l.value!=null?l.value.name=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1}),e(y,{span:"24"},{default:t(()=>{var u;return[e(I,{path:"description",label:"Descripción",feedback:(u=l.value)==null?void 0:u.description},{default:t(()=>{var p;return[e(w,{type:"textarea",status:((p=l.value)==null?void 0:p.description)!=null?"error":"",value:n.value.description,"onUpdate:value":a[8]||(a[8]=c=>n.value.description=c),onInput:a[9]||(a[9]=c=>l.value!=null?l.value.description=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1}),e(y,{span:"24"},{default:t(()=>[e(d,{justify:"end"},{default:t(()=>[e(I,{"label-placement":"left",label:"¿Extracurricular?",path:"isExtracurricular","show-feedback":!1},{default:t(()=>[e(D,{value:n.value.isExtracurricular,"onUpdate:value":a[10]||(a[10]=u=>n.value.isExtracurricular=u)},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(y,{span:"24"},{default:t(()=>[e(d,{justify:"end"},{default:t(()=>[e(I,{"label-placement":"left",label:"¿Habilitado?",path:"isEnabled","show-feedback":!1},{default:t(()=>[e(D,{value:n.value.isEnabled,"onUpdate:value":a[11]||(a[11]=u=>n.value.isEnabled=u)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),Ee={style:{"border-bottom":"1px solid #e9e9e9"}},Ve=S({__name:"DataTable",props:{curriculumOptions:{}},setup(v){const f=re(),o=m(!1),s=m([]),_=m(!1),r=m(null),i=se({...K()}),n=m(""),l=m({search:null,page:i.page,pageSize:i.pageSize}),g=m({}),b=xe(d=>{r.value=d,_.value=!0},async d=>{await ae(d),await a()}),a=async()=>{l.value.page=1,await x()},x=async()=>{o.value=!0,l.value.filters={curriculumId:n.value},g.value=await ee(l.value),s.value=g.value.data,i.total=g.value.total,i.pageSize=g.value.per_page,i.page=g.value.current_page,i.pageCount=g.value.last_page,o.value=!1},I=ge(()=>{a()},400),y=async d=>{l.value.page=d,await x()},w=async d=>{l.value.page=1,l.value.pageSize=d,await x()};return(async()=>{n.value=f.params.id??"",await x()})(),(d,k)=>{const E=L,z=J,O=A,T=be;return $(),j(H,null,[h("div",Ee,[e(O,{gutter:12,style:{padding:"12px 16px"}},{default:t(()=>[e(E,{span:12}),e(E,{span:12},{default:t(()=>[e(z,{size:"large",placeholder:"Buscar",value:l.value.search,"onUpdate:value":k[0]||(k[0]=V=>l.value.search=V),onInput:C(I),clearable:""},{suffix:t(()=>[e(G,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),e(O,null,{default:t(()=>[e(E,{span:24},{default:t(()=>[e(T,{key:"id",remote:"","single-line":!1,columns:C(b),data:s.value,pagination:C(ke)(i),"pagination-show-size-picker":!0,loading:o.value,"onUpdate:page":y,"onUpdate:pageSize":w},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),ie(d.$slots,"extra",{reLoadDataTable:a})]),e(Q,{modelValue:_.value,"onUpdate:modelValue":k[1]||(k[1]=V=>_.value=V),item:r.value,curriculumOptions:d.curriculumOptions,onSuccess:a},null,8,["modelValue","item","curriculumOptions"])],64)}}}),Ae=S({__name:"index",setup(v){const f=m([]),o=m(!1);return(async()=>{f.value=await Ie()})(),(_,r)=>{const i=B,n=W;return $(),j(H,null,[e(n,{segmented:{header:!0,content:!0}},{header:t(()=>r[2]||(r[2]=[h("span",{class:"text-sm text-slate-500"}," Gestión de modulos académicos ",-1),h("h5",{class:"text-lg font-bold text-slate-800"},"Modulos",-1)])),"header-extra":t(()=>[e(i,{"render-icon":C(X)("additem"),onClick:r[0]||(r[0]=l=>o.value=!0)},{default:t(()=>r[3]||(r[3]=[R(" Agregar ")])),_:1},8,["render-icon"])]),_:1}),e(Ve,{curriculumOptions:f.value},{extra:t(({reLoadDataTable:l})=>[e(Q,{curriculumOptions:f.value,modelValue:o.value,"onUpdate:modelValue":r[1]||(r[1]=g=>o.value=g),item:null,onSuccess:l},null,8,["curriculumOptions","modelValue","onSuccess"])]),_:1},8,["curriculumOptions"])],64)}}});export{Ae as default};
