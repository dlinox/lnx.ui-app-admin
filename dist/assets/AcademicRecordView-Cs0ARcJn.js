import{ay as W,d as C,r as m,aF as v,a9 as c,a8 as D,ab as a,aa as t,az as w,aG as y,af as E,aA as B,ae as p,_ as z,b2 as O,ag as T,aH as j,h as F,aI as N,aJ as G,ad as h}from"./index--Fiy2I4t.js";import{a as H,i as P}from"./DataTable.types-BEg5m_To.js";import{_ as q}from"./Table-IqtdWoJB.js";import{_ as J}from"./Space-CHReEK5D.js";import{d as M}from"./debounce.utils-DqPPCsFD.js";import{_ as K,a as Q}from"./Col-Bhohzmu6.js";import{_ as X}from"./Input-CfWAw0Qs.js";import{_ as Y}from"./DataTable-D69-Uvxy.js";import"./get-slot-Bk_rJcZu.js";import"./Suffix-Cejid3DV.js";import"./use-merged-state-Hew3oQWq.js";import"./Tooltip-B09_9Vum.js";import"./Popover-_nZkNipR.js";import"./get-BxuUz3sF.js";import"./Dropdown-B9vn1Rts.js";import"./Select-JHMV7BBf.js";import"./Tag-CmlrV2vM.js";const L=W(),A="/academic-records",Z=async s=>{try{return(await L.post(`${A}/load-data-table`,s)).data.data}catch{return H()}},U=async s=>{try{const i=await L.post(`${A}/get-record-pdf/${s}`,{},{responseType:"blob"}),u=new Blob([i.data],{type:"application/pdf"}),n=window.URL.createObjectURL(u),o=document.createElement("a"),l=new Date().getTime();return o.href=n,o.download=`reporte-academico-${s}-${l}.pdf`,document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(n),!0}catch{return null}},ee=C({__name:"DataTableOp",props:{item:{}},emits:["edit","delete"],setup(s,{emit:i}){const n=m(s.item.records),o=m(!1),l=m(!1),b=async(_,e)=>{if(e===null){l.value=!0,await U(_),l.value=!1;return}n.value[e].loading=!0,await U(_),n.value[e].loading=!1};return(_,e)=>{const g=E,x=q,k=J,$=B,d=j;return c(),v(z,null,[n.value.length>1?(c(),D(g,{key:0,onClick:e[0]||(e[0]=r=>o.value=!0)},{icon:t(()=>[a(y,{"icon-name":"task",size:"20"})]),default:t(()=>[e[4]||(e[4]=w(" Registros "))]),_:1})):(c(),D(g,{key:1,onClick:e[1]||(e[1]=r=>b(n.value[0].id,null)),loading:l.value},{icon:t(()=>[a(y,{"icon-name":"document-download",size:"20"})]),default:t(()=>[e[5]||(e[5]=w(" Descargar "))]),_:1},8,["loading"])),a(d,{show:o.value,"onUpdate:show":e[3]||(e[3]=r=>o.value=r)},{default:t(()=>[a($,{style:{width:"600px"},role:"dialog","aria-modal":"true",segmented:{content:!0,footer:!0},size:"small"},{footer:t(()=>[a(k,{justify:"end"},{default:t(()=>[a(g,{class:"",onClick:e[2]||(e[2]=r=>o.value=!1)},{default:t(()=>e[8]||(e[8]=[w(" Cerrar ")])),_:1})]),_:1})]),default:t(()=>[a(x,{bordered:!1,"single-line":!1,size:"small"},{default:t(()=>[e[7]||(e[7]=p("thead",null,[p("tr",null,[p("th",{width:"160px"},"Fecha del registro"),p("th",null,"Observaciones"),p("th",{width:"120px"})])],-1)),p("tbody",null,[(c(!0),v(z,null,O(n.value,(r,f)=>(c(),v("tr",{key:f},[p("td",null,T(r.createdAt),1),p("td",null,T(r.observations),1),p("td",null,[a(g,{onClick:R=>b(r.id,f),loading:r.loading},{icon:t(()=>[a(y,{"icon-name":"document-download",size:"20"})]),default:t(()=>[e[6]||(e[6]=w(" Descargar "))]),_:2},1032,["onClick","loading"])])]))),128))])]),_:1})]),_:1})]),_:1},8,["show"])],64)}}}),te=()=>[{title:"Registros",key:"records",fixed:"left",width:"120px",render(s){return F(ee,{item:s},{default:()=>"Editar"})}},{title:"Grupo",key:"group",minWidth:"50px"},{title:"Curso",key:"course",minWidth:"120px"},{title:"Docente",key:"teacher",minWidth:"120px"},{title:"Periodo",key:"period",minWidth:"120px"},{title:"Ultimo registro",key:"lastCreatedAt",minWidth:"140px"}],ae=(s=P())=>({page:s.page,total:s.total,pageSize:s.pageSize,pageCount:s.pageCount,showSizePicker:!0,pageSizes:[10,50,100,500,1e3],style:{paddingRight:"16px",paddingBottom:"12px"},prefix(){return`Total ${s.total} registros`}}),ne={style:{"border-bottom":"1px solid #e9e9e9"}},oe=C({__name:"DataTable",setup(s){const i=m(!1),u=m([]),n=N({...P()}),o=m({search:null,page:n.page,pageSize:n.pageSize}),l=m({}),b=te(),_=async()=>{o.value.page=1,await e()},e=async()=>{i.value=!0,l.value=await Z(o.value),u.value=l.value.data,n.total=l.value.total,n.pageSize=l.value.per_page,n.page=l.value.current_page,n.pageCount=l.value.last_page,i.value=!1},g=M(()=>{_()},400),x=async d=>{o.value.page=d,await e()},k=async d=>{o.value.page=1,o.value.pageSize=d,await e()};return(async()=>{await e()})(),(d,r)=>{const f=Q,R=X,S=K,V=Y;return c(),v("div",ne,[a(S,{gutter:12,style:{padding:"12px 16px"}},{default:t(()=>[a(f,{span:12}),a(f,{span:12},{default:t(()=>[a(R,{size:"large",placeholder:"Buscar",value:o.value.search,"onUpdate:value":r[0]||(r[0]=I=>o.value.search=I),onInput:h(g),clearable:""},{suffix:t(()=>[a(y,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),a(S,null,{default:t(()=>[a(f,{span:24},{default:t(()=>[a(V,{key:"id",remote:"","single-line":!1,columns:h(b),data:u.value,pagination:h(ae)(n),"pagination-show-size-picker":!0,loading:i.value,"onUpdate:page":x,"onUpdate:pageSize":k},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),G(d.$slots,"extra",{reLoadDataTable:_})])}}}),ke=C({__name:"AcademicRecordView",setup(s){return(i,u)=>{const n=B;return c(),v(z,null,[a(n,{segmented:{header:!0,content:!0}},{header:t(()=>u[0]||(u[0]=[p("span",{class:"text-sm text-slate-500"}," Registro de actas académicas ",-1),p("h5",{class:"text-lg font-bold text-slate-800"},"Actas académicas",-1)])),"header-extra":t(()=>u[1]||(u[1]=[])),_:1}),a(oe)],64)}}});export{ke as default};
