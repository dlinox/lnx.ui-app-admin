import{r as R}from"./icon.utils-CUQHzjSp.js";import{d as T,a8 as L,a9 as C,aa as t,ab as e,af as O,aG as N,h as ee,ay as te,e as P,r as p,j as ae,a7 as oe,aA as M,az as I,b9 as ne,aH as se,aI as le,aF as G,_ as W,ae as E,aJ as re,ad as z}from"./index-BA0H_JCl.js";import{i as j,a as ie}from"./DataTable.types-BEg5m_To.js";import{_ as ue,a as pe}from"./FormItem-BNivClae.js";import{_ as H,a as J}from"./Col-cTRCMRiH.js";import{_ as de}from"./Alert-CrY12w7S.js";import{_ as ce}from"./Select-DtHdO6pL.js";import{_ as K}from"./Input-CZ0NJzi4.js";import{_ as me}from"./Space-ByIL93Yx.js";import{u as _e}from"./composables-mQeoW-4M.js";import{_ as ge}from"./Dropdown-C667YNyW.js";import{d as ve}from"./debounce.utils-DqPPCsFD.js";import{_ as fe}from"./DataTable-CFRMbF6h.js";import"./get-CuJVaMdf.js";import"./Popover-Aio3sJwU.js";import"./use-merged-state-DP6rciDv.js";import"./Suffix-C2nBboqj.js";import"./Tag-7hJbHmVV.js";import"./Tooltip-ByhZhG9O.js";const be=T({__name:"DataTableOp",props:{item:{}},emits:["edit","delete"],setup(s,{emit:n}){const m=_e(),a=n,u=[{label:"Editar",key:"edit",icon:R("edit-2"),props:{onClick:()=>a("edit")}},{label:"Eliminar",key:"delete",icon:R("trash","red"),props:{style:{color:"red"},onClick:()=>{m.warning({title:"Confirmar",content:"¿Está seguro que desea eliminar este registro?",positiveText:"Eliminar",negativeText:"Cancelar",closable:!1,showIcon:!1,negativeButtonProps:{secondary:!0,type:"tertiary",size:"large"},positiveButtonProps:{size:"large",type:"error"},onPositiveClick:()=>{a("delete")}})}}}];return(r,i)=>{const l=O,v=ge;return C(),L(v,{options:u,placement:"bottom-start"},{default:t(()=>[e(l,null,{default:t(()=>[e(N,{"icon-name":"setting-5",size:"20"})]),_:1})]),_:1})}}}),ye=(s,n)=>[{title:"Ops.",key:"ops",width:"80px",fixed:"left",render(m){const a=m;return ee(be,{onEdit:()=>{s(a)},onDelete:()=>{n(a)},item:a},{default:()=>"Editar"})}},{title:"Periodo",key:"period",minWidth:"120px"},{title:"Docente",key:"teacher",minWidth:"120px"},{title:"Curso",key:"course",minWidth:"120px"},{title:"Tipo",key:"type",width:"120px"},{title:"Observaciones",key:"observations",minWidth:"200px"}],we=(s=j())=>({page:s.page,total:s.total,pageSize:s.pageSize,pageCount:s.pageCount,showSizePicker:!0,pageSizes:[10,50,100,500,1e3],style:{paddingRight:"16px",paddingBottom:"12px"},prefix(){return`Total ${s.total} registros`}}),F=()=>({id:null,groupId:null,type:null,observations:""}),xe=()=>({groupId:[{required:!0,type:"number",message:"Obligatorio",trigger:"blur"}],type:[{required:!0,message:"Obligatorio",trigger:"blur"}],observations:[{required:!0,message:"Obligatorio",trigger:"blur"}]}),V=te(),$="/academic-supervision",ke=async s=>{try{return(await V.post(`${$}/load-data-table`,s)).data.data}catch{return ie()}},he=async s=>{try{return{status:!0,data:(await V.post(`${$}/save`,s)).data.data}}catch(n){return n.response.status===422?{status:!1,data:n.response.data.errors}:{status:!1,data:null}}},Se=async s=>{try{return(await V.post(`${$}/delete`,s)).data.status}catch{return!1}},Ie=async()=>{try{return(await V.get(`${$}/active-groups`)).data.data}catch{return[]}},Q=T({__name:"Form",props:{item:{},modelValue:{type:Boolean}},emits:["update:modelValue","success"],setup(s,{emit:n}){const m=n,a=s,u=P({get:()=>a.modelValue,set:_=>m("update:modelValue",_)}),r=p(!1),i=p(null),l=p(F()),v=p(null),B=P(()=>({...xe()})),h=p([]),f=async()=>{if(i.value){const _=await i.value.validate();let o=null;_&&(r.value=!0,o=await he(l.value),o.status?(m("success"),u.value=!1):v.value=o.data)}r.value=!1},b=async()=>{l.value=a.item?{...a.item,groupId:a.item.groupId}:F(),h.value=await Ie()};return ae(u,_=>{_&&(v.value=null,b())}),(_,o)=>{const A=oe("LnxIcon"),U=ne,d=de,g=J,y=ce,w=pe,S=K,D=H,x=ue,q=O,X=me,Y=M,Z=se;return C(),L(Z,{show:u.value,"onUpdate:show":o[4]||(o[4]=c=>u.value=c)},{default:t(()=>[e(Y,{style:{width:"500px"},title:_.item?"Editar registro":"Nuevo registro",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:t(()=>[e(X,{justify:"end"},{default:t(()=>[e(q,{tertiary:"",size:"large",onClick:o[3]||(o[3]=c=>u.value=!1),disabled:r.value},{default:t(()=>o[6]||(o[6]=[I(" Cancelar ")])),_:1},8,["disabled"]),e(q,{size:"large",type:"primary",onClick:f,loading:r.value},{default:t(()=>o[7]||(o[7]=[I(" Guardar ")])),_:1},8,["loading"])]),_:1})]),default:t(()=>[e(x,{ref_key:"formRef",ref:i,model:l.value,rules:B.value,size:"large"},{default:t(()=>[e(D,{gutter:16},{default:t(()=>[e(g,{span:24},{default:t(()=>[e(d,{stype:"default",closable:"",class:"mb-2"},{icon:t(()=>[e(U,null,{default:t(()=>[e(A,{iconName:"info-circle"})]),_:1})]),default:t(()=>[o[5]||(o[5]=I(" Solo se listan los grupos que todavía están activos o disponibles para matrícula. "))]),_:1})]),_:1}),e(g,{span:24},{default:t(()=>{var c;return[e(w,{path:"groupId",label:"Grupo - Docente","show-require-mark":!0,feedback:(c=v.value)==null?void 0:c.groupId},{default:t(()=>[e(y,{value:l.value.groupId,"onUpdate:value":o[0]||(o[0]=k=>l.value.groupId=k),options:h.value,placeholder:"Seleccione un grupo",clearable:!0,loading:r.value,disabled:r.value},null,8,["value","options","loading","disabled"])]),_:1},8,["feedback"])]}),_:1}),e(g,{span:24},{default:t(()=>{var c;return[e(w,{path:"type",label:"Tipo","show-require-mark":!0,feedback:(c=v.value)==null?void 0:c.type},{default:t(()=>[e(y,{value:l.value.type,"onUpdate:value":o[1]||(o[1]=k=>l.value.type=k),options:[{label:"TARDE",value:"TARDE"},{label:"FALTA",value:"FALTA"},{label:"OTROS",value:"OTROS"}],placeholder:"Seleccione el tipo",clearable:!0},null,8,["value"])]),_:1},8,["feedback"])]}),_:1}),e(g,{span:24},{default:t(()=>{var c;return[e(w,{path:"observations",label:"Observaciones","show-require-mark":!0,feedback:(c=v.value)==null?void 0:c.observations},{default:t(()=>[e(S,{value:l.value.observations,"onUpdate:value":o[2]||(o[2]=k=>l.value.observations=k),type:"textarea",placeholder:"Ingrese las observaciones",disabled:r.value},null,8,["value","disabled"])]),_:1},8,["feedback"])]}),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),ze={style:{"border-bottom":"1px solid #e9e9e9"}},Te=T({__name:"DataTable",setup(s){const n=p(!1),m=p([]),a=p(!1),u=p(null),r=le({...j()}),i=p({search:null,page:r.page,pageSize:r.pageSize}),l=p({}),h=ye(d=>{u.value=d,a.value=!0},async d=>{await Se(d),await f()}),f=async()=>{i.value.page=1,await b()},b=async()=>{n.value=!0,l.value=await ke(i.value),m.value=l.value.data,r.total=l.value.total,r.pageSize=l.value.per_page,r.page=l.value.current_page,r.pageCount=l.value.last_page,n.value=!1},_=ve(()=>{f()},400),o=async d=>{i.value.page=d,await b()},A=async d=>{i.value.page=1,i.value.pageSize=d,await b()};return(async()=>{await b()})(),(d,g)=>{const y=J,w=K,S=H,D=fe;return C(),G(W,null,[E("div",ze,[e(S,{gutter:12,style:{padding:"12px 16px"}},{default:t(()=>[e(y,{span:12}),e(y,{span:12},{default:t(()=>[e(w,{size:"large",placeholder:"Buscar",value:i.value.search,"onUpdate:value":g[0]||(g[0]=x=>i.value.search=x),onInput:z(_),clearable:""},{suffix:t(()=>[e(N,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),e(S,null,{default:t(()=>[e(y,{span:24},{default:t(()=>[e(D,{key:"id",remote:"","single-line":!1,columns:z(h),data:m.value,pagination:z(we)(r),"pagination-show-size-picker":!0,loading:n.value,"onUpdate:page":o,"onUpdate:pageSize":A},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),re(d.$slots,"extra",{reLoadDataTable:f})]),e(Q,{modelValue:a.value,"onUpdate:modelValue":g[1]||(g[1]=x=>a.value=x),item:u.value,onSuccess:f},null,8,["modelValue","item"])],64)}}}),He=T({__name:"AcademicSupervisionView",setup(s){const n=p(!1);return(m,a)=>{const u=O,r=M;return C(),G(W,null,[e(r,{segmented:{header:!0,content:!0}},{header:t(()=>a[2]||(a[2]=[E("span",{class:"text-sm text-slate-500"}," Registro de supervisión académica ",-1),E("h5",{class:"text-lg font-bold text-slate-800"},"Supervisión académica",-1)])),"header-extra":t(()=>[e(u,{"render-icon":z(R)("additem"),onClick:a[0]||(a[0]=i=>n.value=!0)},{default:t(()=>a[3]||(a[3]=[I(" Agregar ")])),_:1},8,["render-icon"])]),_:1}),e(Te,null,{extra:t(({reLoadDataTable:i})=>[e(Q,{modelValue:n.value,"onUpdate:modelValue":a[1]||(a[1]=l=>n.value=l),item:null,onSuccess:i},null,8,["modelValue","onSuccess"])]),_:1})],64)}}});export{He as default};
