import{r as ee}from"./icon.utils-Cdau1lmo.js";import{_ as ae,u as te,a as le}from"./period.stores-9Tu0xZQr.js";import{d as N}from"./debounce.utils-DqPPCsFD.js";import{a as ne}from"./selectables.services-BaLMt3qD.js";import{h as I,af as F,d as M,e as O,r as p,j as oe,a8 as re,a9 as T,aa as t,ab as a,aA as R,ad as S,az as $,aH as se,aI as ue,aF as j,_ as q,ae as U,aJ as ie,aG as de}from"./index--Fiy2I4t.js";import{_ as pe,a as me}from"./FormItem-64Oo6hS7.js";import{_ as W,a as G}from"./Col-Bhohzmu6.js";import{_ as ce}from"./Select-JHMV7BBf.js";import{_ as H}from"./Input-CfWAw0Qs.js";import{_ as _e}from"./Space-CHReEK5D.js";import{_ as ve}from"./Switch-DDt0T-WF.js";import{i as J}from"./DataTable.types-BEg5m_To.js";import{f as A}from"./dateFormatter.utils-4gMrAa0F.js";import{_ as fe}from"./DataTable-D69-Uvxy.js";import"./get-BxuUz3sF.js";import"./Popover-_nZkNipR.js";import"./use-merged-state-Hew3oQWq.js";import"./Suffix-Cejid3DV.js";import"./Tag-CmlrV2vM.js";import"./get-slot-Bk_rJcZu.js";import"./Tooltip-B09_9Vum.js";import"./Dropdown-B9vn1Rts.js";const ge=u=>[{title:"Ops.",key:"ops",width:"80px",fixed:"left",render(r){const o=r;return I(F,{disabled:o.type==="AMPLIACION",onClick:()=>{u(o)},item:o},{default:()=>"Ampliación"})}},{title:"Periodo",key:"period",minWidth:"120px"},{title:"Fecha de Inicio",key:"startDate",minWidth:"140px",render(r){const o=r;return I("span",{},{default:()=>A(o.startDate)})}},{title:"Fecha de Fin",key:"endDate",minWidth:"140px",render(r){const o=r;return I("span",{},{default:()=>A(o.endDate)})}},{title:"Tipo",key:"type",width:"120px"},{title:"Matrícula Virtual",key:"virtual",width:"120px",render(r){const o=r;return I("span",{},{default:()=>o.virtual?"Habilitado":"No habilitado"})}},{title:"Observaciones",key:"observations",minWidth:"200px"}],be=(u=J())=>({page:u.page,total:u.total,pageSize:u.pageSize,pageCount:u.pageCount,showSizePicker:!0,pageSizes:[10,50,100,500,1e3],style:{paddingRight:"16px",paddingBottom:"12px"},prefix(){return`Total ${u.total} registros`}}),L=()=>({id:null,startDate:null,endDate:null,observations:"",periodId:null,virtual:!0}),De=u=>({startDate:[{required:!0,trigger:["blur","input"],message:"Obligatorio"},{message:"La fecha de inicio debe ser menor",trigger:"blur",validator:(r,o)=>u.endDate&&o>u.endDate?Promise.reject("La fecha de inicio debe ser menor"):Promise.resolve()}],endDate:[{required:!0,trigger:["blur","input"],message:"Obligatorio"},{message:"La fecha de fin debe ser mayor",trigger:"blur",validator:(r,o)=>u.startDate&&o<u.startDate?Promise.reject("La fecha de fin debe ser mayor"):Promise.resolve()}],periodId:[{type:"number",required:!0,trigger:["blur","input"],message:"Obligatorio"}]}),K=M({__name:"Form",props:{item:{},modelValue:{type:Boolean}},emits:["update:modelValue","success"],setup(u,{emit:r}){const o=r,s=u,c=O({get:()=>s.modelValue,set:m=>o("update:modelValue",m)}),v=p(!1),d=p(null),l=p(L()),n=p(null),B=O(()=>({...De(l.value)})),k=p(!1),D=p([]),g=async m=>{k.value=!0,D.value=await ne(m),k.value=!1},P=N(m=>{g(m)},400),z=async()=>{if(d.value){const m=await d.value.validate();let e=null;m&&(v.value=!0,e=await ae(l.value),e.status?(o("success"),c.value=!1):n.value=e.data)}v.value=!1},V=()=>{l.value=s.item?{...s.item,startDate:s.item.lastDate?s.item.lastDate.slice(0,10):null,endDate:null,observations:null}:L()};return oe(c,m=>{m&&(n.value=null,g(""),V())}),(m,e)=>{const y=ce,f=me,b=G,w=H,C=ve,x=_e,Q=W,X=pe,E=F,Y=R,Z=se;return T(),re(Z,{show:c.value,"onUpdate:show":e[10]||(e[10]=i=>c.value=i)},{default:t(()=>[a(Y,{style:{width:"500px"},title:m.item?"Editar registro":"Nuevo registro",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:t(()=>[a(x,{justify:"end"},{default:t(()=>[a(E,{tertiary:"",size:"large",onClick:e[9]||(e[9]=i=>c.value=!1),disabled:v.value},{default:t(()=>e[11]||(e[11]=[$(" Cancelar ")])),_:1},8,["disabled"]),a(E,{size:"large",type:"primary",onClick:z,loading:v.value},{default:t(()=>e[12]||(e[12]=[$("Guardar")])),_:1},8,["loading"])]),_:1})]),default:t(()=>[a(X,{ref_key:"formRef",ref:d,model:l.value,rules:B.value,size:"large"},{default:t(()=>[a(Q,{gutter:16},{default:t(()=>[a(b,{span:"24"},{default:t(()=>{var i;return[a(f,{path:"periodId",label:"Periodo",feedback:(i=n.value)==null?void 0:i.periodId},{default:t(()=>[a(y,{value:l.value.periodId,"onUpdate:value":[e[0]||(e[0]=_=>l.value.periodId=_),e[1]||(e[1]=()=>n.value!=null?n.value.periodId=null:()=>{})],placeholder:"Seleccionar Periodo Académico",filterable:"",options:D.value,loading:k.value,clearable:"",remote:"",disabled:l.value.id!=null,"virtual-scroll":!1,onSearch:S(P)},null,8,["value","options","loading","disabled","onSearch"])]),_:1},8,["feedback"])]}),_:1}),a(b,{span:"12"},{default:t(()=>{var i;return[a(f,{path:"startDate",label:"Fecha de inicio",feedback:(i=n.value)==null?void 0:i.startDate},{default:t(()=>{var _;return[a(w,{type:"date",disabled:l.value.id!=null,value:l.value.startDate,"onUpdate:value":[e[2]||(e[2]=h=>l.value.startDate=h),e[3]||(e[3]=()=>n.value!=null?n.value.startDate=null:()=>{})],status:((_=n.value)==null?void 0:_.startDate)!=null?"error":"",clearable:"",placeholder:""},null,8,["disabled","value","status"])]}),_:1},8,["feedback"])]}),_:1}),a(b,{span:"12"},{default:t(()=>{var i;return[a(f,{path:"endDate",label:"Fecha de fin",feedback:(i=n.value)==null?void 0:i.endDate},{default:t(()=>{var _;return[a(w,{type:"date",placeholder:"",value:l.value.endDate,"onUpdate:value":[e[4]||(e[4]=h=>l.value.endDate=h),e[5]||(e[5]=()=>n.value!=null?n.value.endDate=null:()=>{})],status:((_=n.value)==null?void 0:_.endDate)!=null?"error":"",clearable:""},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1}),a(b,{span:"24"},{default:t(()=>{var i;return[a(f,{path:"observations",label:"Observaciones",feedback:(i=n.value)==null?void 0:i.observations},{default:t(()=>{var _;return[a(w,{type:"textarea",value:l.value.observations,"onUpdate:value":[e[6]||(e[6]=h=>l.value.observations=h),e[7]||(e[7]=()=>n.value!=null?n.value.observations=null:()=>{})],status:((_=n.value)==null?void 0:_.observations)!=null?"error":"",clearable:"",placeholder:"Ingrese observaciones"},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1}),a(b,{span:"24"},{default:t(()=>[a(x,{justify:"end"},{default:t(()=>[a(f,{"label-placement":"left",label:"Matrícula virtual",path:"isEnabled","show-feedback":!1},{default:t(()=>[a(C,{value:l.value.virtual,"onUpdate:value":e[8]||(e[8]=i=>l.value.virtual=i)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),ye={style:{"border-bottom":"1px solid #e9e9e9"}},we=M({__name:"DataTable",setup(u){const r=te(),o=p(!1),s=p([]),c=p(!1),v=p(null),d=ue({...J()}),l=p({search:null,page:d.page,pageSize:d.pageSize}),n=p({}),k=ge(e=>{v.value=e,c.value=!0}),D=async()=>{l.value.page=1,await g()},g=async()=>{o.value=!0,await r.getEnrollment(),n.value=await le(l.value),s.value=n.value.data,d.total=n.value.total,d.pageSize=n.value.per_page,d.page=n.value.current_page,d.pageCount=n.value.last_page,o.value=!1},P=N(()=>{D()},400),z=async e=>{l.value.page=e,await g()},V=async e=>{l.value.page=1,l.value.pageSize=e,await g()};return(async()=>{await g()})(),(e,y)=>{const f=G,b=H,w=W,C=fe;return T(),j(q,null,[U("div",ye,[a(w,{gutter:12,style:{padding:"12px 16px"}},{default:t(()=>[a(f,{span:12}),a(f,{span:12},{default:t(()=>[a(b,{size:"large",placeholder:"Buscar",value:l.value.search,"onUpdate:value":y[0]||(y[0]=x=>l.value.search=x),onInput:S(P),clearable:""},{suffix:t(()=>[a(de,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),a(w,null,{default:t(()=>[a(f,{span:24},{default:t(()=>[a(C,{key:"id",remote:"","single-line":!1,columns:S(k),data:s.value,pagination:S(be)(d),"pagination-show-size-picker":!0,loading:o.value,"onUpdate:page":z,"onUpdate:pageSize":V},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),ie(e.$slots,"extra",{reLoadDataTable:D})]),a(K,{modelValue:c.value,"onUpdate:modelValue":y[1]||(y[1]=x=>c.value=x),item:v.value,onSuccess:D},null,8,["modelValue","item"])],64)}}}),qe=M({__name:"EnrollmentDeadlineView",setup(u){const r=p(!1);return(o,s)=>{const c=F,v=R;return T(),j(q,null,[a(v,{segmented:{header:!0,content:!0}},{header:t(()=>s[2]||(s[2]=[U("span",{class:"text-sm text-slate-500"},"Gestión de Periodos de Matrícula",-1),U("h5",{class:"text-lg font-bold text-slate-800"},"Periodos de Matrícula",-1)])),"header-extra":t(()=>[a(c,{"render-icon":S(ee)("additem"),onClick:s[0]||(s[0]=d=>r.value=!0)},{default:t(()=>s[3]||(s[3]=[$(" Agregar ")])),_:1},8,["render-icon"])]),_:1}),a(we,null,{extra:t(({reLoadDataTable:d})=>[a(K,{modelValue:r.value,"onUpdate:modelValue":s[1]||(s[1]=l=>r.value=l),item:null,onSuccess:d},null,8,["modelValue","onSuccess"])]),_:1})],64)}}});export{qe as default};
