import{r as U}from"./icon.utils-CJqgT2q4.js";import{_ as Z,a as ee,b as te,c as ae}from"./module.services-D9wSXzaa.js";import{d as $,a8 as G,a9 as S,aa as l,ab as e,af as B,aG as W,h as T,e as le,r as c,j as ne,aL as oe,aA as j,w as ue,az as R,aH as re,a4 as se,aI as ie,aF as H,_ as A,ae as h,aJ as de,ad as C}from"./index-Mm-w-23V.js";import{_ as pe,a as ce}from"./FormItem-Ck8B0f5W.js";import{_ as L,a as J}from"./Col-DSV9bJWa.js";import{_ as me}from"./Select-BgP3DZgt.js";import{_ as K}from"./Input-Dcwlxepe.js";import{_ as _e}from"./InputNumber-CcGgG5k0.js";import{_ as ve}from"./Space-aSEcdxs0.js";import{_ as fe}from"./Switch-Cdksjims.js";import{i as Q}from"./DataTable.types-BEg5m_To.js";import{u as ge}from"./composables-Cniqsi4X.js";import{_ as be}from"./Dropdown-DhS2jsXU.js";import{_ as q}from"./Tag-hxCWo2xn.js";import{d as ye}from"./debounce.utils-DqPPCsFD.js";import{_ as xe}from"./DataTable-D0CufK-E.js";import{_ as ke}from"./selectables.services-qRu4Op-i.js";import"./get-CmkOQxkd.js";import"./Popover-DJdlSI1t.js";import"./use-merged-state-BlrC8VEx.js";import"./Suffix-CqsLXtUP.js";import"./Tooltip-EMVPpn5m.js";const we=$({__name:"DataTableOp",props:{item:{}},emits:["edit","delete"],setup(_,{emit:f}){const u=ge(),s=f,v=[{label:"Editar",key:"edit",icon:U("edit-2"),props:{onClick:()=>s("edit")}},{label:"Eliminar",key:"delete",icon:U("trash","red"),props:{style:{color:"red"},onClick:()=>{u.warning({title:"Confirmar",content:"¿Está seguro que desea eliminar este registro?",positiveText:"Eliminar",negativeText:"Cancelar",closable:!1,showIcon:!1,negativeButtonProps:{secondary:!0,type:"tertiary",size:"large"},positiveButtonProps:{size:"large",type:"error"},onPositiveClick:()=>{s("delete")}})}}}];return(r,i)=>{const n=B,a=be;return S(),G(a,{options:v,placement:"bottom-start"},{default:l(()=>[e(n,null,{default:l(()=>[e(W,{"icon-name":"setting-5",size:"20"})]),_:1})]),_:1})}}}),Ie=(_,f)=>[{title:"Ops.",key:"ops",width:"80px",fixed:"left",render(u){const s=u;return T(we,{onEdit:()=>{_(s)},onDelete:()=>{f(s)},item:s},{default:()=>"Editar"})}},{title:"Nombre",key:"name",minWidth:"300px"},{title:"Código",key:"code",minWidth:"150px"},{title:"Descripción",key:"description",minWidth:"300px"},{title:"Nivel",key:"level",minWidth:"50px"},{title:"Plan de estudio",key:"curriculum",minWidth:"150px"},{title:"Extracurricular",key:"isExtracurricular",width:"150px",render:u=>T(q,{type:u.isExtracurricular?"info":"default",tertiary:!0,bordered:!1,strong:!0},{default:()=>u.isExtracurricular?"SI":"NO"})},{title:"Habilitado",key:"isEnabled",width:"150px",render:u=>T(q,{type:u.isEnabled?"success":"error",tertiary:!0,bordered:!1,strong:!0},{default:()=>u.isEnabled?"	Habilitado":"Deshabilitado"})}],Ee=(_=Q())=>({page:_.page,total:_.total,pageSize:_.pageSize,pageCount:_.pageCount,showSizePicker:!0,pageSizes:[10,50,100,500,1e3,5e3],style:{paddingRight:"16px",paddingBottom:"12px"},prefix(){return`Total ${_.total} registros`}}),F=()=>({id:null,name:null,code:null,description:null,level:null,curriculumId:null,curriculum:null,isExtracurricular:!1,isEnabled:!0}),ze=()=>({name:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}],code:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}],level:[{type:"number",required:!0,trigger:["blur","input"],message:"Obligatorio"}],description:[],curriculumId:[{type:"number",required:!0,trigger:["blur","input"],message:"Obligatorio"}]}),X=$({__name:"ModuleForm",props:{item:{},modelValue:{type:Boolean},curriculumOptions:{}},emits:["update:modelValue","success"],setup(_,{emit:f}){const u=f,s=_,v=le({get:()=>s.modelValue,set:b=>u("update:modelValue",b)}),r=c(!1),i=c(null),n=c(F()),a=c(null),g=c({...ze()}),P=async()=>{if(i.value){const b=await i.value.validate();let t=null;b?(r.value=!0,n.value.id?t=await Z(n.value):t=await ee(n.value),t.status?(u("success"),v.value=!1):a.value=t.data):console.log("Formulario inválido")}r.value=!1},M=()=>{console.log("Inicializando formulario"),n.value=s.item?{...s.item}:F()};return ne(v,b=>{b&&M()}),(b,t)=>{const w=me,y=ce,x=J,I=K,N=_e,m=fe,k=ve,E=L,V=pe,z=B,D=j,O=re,Y=oe("upper-case");return S(),G(O,{show:v.value,"onUpdate:show":t[13]||(t[13]=o=>v.value=o)},{default:l(()=>[e(D,{style:{width:"500px"},title:b.item?"EDITAR REGISTRO":"NUEVO REGISTRO",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:l(()=>[e(k,{justify:"end"},{default:l(()=>[e(z,{tertiary:"",size:"large",onClick:t[12]||(t[12]=o=>v.value=!1),disabled:r.value},{default:l(()=>t[14]||(t[14]=[R(" Cancelar ")])),_:1},8,["disabled"]),e(z,{size:"large",type:"primary",onClick:P,loading:r.value},{default:l(()=>t[15]||(t[15]=[R("Guardar")])),_:1},8,["loading"])]),_:1})]),default:l(()=>[e(V,{ref_key:"formRef",ref:i,model:n.value,rules:g.value,size:"large"},{default:l(()=>[e(E,{gutter:"12"},{default:l(()=>[e(x,{span:"24"},{default:l(()=>{var o;return[e(y,{path:"curriculumId",label:"Plan de estudios",feedback:(o=a.value)==null?void 0:o.curriculumId},{default:l(()=>{var d;return[e(w,{clearable:"",placeholder:"Seleccione un plan de estudios",value:n.value.curriculumId,"onUpdate:value":t[0]||(t[0]=p=>n.value.curriculumId=p),options:b.curriculumOptions,"virtual-scroll":!1,status:((d=a.value)==null?void 0:d.curriculumId)!=null?"error":"",onInput:t[1]||(t[1]=p=>a.value!=null?a.value.curriculumId=null:()=>{})},null,8,["value","options","status"])]}),_:1},8,["feedback"])]}),_:1}),e(x,{span:"12"},{default:l(()=>{var o;return[e(y,{path:"code",label:"Código",feedback:(o=a.value)==null?void 0:o.code},{default:l(()=>{var d;return[ue(e(I,{status:((d=a.value)==null?void 0:d.code)!=null?"error":"",value:n.value.code,"onUpdate:value":t[2]||(t[2]=p=>n.value.code=p),onInput:t[3]||(t[3]=p=>a.value!=null?a.value.code=null:()=>{})},null,8,["status","value"]),[[Y]])]}),_:1},8,["feedback"])]}),_:1}),e(x,{span:"12"},{default:l(()=>{var o;return[e(y,{path:"level",label:"Nivel",feedback:(o=a.value)==null?void 0:o.level},{default:l(()=>{var d;return[e(N,{min:1,clearable:"",placeholder:"Ingrese el nivel",value:n.value.level,"onUpdate:value":t[4]||(t[4]=p=>n.value.level=p),status:((d=a.value)==null?void 0:d.level)!=null?"error":"",onInput:t[5]||(t[5]=p=>a.value!=null?a.value.level=null:()=>{})},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1}),e(x,{span:"24"},{default:l(()=>{var o;return[e(y,{path:"name",label:"Nombre",feedback:(o=a.value)==null?void 0:o.name},{default:l(()=>{var d;return[e(I,{status:((d=a.value)==null?void 0:d.name)!=null?"error":"",value:n.value.name,"onUpdate:value":t[6]||(t[6]=p=>n.value.name=p),onInput:t[7]||(t[7]=p=>a.value!=null?a.value.name=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1}),e(x,{span:"24"},{default:l(()=>{var o;return[e(y,{path:"description",label:"Descripción",feedback:(o=a.value)==null?void 0:o.description},{default:l(()=>{var d;return[e(I,{type:"textarea",status:((d=a.value)==null?void 0:d.description)!=null?"error":"",value:n.value.description,"onUpdate:value":t[8]||(t[8]=p=>n.value.description=p),onInput:t[9]||(t[9]=p=>a.value!=null?a.value.description=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1}),e(x,{span:"24"},{default:l(()=>[e(k,{justify:"end"},{default:l(()=>[e(y,{"label-placement":"left",label:"¿Extracurricular?",path:"isExtracurricular","show-feedback":!1},{default:l(()=>[e(m,{value:n.value.isExtracurricular,"onUpdate:value":t[10]||(t[10]=o=>n.value.isExtracurricular=o)},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(x,{span:"24"},{default:l(()=>[e(k,{justify:"end"},{default:l(()=>[e(y,{"label-placement":"left",label:"¿Habilitado?",path:"isEnabled","show-feedback":!1},{default:l(()=>[e(m,{value:n.value.isEnabled,"onUpdate:value":t[11]||(t[11]=o=>n.value.isEnabled=o)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),Oe={style:{"border-bottom":"1px solid #e9e9e9"}},Ce=$({__name:"DataTable",props:{curriculumOptions:{}},setup(_){const f=se(),u=c(!1),s=c([]),v=c(!1),r=c(null),i=ie({...Q()}),n=c(""),a=c({search:null,page:i.page,pageSize:i.pageSize}),g=c({}),b=Ie(m=>{r.value=m,v.value=!0},async m=>{await ae(m),await t()}),t=async()=>{a.value.page=1,await w()},w=async()=>{u.value=!0,a.value.filters={curriculumId:n.value},g.value=await te(a.value),s.value=g.value.data,i.total=g.value.total,i.pageSize=g.value.per_page,i.page=g.value.current_page,i.pageCount=g.value.last_page,u.value=!1},y=ye(()=>{t()},400),x=async m=>{a.value.page=m,await w()},I=async m=>{a.value.page=1,a.value.pageSize=m,await w()};return(async()=>{n.value=f.params.id??"",await w()})(),(m,k)=>{const E=J,V=K,z=L,D=xe;return S(),H(A,null,[h("div",Oe,[e(z,{gutter:12,style:{padding:"12px 16px"}},{default:l(()=>[e(E,{span:12}),e(E,{span:12},{default:l(()=>[e(V,{size:"large",placeholder:"Buscar",value:a.value.search,"onUpdate:value":k[0]||(k[0]=O=>a.value.search=O),onInput:C(y),clearable:""},{suffix:l(()=>[e(W,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),e(z,null,{default:l(()=>[e(E,{span:24},{default:l(()=>[e(D,{key:"id",remote:"","single-line":!1,columns:C(b),data:s.value,pagination:C(Ee)(i),"pagination-show-size-picker":!0,loading:u.value,"onUpdate:page":x,"onUpdate:pageSize":I},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),de(m.$slots,"extra",{reLoadDataTable:t})]),e(X,{modelValue:v.value,"onUpdate:modelValue":k[1]||(k[1]=O=>v.value=O),item:r.value,curriculumOptions:m.curriculumOptions,onSuccess:t},null,8,["modelValue","item","curriculumOptions"])],64)}}}),Qe=$({__name:"index",setup(_){const f=c([]),u=c(!1);return(async()=>{f.value=await ke()})(),(v,r)=>{const i=B,n=j;return S(),H(A,null,[e(n,{segmented:{header:!0,content:!0}},{header:l(()=>r[2]||(r[2]=[h("span",{class:"text-sm text-slate-500"}," Gestión de modulos académicos ",-1),h("h5",{class:"text-lg font-bold text-slate-800"},"Modulos",-1)])),"header-extra":l(()=>[e(i,{"render-icon":C(U)("additem"),onClick:r[0]||(r[0]=a=>u.value=!0)},{default:l(()=>r[3]||(r[3]=[R(" Agregar ")])),_:1},8,["render-icon"])]),_:1}),e(Ce,{curriculumOptions:f.value},{extra:l(({reLoadDataTable:a})=>[e(X,{curriculumOptions:f.value,modelValue:u.value,"onUpdate:modelValue":r[1]||(r[1]=g=>u.value=g),item:null,onSuccess:a},null,8,["curriculumOptions","modelValue","onSuccess"])]),_:1},8,["curriculumOptions"])],64)}}});export{Qe as default};
