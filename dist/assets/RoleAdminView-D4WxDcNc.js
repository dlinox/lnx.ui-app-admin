import{r as V,i as F}from"./DataTable.types-CWkwFvml.js";import{_ as K,a as Q,b as X,c as Y}from"./role.services-D8-7Agxm.js";import{d as z,a9 as E,a4 as M,a6 as n,aa as e,ah as A,ag as T,h as P,e as Z,r as _,g as ee,ae as R,ai as G,aj as ae,ak as te,al as j,ac as h,ab as k,am as ne,_ as q}from"./index-BzGjg7HW.js";import{_ as H,a as oe,b as le}from"./FormItem-Baka7rSs.js";import{N as se,_ as L,a as ie,b as W}from"./Col-B1xrStaH.js";import{_ as ue}from"./Switch-mfNYKium.js";import{u as re,_ as de}from"./composables-D42LVHns.js";import{_ as pe}from"./Dropdown-Q3lX7PM3.js";import{d as me}from"./debounce.utils-DqPPCsFD.js";import"./get-Q-alL0iz.js";import"./ChevronRight-DqgmWN6z.js";const _e=z({__name:"DataTableOp",props:{item:{}},emits:["edit","delete"],setup(l,{emit:d}){const u=re(),a=d,r=[{label:"Editar",key:"edit",icon:V("edit-2"),props:{onClick:()=>a("edit")}},{label:"Eliminar",key:"delete",icon:V("trash","red"),props:{style:{color:"red"},onClick:()=>{u.warning({title:"Confirmar",content:"¿Está seguro que desea eliminar este registro?",positiveText:"Eliminar",negativeText:"Cancelar",closable:!1,showIcon:!1,negativeButtonProps:{secondary:!0,type:"tertiary",size:"large"},positiveButtonProps:{size:"large",type:"error"},onPositiveClick:()=>{a("delete")}})}}}];return(g,s)=>{const o=T,i=pe;return E(),M(i,{options:r,placement:"bottom-start"},{default:n(()=>[e(o,null,{default:n(()=>[e(A,{"icon-name":"setting-5",size:"20"})]),_:1})]),_:1})}}}),ce=(l,d)=>[{title:"Ops.",key:"ops",width:"80px",fixed:"left",render(u){const a=u;return P(_e,{onEdit:()=>{l(a)},onDelete:()=>{d(a)},item:a},{default:()=>"Editar"})}},{title:"Nombre",key:"name",minWidth:"300px"},{title:"Habilitado",key:"isEnabled",width:"150px",render:u=>P(se,{type:u.isEnabled?"success":"error",tertiary:!0,bordered:!1,strong:!0},{default:()=>u.isEnabled?"	Habilitado":"Deshabilitado"})}],ge=(l=F())=>({page:l.page,total:l.total,pageSize:l.pageSize,pageCount:l.pageCount,showSizePicker:!0,pageSizes:[10,50,100,500,1e3,5e3],style:{paddingRight:"16px",paddingBottom:"12px"},prefix(){return`Total ${l.total} registros`}}),O=l=>({id:null,name:null,level:l,isEnabled:!0}),fe=()=>({name:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}]}),J=z({__name:"RoleForm",props:{item:{},level:{},modelValue:{type:Boolean}},emits:["update:modelValue","success"],setup(l,{emit:d}){const u=d,a=l,r=Z({get:()=>a.modelValue,set:p=>u("update:modelValue",p)}),g=_(!1),s=_(null),o=_(O(a.level)),i=_(null),$=_({...fe()}),B=async()=>{if(s.value){const p=await s.value.validate();let t=null;p?(g.value=!0,o.value.id?t=await K(o.value):t=await Q(o.value),t.status?(u("success"),r.value=!1):i.value=t.data):console.log("Formulario inválido")}g.value=!1},C=()=>{console.log("Inicializando formulario"),o.value=a.item?{...a.item}:O(a.level)};return ee(r,p=>{p&&(i.value=null,C())}),(p,t)=>{const I=H,b=oe,w=L,D=ue,m=ie,f=W,v=le,y=T,x=G,S=ae;return E(),M(S,{show:r.value,"onUpdate:show":t[4]||(t[4]=c=>r.value=c)},{default:n(()=>[e(x,{style:{width:"500px"},title:p.item?"EDITAR REGISTRO":"NUEVO REGISTRO",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:n(()=>[e(m,{justify:"end"},{default:n(()=>[e(y,{tertiary:"",size:"large",onClick:t[3]||(t[3]=c=>r.value=!1),disabled:g.value},{default:n(()=>t[5]||(t[5]=[R(" Cancelar ")])),_:1},8,["disabled"]),e(y,{size:"large",type:"primary",onClick:B,loading:g.value},{default:n(()=>t[6]||(t[6]=[R("Guardar")])),_:1},8,["loading"])]),_:1})]),default:n(()=>[e(v,{ref_key:"formRef",ref:s,model:o.value,rules:$.value,size:"large"},{default:n(()=>[e(f,null,{default:n(()=>[e(w,{span:"24"},{default:n(()=>{var c;return[e(b,{path:"name",label:"Nombre",feedback:(c=i.value)==null?void 0:c.name},{default:n(()=>{var U;return[e(I,{status:((U=i.value)==null?void 0:U.name)!=null?"error":"",value:o.value.name,"onUpdate:value":t[0]||(t[0]=N=>o.value.name=N),onInput:t[1]||(t[1]=N=>i.value!=null?i.value.name=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1}),e(w,{span:"24"},{default:n(()=>[e(m,{justify:"end"},{default:n(()=>[e(b,{"label-placement":"left",label:"¿Habilitado?",path:"isEnabled","show-feedback":!1},{default:n(()=>[e(D,{value:o.value.isEnabled,"onUpdate:value":t[2]||(t[2]=c=>o.value.isEnabled=c)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),ve={style:{"border-bottom":"1px solid #e9e9e9"}},be=z({__name:"DataTable",props:{level:{}},setup(l){const d=l,u=_(!1),a=_([]),r=_(!1),g=_(null),s=te({...F()}),o=_({search:null,page:s.page,pageSize:s.pageSize}),i=_({}),C=ce(m=>{g.value=m,r.value=!0},async m=>{await Y(m),await p()}),p=async()=>{o.value.page=1,await t()},t=async()=>{u.value=!0,i.value=await X(o.value),a.value=i.value.data,s.total=i.value.total,s.pageSize=i.value.per_page,s.page=i.value.current_page,s.pageCount=i.value.last_page,u.value=!1},I=me(()=>{p()},400),b=async m=>{o.value.page=m,await t()},w=async m=>{o.value.page=1,o.value.pageSize=m,await t()};return(async()=>{o.value.filters={level:d.level},await t()})(),(m,f)=>{const v=L,y=H,x=W,S=de;return E(),j(q,null,[h("div",ve,[e(x,{gutter:12,style:{padding:"12px 16px"}},{default:n(()=>[e(v,{span:12}),e(v,{span:12},{default:n(()=>[e(y,{size:"large",placeholder:"Buscar",value:o.value.search,"onUpdate:value":f[0]||(f[0]=c=>o.value.search=c),onInput:k(I),clearable:""},{suffix:n(()=>[e(A,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),e(x,null,{default:n(()=>[e(v,{span:24},{default:n(()=>[e(S,{key:"id",remote:"","single-line":!1,columns:k(C),data:a.value,pagination:k(ge)(s),"pagination-show-size-picker":!0,loading:u.value,"onUpdate:page":b,"onUpdate:pageSize":w},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),ne(m.$slots,"extra",{reLoadDataTable:p})]),e(J,{modelValue:r.value,"onUpdate:modelValue":f[1]||(f[1]=c=>r.value=c),item:g.value,level:d.level,onSuccess:p},null,8,["modelValue","item","level"])],64)}}}),he=z({__name:"RoleAdminView",setup(l){const d=_(!1);return(u,a)=>{const r=T,g=G;return E(),j(q,null,[e(g,{segmented:{header:!0,content:!0}},{header:n(()=>a[2]||(a[2]=[h("span",{class:"text-sm text-slate-500"}," Gestion de roles de administrador ",-1),h("h5",{class:"text-lg font-bold text-slate-800"},"Roles de Administrador",-1)])),"header-extra":n(()=>[e(r,{"render-icon":k(V)("additem"),onClick:a[0]||(a[0]=s=>d.value=!0)},{default:n(()=>a[3]||(a[3]=[R(" Agregar ")])),_:1},8,["render-icon"])]),_:1}),e(be,{level:"admin"},{extra:n(({reLoadDataTable:s})=>[e(J,{modelValue:d.value,"onUpdate:modelValue":a[1]||(a[1]=o=>d.value=o),item:null,onSuccess:s,level:"admin"},null,8,["modelValue","onSuccess"])]),_:1})],64)}}});export{he as default};
