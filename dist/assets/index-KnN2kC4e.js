import{r as J}from"./icon.utils-_VQD1LzU.js";import{d as B,e as K,r,j as Q,a9 as U,aa as z,ab as a,ac as e,aB as G,ae as c,ag as A,aA as $,aI as W,aJ as X,aG as P,_ as F,af as N,aK as Y,aH as Z,a3 as h,a6 as ee,ad as ae,aM as te}from"./index-B4HM4eEq.js";import{_ as D,a as ne,G as oe,b as le,c as se,d as ue,e as re,f as ie,g as me}from"./curriculum.services-B1q5EuJe.js";import{_ as de,a as pe}from"./FormItem-cRsh-SHk.js";import{_ as O,a as j}from"./Col-CBFn7CGp.js";import{_ as H}from"./Input-Blyfr7bU.js";import{_ as _e}from"./Select-lU1ug5AA.js";import{_ as ce}from"./Space-DsuPZ34i.js";import{_ as fe}from"./Switch-BouS8iVV.js";import{i as ve}from"./DataTable.types-BEg5m_To.js";import{d as ge}from"./debounce.utils-DqPPCsFD.js";import{_ as be}from"./DataTable-DxdGd7cD.js";import"./ButtonGroup-gIOyFsEC.js";import"./composables-CnPINYM7.js";import"./Dropdown-CtyOND1F.js";import"./Popover-V6QhFDvP.js";import"./get-ClpdtJHT.js";import"./use-merged-state-D3q23DVU.js";import"./Tag-C7q16pA0.js";import"./Suffix-CO3cYY28.js";import"./Tooltip-BuNmYRWT.js";const L=B({__name:"CurriculumForm",props:{item:{},modelValue:{type:Boolean}},emits:["update:modelValue","success"],setup(R,{emit:_}){const f=_,i=R,p=K({get:()=>i.modelValue,set:u=>f("update:modelValue",u)}),t=r(!1),l=r(null),o=r(D()),s=r(null),v=r({...ne()}),y=async()=>{if(l.value){const u=await l.value.validate();let n=null;u?(t.value=!0,o.value.id?n=await le(o.value):n=await se(o.value),n.status?(f("success"),p.value=!1):s.value=n.data):console.log("Formulario inválido")}t.value=!1},g=()=>{console.log("Inicializando formulario"),o.value=i.item?{...i.item}:D()};return Q(p,u=>{u&&g()}),(u,n)=>{const T=H,k=pe,V=j,m=_e,b=fe,w=ce,E=O,M=de,S=A,C=G,q=W;return z(),U(q,{show:p.value,"onUpdate:show":n[6]||(n[6]=d=>p.value=d)},{default:a(()=>[e(C,{style:{width:"500px"},title:u.item?"EDITAR REGISTRO":"NUEVO REGISTRO",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:a(()=>[e(w,{justify:"end"},{default:a(()=>[e(S,{tertiary:"",size:"large",onClick:n[5]||(n[5]=d=>p.value=!1),disabled:t.value},{default:a(()=>n[7]||(n[7]=[$(" Cancelar ")])),_:1},8,["disabled"]),e(S,{size:"large",type:"primary",onClick:y,loading:t.value},{default:a(()=>n[8]||(n[8]=[$("Guardar")])),_:1},8,["loading"])]),_:1})]),default:a(()=>[e(M,{ref_key:"formRef",ref:l,model:o.value,rules:v.value,size:"large"},{default:a(()=>[e(E,null,{default:a(()=>[e(V,{span:"24"},{default:a(()=>{var d;return[e(k,{path:"name",label:"Nombre",feedback:(d=s.value)==null?void 0:d.name},{default:a(()=>{var I;return[e(T,{value:o.value.name,"onUpdate:value":n[0]||(n[0]=x=>o.value.name=x),status:((I=s.value)==null?void 0:I.name)!=null?"error":"",onInput:n[1]||(n[1]=x=>s.value!=null?s.value.name=null:()=>{})},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1}),e(V,{span:"24"},{default:a(()=>{var d;return[e(k,{path:"gradingModel",label:"Modelo de calificación",feedback:(d=s.value)==null?void 0:d.gradingModel},{default:a(()=>{var I;return[e(m,{value:o.value.gradingModel,"onUpdate:value":[n[2]||(n[2]=x=>o.value.gradingModel=x),n[3]||(n[3]=x=>s.value!=null?s.value.gradingModel=null:()=>{})],options:c(oe),"virtual-scroll":!1,status:((I=s.value)==null?void 0:I.gradingModel)!=null?"error":""},null,8,["value","options","status"])]}),_:1},8,["feedback"])]}),_:1}),e(V,{span:"24"},{default:a(()=>[e(w,{justify:"end"},{default:a(()=>[e(k,{"label-placement":"left",label:"¿Habilitado?",path:"isEnabled","show-feedback":!1},{default:a(()=>[e(b,{value:o.value.isEnabled,"onUpdate:value":n[4]||(n[4]=d=>o.value.isEnabled=d)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),we={style:{"border-bottom":"1px solid #e9e9e9"}},ye=B({__name:"DataTable",setup(R){const _=r(!1),f=r([]),i=r(!1),p=r(null),t=X({...ve()}),l=r({search:null,page:t.page,pageSize:t.pageSize}),o=r({}),y=re(m=>{p.value=m,i.value=!0},async m=>{await me(m),await g()}),g=async()=>{l.value.page=1,await u()},u=async()=>{_.value=!0,o.value=await ie(l.value),f.value=o.value.data,t.total=o.value.total,t.pageSize=o.value.per_page,t.page=o.value.current_page,t.pageCount=o.value.last_page,_.value=!1},n=ge(()=>{g()},400),T=async m=>{l.value.page=m,await u()},k=async m=>{l.value.page=1,l.value.pageSize=m,await u()};return(async()=>{await u()})(),(m,b)=>{const w=j,E=H,M=O,S=be;return z(),P(F,null,[N("div",we,[e(M,{gutter:12,style:{padding:"12px 16px"}},{default:a(()=>[e(w,{span:12}),e(w,{span:12},{default:a(()=>[e(E,{size:"large",placeholder:"Buscar",value:l.value.search,"onUpdate:value":b[0]||(b[0]=C=>l.value.search=C),onInput:c(n),clearable:""},{suffix:a(()=>[e(Z,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),e(M,null,{default:a(()=>[e(w,{span:24},{default:a(()=>[e(S,{key:"id",remote:"",size:"small","single-line":!1,columns:c(y),data:f.value,pagination:c(ue)(t),"pagination-show-size-picker":!0,loading:_.value,"onUpdate:page":T,"onUpdate:pageSize":k},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),Y(m.$slots,"extra",{reLoadDataTable:g})]),e(L,{modelValue:i.value,"onUpdate:modelValue":b[1]||(b[1]=C=>i.value=C),item:p.value,onSuccess:g},null,8,["modelValue","item"])],64)}}}),je=B({__name:"index",setup(R){const{hasPermission:_}=h(),f=ee(),i=r(!1);return(p,t)=>{const l=A,o=G,s=te;return c(_)(["curriculum.create","curriculum.edit","curriculum.delete"])?(z(),P(F,{key:0},[e(o,{segmented:{header:!0,content:!0}},{header:a(()=>t[3]||(t[3]=[N("span",{class:"text-sm text-slate-500"}," Gestión Curricular ",-1),N("h5",{class:"text-lg font-bold text-slate-800"},"Curriculo",-1)])),"header-extra":a(()=>[c(_)(["curriculum.create"])?(z(),U(l,{key:0,size:"large",type:"primary","render-icon":c(J)("additem"),onClick:t[0]||(t[0]=v=>i.value=!0)},{default:a(()=>t[4]||(t[4]=[$(" Agregar ")])),_:1},8,["render-icon"])):ae("",!0)]),_:1}),e(ye,null,{extra:a(({reLoadDataTable:v})=>[e(L,{modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=y=>i.value=y),item:null,onSuccess:v},null,8,["modelValue","onSuccess"])]),_:1})],64)):(z(),U(s,{key:1,status:"403",title:"403 No Autorizado",description:"Algunas puertas siempre están cerradas para ti."},{footer:a(()=>[e(l,{onClick:t[2]||(t[2]=v=>c(f).push("/"))},{default:a(()=>t[5]||(t[5]=[$(" Ir a casa ")])),_:1})]),_:1}))}}});export{je as default};
