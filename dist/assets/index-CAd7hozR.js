import{r as $}from"./icon.utils-6fJ-3dCS.js";import{d as V,a8 as C,a9 as R,aa as a,ab as e,af as B,aG as G,h as P,ay as Z,e as F,r as v,j as ee,aA as H,ac as te,ad as I,az as A,aH as ae,aI as ne,aF as M,_ as j,ae as U,aJ as oe}from"./index-DRqPu8js.js";import{i as Y,a as le}from"./DataTable.types-BEg5m_To.js";import{_ as se,a as re}from"./FormItem-B0e_KJJq.js";import{_ as J,a as W}from"./Col-CNgfr2Vq.js";import{_ as K}from"./Input-PHuG5EIV.js";import{_ as ue}from"./Select-Bhk-Lp7D.js";import{_ as ie}from"./Space-DpUkt9IF.js";import{_ as pe}from"./Switch-C8iQr2Sc.js";import{u as de}from"./composables-CNUmupj0.js";import{_ as me}from"./Dropdown-hwViG8Gw.js";import{_ as _e}from"./Tag-DIW11yL8.js";import{d as ce}from"./debounce.utils-DqPPCsFD.js";import{_ as ve}from"./DataTable-B0gpVXZr.js";import"./get-CdE2f0gc.js";import"./Suffix-DbP13eKO.js";import"./use-merged-state-dfDog2av.js";import"./Popover-DfaujfXt.js";import"./Tooltip-lejxWDdy.js";const fe=V({__name:"DataTableOp",props:{item:{}},emits:["edit","delete"],setup(l,{emit:s}){const p=de(),o=s,m=[{label:"Editar",key:"edit",icon:$("edit-2"),props:{onClick:()=>o("edit")}},{label:"Eliminar",key:"delete",icon:$("trash","red"),props:{style:{color:"red"},onClick:()=>{p.warning({title:"Confirmar",content:"¿Está seguro que desea eliminar este registro?",positiveText:"Eliminar",negativeText:"Cancelar",closable:!1,showIcon:!1,negativeButtonProps:{secondary:!0,type:"tertiary",size:"large"},positiveButtonProps:{size:"large",type:"error"},onPositiveClick:()=>{o("delete")}})}}}];return(u,i)=>{const n=B,r=me;return R(),C(r,{options:m,placement:"bottom-start"},{default:a(()=>[e(n,null,{default:a(()=>[e(G,{"icon-name":"setting-5",size:"20"})]),_:1})]),_:1})}}}),ge=(l,s)=>[{title:"Ops.",key:"ops",width:"80px",fixed:"left",render(p){const o=p;return P(fe,{onEdit:()=>{l(o)},onDelete:()=>{s(o)},item:o},{default:()=>"Editar"})}},{title:"Nombre",key:"name",minWidth:"300px"},{title:"Tipo",key:"type"},{title:"Habilitado",key:"isEnabled",width:"150px",render:p=>P(_e,{type:p.isEnabled?"success":"error",tertiary:!0,bordered:!1,strong:!0},{default:()=>p.isEnabled?"	Habilitado":"Deshabilitado"})}],be=(l=Y())=>({page:l.page,total:l.total,pageSize:l.pageSize,pageCount:l.pageCount,showSizePicker:!0,pageSizes:[10,50,100,500,1e3,5e3],style:{paddingRight:"16px",paddingBottom:"12px"},prefix(){return`Total ${l.total} registros`}}),ye=[{label:"LABORATORIO",value:"LABORATORIO"},{label:"VIRTUAL",value:"VIRTUAL"}],q=()=>({id:null,name:null,type:"LABORATORIO",virtualLink:null,isEnabled:!0}),ke=l=>({name:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}],type:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}],virtualLink:[{required:l.type==="VIRTUAL",trigger:["blur","input"],message:"Obligatorio"},{type:"url",trigger:["blur","input"],message:"No es un link valido"}]}),h="/laboratory",D=Z(),we=async l=>{try{return(await D.post(`${h}/load-data-table`,l)).data.data}catch{return le()}},Te=async l=>{try{return{status:!0,data:(await D.post(`${h}/save`,l)).data.data}}catch(s){return s.response.status===422?{status:!1,data:s.response.data.errors}:{status:!1,data:null}}},xe=async l=>{try{return await D.delete(`${h}`,{data:{id:l.id}}),!0}catch{return!1}},Q=V({__name:"LaboratoryForm",props:{item:{},modelValue:{type:Boolean}},emits:["update:modelValue","success"],setup(l,{emit:s}){const p=s,o=l,m=F({get:()=>o.modelValue,set:_=>p("update:modelValue",_)}),u=v(!1),i=v(null),n=v(q()),r=v(null),N=F(()=>ke(n.value)),S=async()=>{if(i.value){const _=await i.value.validate();let t=null;_?(u.value=!0,t=await Te(n.value),t.status?(p("success"),m.value=!1):r.value=t.data):console.log("Formulario inválido")}u.value=!1},b=()=>{console.log("Inicializando formulario"),n.value=o.item?{...o.item}:q()};return ee(m,_=>{_&&b()}),(_,t)=>{const L=K,y=re,T=W,c=ue,k=pe,w=ie,O=J,z=se,E=B,x=H,X=ae;return R(),C(X,{show:m.value,"onUpdate:show":t[8]||(t[8]=d=>m.value=d)},{default:a(()=>[e(x,{style:{width:"500px"},title:_.item?"EDITAR REGISTRO":"NUEVO REGISTRO",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:a(()=>[e(w,{justify:"end"},{default:a(()=>[e(E,{tertiary:"",size:"large",onClick:t[7]||(t[7]=d=>m.value=!1),disabled:u.value},{default:a(()=>t[9]||(t[9]=[A(" Cancelar ")])),_:1},8,["disabled"]),e(E,{size:"large",type:"primary",onClick:S,loading:u.value},{default:a(()=>t[10]||(t[10]=[A(" Guardar ")])),_:1},8,["loading"])]),_:1})]),default:a(()=>[e(z,{ref_key:"formRef",ref:i,model:n.value,rules:N.value,size:"large"},{default:a(()=>[e(O,null,{default:a(()=>[e(T,{span:"24"},{default:a(()=>{var d;return[e(y,{path:"name",label:"Nombre",feedback:(d=r.value)==null?void 0:d.name},{default:a(()=>{var f;return[e(L,{status:((f=r.value)==null?void 0:f.name)!=null?"error":"",value:n.value.name,"onUpdate:value":t[0]||(t[0]=g=>n.value.name=g),onInput:t[1]||(t[1]=g=>r.value!=null?r.value.name=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1}),e(T,{span:"24"},{default:a(()=>{var d;return[e(y,{path:"type",label:"Tipo de laboratorio",feedback:(d=r.value)==null?void 0:d.type},{default:a(()=>{var f;return[e(c,{status:((f=r.value)==null?void 0:f.type)!=null?"error":"",value:n.value.type,"onUpdate:value":t[2]||(t[2]=g=>n.value.type=g),onInput:t[3]||(t[3]=g=>r.value!=null?r.value.type=null:()=>{}),options:I(ye),placeholder:"Seleccione un tipo de laboratorio"},null,8,["status","value","options"])]}),_:1},8,["feedback"])]}),_:1}),n.value.type==="VIRTUAL"?(R(),C(T,{key:0,span:"24"},{default:a(()=>{var d;return[e(y,{path:"virtualLink",label:"Enlace virtual",feedback:(d=r.value)==null?void 0:d.virtualLink},{default:a(()=>{var f;return[e(L,{status:((f=r.value)==null?void 0:f.virtualLink)!=null?"error":"",value:n.value.virtualLink,"onUpdate:value":t[4]||(t[4]=g=>n.value.virtualLink=g),onInput:t[5]||(t[5]=g=>r.value!=null?r.value.virtualLink=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1})):te("",!0),e(T,{span:"24"},{default:a(()=>[e(w,{justify:"end"},{default:a(()=>[e(y,{"label-placement":"left",label:"¿Habilitado?",path:"isEnabled","show-feedback":!1},{default:a(()=>[e(k,{value:n.value.isEnabled,"onUpdate:value":t[6]||(t[6]=d=>n.value.isEnabled=d)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),Ie={style:{"border-bottom":"1px solid #e9e9e9"}},Re=V({__name:"DataTable",setup(l){const s=v(!1),p=v([]),o=v(!1),m=v(null),u=ne({...Y()}),i=v({search:null,page:u.page,pageSize:u.pageSize}),n=v({}),S=ge(c=>{m.value=c,o.value=!0},async c=>{await xe(c),await b()}),b=async()=>{i.value.page=1,await _()},_=async()=>{s.value=!0,n.value=await we(i.value),p.value=n.value.data,u.total=n.value.total,u.pageSize=n.value.per_page,u.page=n.value.current_page,u.pageCount=n.value.last_page,s.value=!1},t=ce(()=>{b()},400),L=async c=>{i.value.page=c,await _()},y=async c=>{i.value.page=1,i.value.pageSize=c,await _()};return(async()=>{await _()})(),(c,k)=>{const w=W,O=K,z=J,E=ve;return R(),M(j,null,[U("div",Ie,[e(z,{gutter:12,style:{padding:"12px 16px"}},{default:a(()=>[e(w,{span:12}),e(w,{span:12},{default:a(()=>[e(O,{size:"large",placeholder:"Buscar",value:i.value.search,"onUpdate:value":k[0]||(k[0]=x=>i.value.search=x),onInput:I(t),clearable:""},{suffix:a(()=>[e(G,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),e(z,null,{default:a(()=>[e(w,{span:24},{default:a(()=>[e(E,{key:"id",remote:"","single-line":!1,columns:I(S),data:p.value,pagination:I(be)(u),"pagination-show-size-picker":!0,loading:s.value,"onUpdate:page":L,"onUpdate:pageSize":y},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),oe(c.$slots,"extra",{reLoadDataTable:b})]),e(Q,{modelValue:o.value,"onUpdate:modelValue":k[1]||(k[1]=x=>o.value=x),item:m.value,onSuccess:b},null,8,["modelValue","item"])],64)}}}),Me=V({__name:"index",setup(l){const s=v(!1);return(p,o)=>{const m=B,u=H;return R(),M(j,null,[e(u,{segmented:{header:!0,content:!0}},{header:a(()=>o[2]||(o[2]=[U("span",{class:"text-sm text-slate-500"}," Gestión de Laboratorios ",-1),U("h5",{class:"text-lg font-bold text-slate-800"},"Laboratorios",-1)])),"header-extra":a(()=>[e(m,{"render-icon":I($)("additem"),onClick:o[0]||(o[0]=i=>s.value=!0)},{default:a(()=>o[3]||(o[3]=[A(" Agregar ")])),_:1},8,["render-icon"])]),_:1}),e(Re,null,{extra:a(({reLoadDataTable:i})=>[e(Q,{modelValue:s.value,"onUpdate:modelValue":o[1]||(o[1]=n=>s.value=n),item:null,onSuccess:i},null,8,["modelValue","onSuccess"])]),_:1})],64)}}});export{Me as default};
