import{r as R}from"./icon.utils-upfZx_ME.js";import{d as T,a8 as H,a9 as $,aa as t,ab as e,af as P,aG as M,h as N,ay as Y,e as Z,r as _,j as ee,aA as q,az as B,aH as te,aI as ae,aF as A,_ as j,ae as D,aJ as ne,ad as C}from"./index-C2oNslvg.js";import{i as L,a as oe}from"./DataTable.types-BEg5m_To.js";import{_ as se}from"./InputNumber-CH5ypLym.js";import{_ as le,a as re}from"./FormItem-DXyfdPQq.js";import{_ as J,a as W}from"./Col-BtUCTmqt.js";import{_ as K}from"./Input-BQ3poveX.js";import{_ as ie}from"./Space-G3ZiPI5e.js";import{_ as ue}from"./Switch-6rDtgWDf.js";import{d as pe}from"./debounce.utils-DqPPCsFD.js";import{u as me}from"./composables-CkauXcFl.js";import{_ as de}from"./Dropdown-tA5u1ub_.js";import{_ as _e}from"./Tag-Dwx6Rgco.js";import{_ as ce}from"./DataTable-ByPH7O8r.js";import"./Suffix-DF6h_xjA.js";import"./use-merged-state-CDxsXcm8.js";import"./get-2__u8Ul3.js";import"./Popover-C-qVBvl0.js";import"./Tooltip-DX3_NcDh.js";import"./Select-DaUiqjpd.js";const fe=T({__name:"DataTableOp",props:{item:{}},emits:["edit","delete"],setup(l,{emit:o}){const u=me(),n=o,p=[{label:"Editar",key:"edit",icon:R("edit-2"),props:{onClick:()=>n("edit")}},{label:"Eliminar",key:"delete",icon:R("trash","red"),props:{style:{color:"red"},onClick:()=>{u.warning({title:"Confirmar",content:"¿Está seguro que desea eliminar este registro?",positiveText:"Eliminar",negativeText:"Cancelar",closable:!1,showIcon:!1,negativeButtonProps:{secondary:!0,type:"tertiary",size:"large"},positiveButtonProps:{size:"large",type:"error"},onPositiveClick:()=>{n("delete")}})}}}];return(r,i)=>{const s=P,m=de;return $(),H(m,{options:p,placement:"bottom-start"},{default:t(()=>[e(s,null,{default:t(()=>[e(M,{"icon-name":"setting-5",size:"20"})]),_:1})]),_:1})}}}),ge=(l,o)=>[{title:"Ops.",key:"ops",width:"80px",fixed:"left",render(u){const n=u;return N(fe,{onEdit:()=>{l(n)},onDelete:()=>{o(n)},item:n},{default:()=>"Editar"})}},{title:"Nombre",key:"name",minWidth:"300px"},{title:"Comisión (S/.)",key:"commission",width:"120px",align:"right"},{title:"Habilitado",key:"isEnabled",width:"150px",render:u=>N(_e,{type:u.isEnabled?"success":"error",tertiary:!0,bordered:!1,strong:!0},{default:()=>u.isEnabled?"	Habilitado":"Deshabilitado"})}],ve=(l=L())=>({page:l.page,total:l.total,pageSize:l.pageSize,pageCount:l.pageCount,showSizePicker:!0,pageSizes:[10,50,100,500,1e3,5e3],style:{paddingRight:"16px",paddingBottom:"12px"},prefix(){return`Total ${l.total} registros`}}),G=()=>({id:null,name:null,commission:0,isEnabled:!0}),be=()=>({name:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}],commission:[{type:"number",required:!0,trigger:["blur","input"],message:"Obligatorio"}]}),U=Y(),O="/payment-type",ye=async l=>{try{return(await U.post(`${O}/load-data-table`,l)).data.data}catch{return oe()}},we=async l=>{try{return{status:!0,data:(await U.post(`${O}/save`,l)).data.data}}catch(o){return o.response.status===422?{status:!1,data:o.response.data.errors}:{status:!1,data:null}}},xe=async l=>{try{return await U.delete(`${O}`,{data:{id:l.id}}),!0}catch{return!1}},Q=T({__name:"PaymentTypeForm",props:{item:{},modelValue:{type:Boolean}},emits:["update:modelValue","success"],setup(l,{emit:o}){const u=o,n=l,p=Z({get:()=>n.modelValue,set:d=>u("update:modelValue",d)}),r=_(!1),i=_(null),s=_(G()),m=_(null),F=_({...be()}),h=async()=>{if(i.value){const d=await i.value.validate();let a=null;d?(r.value=!0,a=await we(s.value),a.status?(u("success"),p.value=!1):m.value=a.data):console.log("Formulario inválido")}r.value=!1},g=()=>{s.value=n.item?{...n.item}:G()};return ee(p,d=>{d&&g()}),(d,a)=>{const I=K,y=re,z=W,c=se,v=ue,b=ie,V=J,E=le,S=P,w=q,X=te;return $(),H(X,{show:p.value,"onUpdate:show":a[6]||(a[6]=f=>p.value=f)},{default:t(()=>[e(w,{style:{width:"500px"},title:d.item?"EDITAR REGISTRO":"NUEVO REGISTRO",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:t(()=>[e(b,{justify:"end"},{default:t(()=>[e(S,{tertiary:"",size:"large",onClick:a[5]||(a[5]=f=>p.value=!1),disabled:r.value},{default:t(()=>a[7]||(a[7]=[B(" Cancelar ")])),_:1},8,["disabled"]),e(S,{size:"large",type:"primary",onClick:h,loading:r.value},{default:t(()=>a[8]||(a[8]=[B("Guardar")])),_:1},8,["loading"])]),_:1})]),default:t(()=>[e(E,{ref_key:"formRef",ref:i,model:s.value,rules:F.value,size:"large"},{default:t(()=>[e(V,null,{default:t(()=>[e(z,{span:"24"},{default:t(()=>{var f;return[e(y,{path:"name",label:"Nombre",feedback:(f=m.value)==null?void 0:f.name},{default:t(()=>{var x;return[e(I,{status:((x=m.value)==null?void 0:x.name)!=null?"error":"",value:s.value.name,"onUpdate:value":a[0]||(a[0]=k=>s.value.name=k),onInput:a[1]||(a[1]=k=>m.value!=null?m.value.name=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1}),e(z,{span:"24"},{default:t(()=>{var f;return[e(y,{path:"commission",label:"Comisión (S/.)",feedback:(f=m.value)==null?void 0:f.commission},{default:t(()=>{var x;return[e(c,{class:"w-full",min:0,status:((x=m.value)==null?void 0:x.commission)!=null?"error":"",value:s.value.commission,"onUpdate:value":a[2]||(a[2]=k=>s.value.commission=k),onInput:a[3]||(a[3]=k=>m.value!=null?m.value.commission=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1}),e(z,{span:"24"},{default:t(()=>[e(b,{justify:"end"},{default:t(()=>[e(y,{"label-placement":"left",label:"¿Habilitado?",path:"isEnabled","show-feedback":!1},{default:t(()=>[e(v,{value:s.value.isEnabled,"onUpdate:value":a[4]||(a[4]=f=>s.value.isEnabled=f)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),ke={style:{"border-bottom":"1px solid #e9e9e9"}},ze=T({__name:"DataTable",setup(l){const o=_(!1),u=_([]),n=_(!1),p=_(null),r=ae({...L()}),i=_({search:null,page:r.page,pageSize:r.pageSize}),s=_({}),h=ge(c=>{p.value=c,n.value=!0},async c=>{await xe(c),await g()}),g=async()=>{i.value.page=1,await d()},d=async()=>{o.value=!0,s.value=await ye(i.value),u.value=s.value.data,r.total=s.value.total,r.pageSize=s.value.per_page,r.page=s.value.current_page,r.pageCount=s.value.last_page,o.value=!1},a=pe(()=>{g()},400),I=async c=>{i.value.page=c,await d()},y=async c=>{i.value.page=1,i.value.pageSize=c,await d()};return(async()=>{await d()})(),(c,v)=>{const b=W,V=K,E=J,S=ce;return $(),A(j,null,[D("div",ke,[e(E,{gutter:12,style:{padding:"12px 16px"}},{default:t(()=>[e(b,{span:12}),e(b,{span:12},{default:t(()=>[e(V,{size:"large",placeholder:"Buscar",value:i.value.search,"onUpdate:value":v[0]||(v[0]=w=>i.value.search=w),onInput:C(a),clearable:""},{suffix:t(()=>[e(M,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),e(E,null,{default:t(()=>[e(b,{span:24},{default:t(()=>[e(S,{key:"id",remote:"","single-line":!1,columns:C(h),data:u.value,pagination:C(ve)(r),"pagination-show-size-picker":!0,loading:o.value,"onUpdate:page":I,"onUpdate:pageSize":y},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),ne(c.$slots,"extra",{reLoadDataTable:g})]),e(Q,{modelValue:n.value,"onUpdate:modelValue":v[1]||(v[1]=w=>n.value=w),item:p.value,onSuccess:g},null,8,["modelValue","item"])],64)}}}),Ae=T({__name:"index",setup(l){const o=_(!1);return(u,n)=>{const p=P,r=q;return $(),A(j,null,[e(r,{segmented:{header:!0,content:!0}},{header:t(()=>n[2]||(n[2]=[D("span",{class:"text-sm text-slate-500"}," Gestionar los tipos de pago ",-1),D("h5",{class:"text-lg font-bold text-slate-800"},"Tipos de pago",-1)])),"header-extra":t(()=>[e(p,{"render-icon":C(R)("additem"),onClick:n[0]||(n[0]=i=>o.value=!0)},{default:t(()=>n[3]||(n[3]=[B(" Agregar ")])),_:1},8,["render-icon"])]),_:1}),e(ze,null,{extra:t(({reLoadDataTable:i})=>[e(Q,{modelValue:o.value,"onUpdate:modelValue":n[1]||(n[1]=s=>o.value=s),item:null,onSuccess:i},null,8,["modelValue","onSuccess"])]),_:1})],64)}}});export{Ae as default};
