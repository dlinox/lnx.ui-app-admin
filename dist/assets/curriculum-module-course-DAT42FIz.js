import{b as X,r as Y}from"./LnxIcon.vue_vue_type_script_setup_true_lang-TYfemrMA.js";import{b as ee,f as ae}from"./curriculumModule.services-utY4yJPb.js";import{d as B,e as te,r as _,g as le,a3 as ue,a4 as u,ae as se,i as ne,a7 as E,a8 as a,ab as z,a9 as b,ad as j,af as G,ag as oe,ah as N,ai as O,aj as re,Z as H,a5 as A,p as de,ac as F}from"./index-DJ1jHABu.js";import{j as U,k as ie,a as ce,b as L,_ as Z,l as pe,c as me,d as ve,e as J,f as _e,i as fe,g as ge,h as be}from"./debounce.utils-JXFV_6GD.js";import{g as x,h as ye,b as Ie,i as we}from"./form.configs-CYATX8Jp.js";import{u as ke}from"./useBreakpoints-B0funUYl.js";import{d as Ce,e as Re}from"./course.services-D8b7LfFU.js";const Ve=async(p,o)=>{try{return p.id=o,(await U().post("/curriculum/module/course/load-data-table",p)).data.data}catch{return ie()}},Te=async p=>{try{return{status:!0,data:(await U().post("/curriculum/module/course",p)).data.data}}catch(o){return o.response.status===422?{status:!1,data:o.response.data.errors}:{status:!1,data:null}}},he=async p=>{try{return{status:!0,data:(await U().put("/curriculum/module/course",p)).data.data}}catch(o){return o.response.status===422?{status:!1,data:o.response.data.errors}:{status:!1,data:null}}},Se=async p=>{try{return await U().delete("/curriculum/module/course",{data:{id:p.id}}),!0}catch{return!1}},$e=async p=>{try{return(await U().get(`/curriculum/module/course/get-item-by-id/${p}`)).data.data}catch{return x()}},K=B({__name:"CurriculumModuleCourseForm",props:{item:{},modelValue:{type:Boolean},selectables:{}},emits:["update:modelValue","success"],setup(p,{emit:o}){const{screenSize:c}=ke(),I=ne("curriculumModule"),k=o,y=p,s=te({get:()=>y.modelValue,set:v=>k("update:modelValue",v)}),m=_(!1),f=_(null),t=_(x()),l=_(null),C=_({...ye()}),M=async()=>{if(f.value){const v=await f.value.validate();let e=null;v?(m.value=!0,t.value.curriculumModuleId=I.value.id,t.value.id?e=await he(t.value):e=await Te(t.value),e.status?(k("success"),s.value=!1):l.value=e.data):console.log("Formulario inválido")}m.value=!1},R=async()=>{var v;(v=y.item)!=null&&v.id?t.value=await $e(y.item.id):t.value=x()},V=async()=>{await R(),t.value.curriculumModuleId=I.value.id};return le(s,v=>{v&&V()}),(v,e)=>{const T=ee,w=ce,r=L,g=Z,h=pe,P=me,S=ve,q=J,$=_e,D=j,Q=G,W=se;return E(),ue(W,{show:s.value,"onUpdate:show":e[16]||(e[16]=n=>s.value=n)},{default:u(()=>[a(Q,{style:{width:"800px"},title:v.item?"EDITAR REGISTRO":"NUEVO REGISTRO",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:u(()=>[a(S,{justify:"end"},{default:u(()=>[a(D,{tertiary:"",size:"large",onClick:e[15]||(e[15]=n=>s.value=!1),disabled:m.value},{default:u(()=>e[17]||(e[17]=[z(" Cancelar ")])),_:1},8,["disabled"]),a(D,{size:"large",type:"primary",onClick:M,loading:m.value},{default:u(()=>e[18]||(e[18]=[z("Guardar")])),_:1},8,["loading"])]),_:1})]),default:u(()=>[a($,{ref_key:"formRef",ref:f,model:t.value,rules:C.value,size:"large"},{default:u(()=>[a(q,{gutter:16},{default:u(()=>[a(r,{span:b(c)==="sm"?12:4},{default:u(()=>{var n;return[a(w,{path:"order",label:"Orden",feedback:(n=l.value)==null?void 0:n.order},{default:u(()=>{var d;return[a(T,{style:{width:"100%"},clearable:"",value:t.value.order,"onUpdate:value":e[0]||(e[0]=i=>t.value.order=i),status:((d=l.value)==null?void 0:d.order)!=null?"error":"",onInput:e[1]||(e[1]=i=>l.value!=null?l.value.order=null:()=>{})},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(r,{span:b(c)==="sm"?12:4},{default:u(()=>{var n;return[a(w,{path:"code",label:"Código",feedback:(n=l.value)==null?void 0:n.code},{default:u(()=>{var d;return[a(g,{value:t.value.code,"onUpdate:value":[e[2]||(e[2]=i=>t.value.code=i),e[3]||(e[3]=i=>l.value!=null?l.value.code=null:()=>{})],status:((d=l.value)==null?void 0:d.code)!=null?"error":""},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(r,{span:b(c)==="sm"?24:16},{default:u(()=>{var n;return[a(w,{path:"courseId",label:"Curso",feedback:(n=l.value)==null?void 0:n.courseId},{default:u(()=>{var d;return[a(h,{filterable:"",options:v.selectables.courseItems,"virtual-scroll":!1,value:t.value.courseId,"onUpdate:value":[e[4]||(e[4]=i=>t.value.courseId=i),e[5]||(e[5]=i=>l.value!=null?l.value.courseId=null:()=>{})],status:((d=l.value)==null?void 0:d.courseId)!=null?"error":""},null,8,["options","value","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(r,{span:b(c)==="sm"?24:8},{default:u(()=>{var n;return[a(w,{path:"credits",label:"Créditos",feedback:(n=l.value)==null?void 0:n.credits},{default:u(()=>{var d;return[a(T,{style:{width:"100%"},clearable:"",value:t.value.credits,"onUpdate:value":e[6]||(e[6]=i=>t.value.credits=i),status:((d=l.value)==null?void 0:d.credits)!=null?"error":"",onInput:e[7]||(e[7]=i=>l.value!=null?l.value.credits=null:()=>{})},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(r,{span:b(c)==="sm"?24:8},{default:u(()=>{var n;return[a(w,{path:"hoursPractice",label:"Horas Practicas",feedback:(n=l.value)==null?void 0:n.hoursPractice},{default:u(()=>{var d;return[a(T,{style:{width:"100%"},clearable:"",value:t.value.hoursPractice,"onUpdate:value":e[8]||(e[8]=i=>t.value.hoursPractice=i),status:((d=l.value)==null?void 0:d.hoursPractice)!=null?"error":"",onInput:e[9]||(e[9]=i=>l.value!=null?l.value.hoursPractice=null:()=>{})},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(r,{span:b(c)==="sm"?24:8},{default:u(()=>{var n;return[a(w,{path:"hoursTheory",label:"Horas Teoricas",feedback:(n=l.value)==null?void 0:n.hoursTheory},{default:u(()=>{var d;return[a(T,{style:{width:"100%"},clearable:"",value:t.value.hoursTheory,"onUpdate:value":e[10]||(e[10]=i=>t.value.hoursTheory=i),status:((d=l.value)==null?void 0:d.hoursTheory)!=null?"error":"",onInput:e[11]||(e[11]=i=>l.value!=null?l.value.hoursTheory=null:()=>{})},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(r,{span:(b(c)==="sm",24)},{default:u(()=>{var n;return[a(w,{path:"preRequisiteId",label:"Pre-Requisito",feedback:(n=l.value)==null?void 0:n.preRequisiteId},{default:u(()=>{var d;return[a(h,{filterable:"",options:v.selectables.preRequisiteItems,"virtual-scroll":!1,value:t.value.preRequisiteId,"onUpdate:value":[e[12]||(e[12]=i=>t.value.preRequisiteId=i),e[13]||(e[13]=i=>l.value!=null?l.value.preRequisiteId=null:()=>{})],status:((d=l.value)==null?void 0:d.preRequisiteId)!=null?"error":""},null,8,["options","value","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(r,{span:"24"},{default:u(()=>[a(S,{justify:"end"},{default:u(()=>[a(w,{"label-placement":"left",label:"¿Habilitado?",path:"isEnabled","show-feedback":!1},{default:u(()=>[a(P,{value:t.value.isEnabled,"onUpdate:value":e[14]||(e[14]=n=>t.value.isEnabled=n)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),Ue={style:{"border-bottom":"1px solid #e9e9e9"}},ze=B({__name:"CourseDataTable",setup(p){const o=A(),c=_(!1),I=_([]),k=_(!1),y=_(null),s=oe({...fe()}),m=_({search:null,page:s.page,pageSize:s.pageSize}),f=_({}),t=_({courseItems:[],preRequisiteItems:[]}),M=we(r=>{y.value=r,k.value=!0},async r=>{await Se(r),await R()}),R=async()=>{m.value.page=1,await V()},V=async()=>{var g;c.value=!0;const r=(g=o.params)==null?void 0:g.id;f.value=await Ve(m.value,r),I.value=f.value.data,s.total=f.value.total,s.pageSize=f.value.per_page,s.page=f.value.current_page,s.pageCount=f.value.last_page,c.value=!1},v=ge(()=>{R()},400),e=async r=>{m.value.page=r,await V()},T=async r=>{m.value.page=1,m.value.pageSize=r,await V()};return(async()=>{var g;await V(),t.value.courseItems=await Ce();const r=(g=o.params)==null?void 0:g.id;t.value.preRequisiteItems=await Re(r)})(),(r,g)=>{const h=L,P=Z,S=J,q=be;return E(),N(H,null,[O("div",Ue,[a(S,{gutter:12,style:{padding:"12px 16px"}},{default:u(()=>[a(h,{span:12}),a(h,{span:12},{default:u(()=>[a(P,{size:"large",placeholder:"Buscar",value:m.value.search,"onUpdate:value":g[0]||(g[0]=$=>m.value.search=$),onInput:b(v),clearable:""},{suffix:u(()=>[a(X,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),a(S,null,{default:u(()=>[a(h,{span:24},{default:u(()=>[a(q,{key:"id",remote:"","single-line":!1,columns:b(M),data:I.value,pagination:b(Ie)(s),"pagination-show-size-picker":!0,loading:c.value,"onUpdate:page":e,"onUpdate:pageSize":T},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),re(r.$slots,"extra",{reLoadDataTable:R,selectables:t.value})]),a(K,{modelValue:k.value,"onUpdate:modelValue":g[1]||(g[1]=$=>k.value=$),item:y.value,onSuccess:R,selectables:t.value},null,8,["modelValue","item","selectables"])],64)}}}),Fe=B({__name:"curriculum-module-course",setup(p){const o=_(),c=A(),I=_(!1);return(async()=>{var s;const y=(s=c.params)==null?void 0:s.id;y&&(o.value=await ae(y))})(),de("curriculumModule",o),(y,s)=>{const m=j,f=G;return E(),N(H,null,[a(f,{segmented:{header:!0,content:!0}},{header:u(()=>{var t,l,C;return[s[2]||(s[2]=O("h6",{style:{color:"#999",margin:"0"}}," Gestión de Cursos del Plan de Estudio ",-1)),z(" "+F((t=o.value)==null?void 0:t.area)+" "+F((l=o.value)!=null&&l.module?" - "+((C=o.value)==null?void 0:C.module):""),1)]}),"header-extra":u(()=>[a(m,{"render-icon":b(Y)("additem"),onClick:s[0]||(s[0]=t=>I.value=!0)},{default:u(()=>s[3]||(s[3]=[z(" Agregar ")])),_:1},8,["render-icon"])]),_:1}),a(ze,null,{extra:u(({reLoadDataTable:t,selectables:l})=>[a(K,{modelValue:I.value,"onUpdate:modelValue":s[1]||(s[1]=C=>I.value=C),item:null,onSuccess:t,selectables:l},null,8,["modelValue","onSuccess","selectables"])]),_:1})],64)}}});export{Fe as default};
