import{r as U}from"./icon.utils-upfZx_ME.js";import{_ as ee,a as te,b as ae,c as ne,d as oe,e as le}from"./role.services-DYxgyCWf.js";import{d as R,a8 as I,a9 as z,aa as t,ab as e,af as F,aG as q,h as O,e as L,r as m,j as J,aA as G,az as P,aH as W,aF as D,_ as A,aT as j,aI as se,ae as M,aJ as ie,ad as B}from"./index-C2oNslvg.js";import{_ as re,a as ue}from"./FormItem-DXyfdPQq.js";import{_ as N,a as K}from"./Col-BtUCTmqt.js";import{_ as Q}from"./Input-BQ3poveX.js";import{_ as X}from"./Space-G3ZiPI5e.js";import{_ as me}from"./Switch-6rDtgWDf.js";import{i as Y}from"./DataTable.types-BEg5m_To.js";import{u as pe}from"./composables-CkauXcFl.js";import{_ as de}from"./Dropdown-tA5u1ub_.js";import{_ as _e}from"./Tag-Dwx6Rgco.js";import{a as ce,b as fe,_ as ve}from"./DataTable-ByPH7O8r.js";import{_ as ge,a as be}from"./CollapseItem-BotbDLi2.js";import{d as ye}from"./debounce.utils-DqPPCsFD.js";import"./get-2__u8Ul3.js";import"./Suffix-DF6h_xjA.js";import"./use-merged-state-CDxsXcm8.js";import"./Popover-C-qVBvl0.js";import"./Tooltip-DX3_NcDh.js";import"./Select-DaUiqjpd.js";const we=R({__name:"DataTableOp",props:{item:{}},emits:["edit","delete","permissions"],setup(r,{emit:p}){const c=pe(),a=p,l=[{label:"Asignar permisos",key:"assign-permissions",icon:U("security-safe"),props:{onClick:()=>a("permissions")}},{label:"Editar",key:"edit",icon:U("edit-2"),props:{onClick:()=>a("edit")}},{label:"Eliminar",key:"delete",icon:U("trash","red"),props:{style:{color:"red"},onClick:()=>{c.warning({title:"Confirmar",content:"¿Está seguro que desea eliminar este registro?",positiveText:"Eliminar",negativeText:"Cancelar",closable:!1,showIcon:!1,negativeButtonProps:{secondary:!0,type:"tertiary",size:"large"},positiveButtonProps:{size:"large",type:"error"},onPositiveClick:()=>{a("delete")}})}}}];return(u,s)=>{const n=F,i=de;return z(),I(i,{options:l,placement:"bottom-start"},{default:t(()=>[e(n,null,{default:t(()=>[e(q,{"icon-name":"setting-5",size:"20"})]),_:1})]),_:1})}}}),xe=(r,p,c)=>[{title:"Ops.",key:"ops",width:"80px",fixed:"left",render(a){const l=a;return O(we,{onEdit:()=>{r(l)},onDelete:()=>{p(l)},onPermissions:()=>{c(l)},item:l},{default:()=>"Editar"})}},{title:"Nombre",key:"name",minWidth:"300px"},{title:"Habilitado",key:"isEnabled",width:"150px",render:a=>O(_e,{type:a.isEnabled?"success":"error",tertiary:!0,bordered:!1,strong:!0},{default:()=>a.isEnabled?"	Habilitado":"Deshabilitado"})}],ke=(r=Y())=>({page:r.page,total:r.total,pageSize:r.pageSize,pageCount:r.pageCount,showSizePicker:!0,pageSizes:[10,50,100,500,1e3,5e3],style:{paddingRight:"16px",paddingBottom:"12px"},prefix(){return`Total ${r.total} registros`}}),H=r=>({id:null,name:null,level:r,permissions:[],isEnabled:!0}),ze=()=>({name:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}]}),Z=R({__name:"RoleForm",props:{item:{},level:{},modelValue:{type:Boolean}},emits:["update:modelValue","success"],setup(r,{emit:p}){const c=p,a=r,l=L({get:()=>a.modelValue,set:b=>c("update:modelValue",b)}),u=m(!1),s=m(null),n=m(H(a.level)),i=m(null),g=m({...ze()}),f=async()=>{if(s.value){const b=await s.value.validate();let o=null;b?(u.value=!0,n.value.id?o=await ee(n.value):o=await te(n.value),o.status?(c("success"),l.value=!1):i.value=o.data):console.log("Formulario inválido")}u.value=!1},v=()=>{console.log("Inicializando formulario"),n.value=a.item?{...a.item}:H(a.level)};return J(l,b=>{b&&(i.value=null,v())}),(b,o)=>{const w=Q,x=ue,S=K,$=me,E=X,h=N,d=re,_=F,V=G,k=W;return z(),I(k,{show:l.value,"onUpdate:show":o[4]||(o[4]=y=>l.value=y)},{default:t(()=>[e(V,{style:{width:"500px"},title:b.item?"EDITAR REGISTRO":"NUEVO REGISTRO",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:t(()=>[e(E,{justify:"end"},{default:t(()=>[e(_,{tertiary:"",size:"large",onClick:o[3]||(o[3]=y=>l.value=!1),disabled:u.value},{default:t(()=>o[5]||(o[5]=[P(" Cancelar ")])),_:1},8,["disabled"]),e(_,{size:"large",type:"primary",onClick:f,loading:u.value},{default:t(()=>o[6]||(o[6]=[P("Guardar")])),_:1},8,["loading"])]),_:1})]),default:t(()=>[e(d,{ref_key:"formRef",ref:s,model:n.value,rules:g.value,size:"large"},{default:t(()=>[e(h,null,{default:t(()=>[e(S,{span:"24"},{default:t(()=>{var y;return[e(x,{path:"name",label:"Nombre",feedback:(y=i.value)==null?void 0:y.name},{default:t(()=>{var T;return[e(w,{status:((T=i.value)==null?void 0:T.name)!=null?"error":"",value:n.value.name,"onUpdate:value":o[0]||(o[0]=C=>n.value.name=C),onInput:o[1]||(o[1]=C=>i.value!=null?i.value.name=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1}),e(S,{span:"24"},{default:t(()=>[e(E,{justify:"end"},{default:t(()=>[e(x,{"label-placement":"left",label:"¿Habilitado?",path:"isEnabled","show-feedback":!1},{default:t(()=>[e($,{value:n.value.isEnabled,"onUpdate:value":o[2]||(o[2]=y=>n.value.isEnabled=y)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),Ve=R({__name:"Form",props:{item:{},level:{},modelValue:{type:Boolean}},emits:["update:modelValue","success"],setup(r,{emit:p}){const c=p,a=r,l=m([]),u=L({get:()=>a.modelValue,set:f=>c("update:modelValue",f)}),s=m(!1),n=m({}),i=async()=>{try{s.value=!0;const f=await ae();l.value=f}catch(f){console.error("Error fetching permissions:",f)}finally{s.value=!1}},g=async()=>{s.value=!0;let f=await ne(n.value);f&&(c("success",f),u.value=!1),s.value=!1};return J(u,f=>{f&&(n.value=a.item,i())}),(f,v)=>{const b=fe,o=X,w=ce,x=be,S=ge,$=N,E=F,h=G,d=W;return z(),I(d,{show:u.value,"onUpdate:show":v[2]||(v[2]=_=>u.value=_)},{default:t(()=>[e(h,{style:{width:"500px"},title:"Asignar Permisos",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:t(()=>[e(o,{justify:"end"},{default:t(()=>[e(E,{tertiary:"",size:"large",onClick:v[1]||(v[1]=_=>u.value=!1),disabled:s.value},{default:t(()=>v[3]||(v[3]=[P(" Cancelar ")])),_:1},8,["disabled"]),e(E,{size:"large",type:"primary",onClick:g,loading:s.value},{default:t(()=>v[4]||(v[4]=[P("Guardar")])),_:1},8,["loading"])]),_:1})]),default:t(()=>[e($,null,{default:t(()=>[e(S,{"default-expanded-names":"1",accordion:""},{default:t(()=>[(z(!0),D(A,null,j(l.value,(_,V)=>(z(),I(x,{key:V,name:V,title:_.display_name},{default:t(()=>[e(w,{value:n.value.permissions,"onUpdate:value":v[0]||(v[0]=k=>n.value.permissions=k),size:"large"},{default:t(()=>[e(o,{"item-style":"display: flex;"},{default:t(()=>[(z(!0),D(A,null,j(_.children,k=>(z(),I(b,{key:k.id,value:k.id,label:k.display_name},null,8,["value","label"]))),128))]),_:2},1024)]),_:2},1032,["value"])]),_:2},1032,["name","title"]))),128))]),_:1})]),_:1})]),_:1})]),_:1},8,["show"])}}}),Ce={style:{"border-bottom":"1px solid #e9e9e9"}},Ee=R({__name:"DataTable",props:{level:{}},setup(r){const p=r,c=m(!1),a=m([]),l=m(!1),u=m(!1),s=m(null),n=se({...Y()}),i=m({search:null,page:n.page,pageSize:n.pageSize}),g=m({}),o=xe(d=>{s.value=d,l.value=!0},async d=>{await le(d),await w()},d=>{s.value=d,u.value=!0}),w=async()=>{i.value.page=1,await x()},x=async()=>{c.value=!0,g.value=await oe(i.value),a.value=g.value.data,n.total=g.value.total,n.pageSize=g.value.per_page,n.page=g.value.current_page,n.pageCount=g.value.last_page,c.value=!1},S=ye(()=>{w()},400),$=async d=>{i.value.page=d,await x()},E=async d=>{i.value.page=1,i.value.pageSize=d,await x()};return(async()=>{i.value.filters={level:p.level},await x()})(),(d,_)=>{const V=K,k=Q,y=N,T=ve;return z(),D(A,null,[M("div",Ce,[e(y,{gutter:12,style:{padding:"12px 16px"}},{default:t(()=>[e(V,{span:12}),e(V,{span:12},{default:t(()=>[e(k,{size:"large",placeholder:"Buscar",value:i.value.search,"onUpdate:value":_[0]||(_[0]=C=>i.value.search=C),onInput:B(S),clearable:""},{suffix:t(()=>[e(q,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),e(y,null,{default:t(()=>[e(V,{span:24},{default:t(()=>[e(T,{key:"id",remote:"","single-line":!1,columns:B(o),data:a.value,pagination:B(ke)(n),"pagination-show-size-picker":!0,loading:c.value,"onUpdate:page":$,"onUpdate:pageSize":E},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),ie(d.$slots,"extra",{reLoadDataTable:w})]),e(Z,{modelValue:l.value,"onUpdate:modelValue":_[1]||(_[1]=C=>l.value=C),item:s.value,level:p.level,onSuccess:w},null,8,["modelValue","item","level"]),e(Ve,{modelValue:u.value,"onUpdate:modelValue":_[2]||(_[2]=C=>u.value=C),item:s.value,onSuccess:w,level:p.level},null,8,["modelValue","item","level"])],64)}}}),We=R({__name:"RoleAdminView",setup(r){const p=m(!1);return(c,a)=>{const l=F,u=G;return z(),D(A,null,[e(u,{segmented:{header:!0,content:!0}},{header:t(()=>a[2]||(a[2]=[M("span",{class:"text-sm text-slate-500"}," Gestion de roles de administrador ",-1),M("h5",{class:"text-lg font-bold text-slate-800"},"Roles de Administrador",-1)])),"header-extra":t(()=>[e(l,{"render-icon":B(U)("additem"),onClick:a[0]||(a[0]=s=>p.value=!0)},{default:t(()=>a[3]||(a[3]=[P(" Agregar ")])),_:1},8,["render-icon"])]),_:1}),e(Ee,{level:"admin"},{extra:t(({reLoadDataTable:s})=>[e(Z,{modelValue:p.value,"onUpdate:modelValue":a[1]||(a[1]=n=>p.value=n),item:null,onSuccess:s,level:"admin"},null,8,["modelValue","onSuccess"])]),_:1})],64)}}});export{We as default};
