import{r as P}from"./icon.utils-D7AUVIU9.js";import{d as T,a3 as G,a9 as S,ad as M,ae as v,aa as w,ab as t,ac as e,ag as N,aH as q,h as U,e as Y,r as i,j as Z,aB as H,aA as R,aI as ee,a5 as ae,aJ as te,aG as j,_ as W,af as B,aK as ne,a8 as oe}from"./index-Dga6ANj1.js";import{_ as le,a as se,b as ue,c as re}from"./area.services-OivUqf7K.js";import{_ as ie,a as pe}from"./FormItem-DNGP1HoV.js";import{_ as J,a as K}from"./Col-CQISFbwN.js";import{_ as L}from"./Input-Cdqf_kvO.js";import{_ as me}from"./Select-zCQZwiWb.js";import{_ as ce}from"./Space-j9I4BA4b.js";import{_ as de}from"./Switch-DaLY6tbL.js";import{i as Q}from"./DataTable.types-BEg5m_To.js";import{u as _e}from"./composables-DXkYOJGS.js";import{_ as fe}from"./Dropdown-D-rd6urP.js";import{N as ge}from"./Tag-B6LobqAE.js";import{d as ve}from"./debounce.utils-DqPPCsFD.js";import{_ as be}from"./DataTable-DRXC1w3I.js";import{_ as ye}from"./selectables.services-DrN-Q4RR.js";import"./get-CRgnu-Rv.js";import"./Suffix-NjKowPKN.js";import"./use-merged-state-BuNcl0OG.js";import"./Popover-WKcDoR5R.js";import"./Tooltip-Dl9y0IfD.js";const we=T({__name:"DataTableOp",props:{item:{}},emits:["edit","delete"],setup(c,{emit:_}){const{hasPermission:l}=G(),u=_e(),p=_,f=[{show:l(["area.edit"]),label:"Editar",key:"edit",icon:P("edit-2"),props:{onClick:()=>p("edit")}},{show:l(["area.delete"]),label:"Eliminar",key:"delete",icon:P("trash","red"),props:{style:{color:"red"},onClick:()=>{u.warning({title:"Confirmar",content:"¿Está seguro que desea eliminar este registro?",positiveText:"Eliminar",negativeText:"Cancelar",closable:!1,showIcon:!1,negativeButtonProps:{secondary:!0,type:"tertiary",size:"large"},positiveButtonProps:{size:"large",type:"error"},onPositiveClick:()=>{p("delete")}})}}}];return(o,s)=>{const n=N,d=fe;return v(l)(["area.edit","area.delete"])?(w(),S(d,{key:0,options:f,placement:"bottom-start"},{default:t(()=>[e(n,null,{default:t(()=>[e(q,{"icon-name":"setting-5",size:"20"})]),_:1})]),_:1})):M("",!0)}}}),Ie=(c,_)=>[{title:"Ops.",key:"ops",width:"80px",fixed:"left",render(l){const u=l;return U(we,{onEdit:()=>{c(u)},onDelete:()=>{_(u)},item:u},{default:()=>"Editar"})}},{title:"Nombre",key:"name",minWidth:"200px"},{title:"Currículo",key:"curriculum",minWidth:"200px"},{title:"Habilitado",key:"isEnabled",width:"150px",render:l=>U(ge,{type:l.isEnabled?"success":"error",tertiary:!0,bordered:!1,strong:!0},{default:()=>l.isEnabled?"	Habilitado":"Deshabilitado"})}],ke=(c=Q())=>({page:c.page,total:c.total,pageSize:c.pageSize,pageCount:c.pageCount,showSizePicker:!0,pageSizes:[10,50,100,500,1e3,5e3],style:{paddingRight:"16px",paddingBottom:"12px"},prefix(){return`Total ${c.total} registros`}}),F=()=>({id:null,name:null,curriculumId:null,isEnabled:!0}),xe=()=>({name:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}],curriculumId:[{type:"number",required:!0,trigger:["blur","input"],message:"Obligatorio"}]}),X=T({__name:"AreaForm",props:{item:{},modelValue:{type:Boolean},curriculumOptions:{}},emits:["update:modelValue","success"],setup(c,{emit:_}){const l=_,u=c,p=Y({get:()=>u.modelValue,set:g=>l("update:modelValue",g)}),f=i(!1),o=i(null),s=i(F()),n=i(null),d=i({...xe()}),I=async()=>{if(o.value){const g=await o.value.validate();let a=null;g?(f.value=!0,s.value.id?a=await le(s.value):a=await se(s.value),a.status?(l("success"),p.value=!1):n.value=a.data):console.log("Formulario inválido")}f.value=!1},E=()=>{console.log("Inicializando formulario"),s.value=u.item?{...u.item}:F()};return Z(p,g=>{g&&E()}),(g,a)=>{const b=L,k=pe,x=K,$=me,D=de,m=ce,y=J,z=ie,V=N,O=H,A=ee;return w(),S(A,{show:p.value,"onUpdate:show":a[6]||(a[6]=r=>p.value=r)},{default:t(()=>[e(O,{style:{width:"500px"},title:g.item?"EDITAR REGISTRO":"NUEVO REGISTRO",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:t(()=>[e(m,{justify:"end"},{default:t(()=>[e(V,{tertiary:"",size:"large",onClick:a[5]||(a[5]=r=>p.value=!1),disabled:f.value},{default:t(()=>a[7]||(a[7]=[R(" Cancelar ")])),_:1},8,["disabled"]),e(V,{size:"large",type:"primary",onClick:I,loading:f.value},{default:t(()=>a[8]||(a[8]=[R("Guardar")])),_:1},8,["loading"])]),_:1})]),default:t(()=>[e(z,{ref_key:"formRef",ref:o,model:s.value,rules:d.value,size:"large"},{default:t(()=>[e(y,null,{default:t(()=>[e(x,{span:"24"},{default:t(()=>{var r;return[e(k,{path:"name",label:"Nombre",feedback:(r=n.value)==null?void 0:r.name},{default:t(()=>{var C;return[e(b,{status:((C=n.value)==null?void 0:C.name)!=null?"error":"",value:s.value.name,"onUpdate:value":a[0]||(a[0]=h=>s.value.name=h),onInput:a[1]||(a[1]=h=>n.value!=null?n.value.name=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1}),e(x,{span:"24"},{default:t(()=>{var r;return[e(k,{path:"curriculumId",label:"Plan de estudios",feedback:(r=n.value)==null?void 0:r.curriculumId},{default:t(()=>{var C;return[e($,{clearable:"",placeholder:"Seleccione un plan de estudios",value:s.value.curriculumId,"onUpdate:value":a[2]||(a[2]=h=>s.value.curriculumId=h),options:g.curriculumOptions,"virtual-scroll":!1,status:((C=n.value)==null?void 0:C.curriculumId)!=null?"error":"",onInput:a[3]||(a[3]=h=>n.value!=null?n.value.curriculumId=null:()=>{})},null,8,["value","options","status"])]}),_:1},8,["feedback"])]}),_:1}),e(x,{span:"24"},{default:t(()=>[e(m,{justify:"end"},{default:t(()=>[e(k,{"label-placement":"left",label:"¿Habilitado?",path:"isEnabled","show-feedback":!1},{default:t(()=>[e(D,{value:s.value.isEnabled,"onUpdate:value":a[4]||(a[4]=r=>s.value.isEnabled=r)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),ze={style:{"border-bottom":"1px solid #e9e9e9"}},Ce=T({__name:"DataTable",props:{curriculumOptions:{}},setup(c){const _=ae(),l=i(!1),u=i([]),p=i(!1),f=i(null),o=te({...Q()}),s=i(""),n=i({search:null,page:o.page,pageSize:o.pageSize}),d=i({}),g=Ie(m=>{f.value=m,p.value=!0},async m=>{await re(m),await a()}),a=async()=>{n.value.page=1,await b()},b=async()=>{l.value=!0,n.value.filters={curriculumId:s.value},d.value=await ue(n.value),u.value=d.value.data,o.total=d.value.total,o.pageSize=d.value.per_page,o.page=d.value.current_page,o.pageCount=d.value.last_page,l.value=!1},k=ve(()=>{a()},400),x=async m=>{n.value.page=m,await b()},$=async m=>{n.value.page=1,n.value.pageSize=m,await b()};return(async()=>{s.value=_.params.id??"",await b()})(),(m,y)=>{const z=K,V=L,O=J,A=be;return w(),j(W,null,[B("div",ze,[e(O,{gutter:12,style:{padding:"12px 16px"}},{default:t(()=>[e(z,{span:12}),e(z,{span:12},{default:t(()=>[e(V,{size:"large",placeholder:"Buscar",value:n.value.search,"onUpdate:value":y[0]||(y[0]=r=>n.value.search=r),onInput:v(k),clearable:""},{suffix:t(()=>[e(q,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),e(O,null,{default:t(()=>[e(z,{span:24},{default:t(()=>[e(A,{key:"id",remote:"",size:"small","single-line":!1,columns:v(g),data:u.value,pagination:v(ke)(o),"pagination-show-size-picker":!0,loading:l.value,"onUpdate:page":x,"onUpdate:pageSize":$},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),ne(m.$slots,"extra",{reLoadDataTable:a})]),e(X,{modelValue:p.value,"onUpdate:modelValue":y[1]||(y[1]=r=>p.value=r),curriculumOptions:m.curriculumOptions,item:f.value,onSuccess:a},null,8,["modelValue","curriculumOptions","item"])],64)}}}),Je=T({__name:"index",setup(c){const{hasPermission:_}=G(),l=i([]),u=i(!1);return(async()=>{l.value=await ye()})(),(f,o)=>{const s=N,n=H,d=oe("AppNotAuthorization");return v(_)(["area.create","area.edit","area.delete"])?(w(),j(W,{key:0},[e(n,{segmented:{header:!0,content:!0}},{header:t(()=>o[2]||(o[2]=[B("span",{class:"text-sm text-slate-500"}," Gestión de Areas academicas ",-1),B("h5",{class:"text-lg font-bold text-slate-800"},"Areas",-1)])),"header-extra":t(()=>[v(_)(["area.create"])?(w(),S(s,{key:0,size:"large",type:"primary","render-icon":v(P)("additem"),onClick:o[0]||(o[0]=I=>u.value=!0)},{default:t(()=>o[3]||(o[3]=[R(" Agregar ")])),_:1},8,["render-icon"])):M("",!0)]),_:1}),e(Ce,{curriculumOptions:l.value},{extra:t(({reLoadDataTable:I})=>[e(X,{modelValue:u.value,"onUpdate:modelValue":o[1]||(o[1]=E=>u.value=E),curriculumOptions:l.value,item:null,onSuccess:I},null,8,["modelValue","curriculumOptions","onSuccess"])]),_:1},8,["curriculumOptions"])],64)):(w(),S(d,{key:1}))}}});export{Je as default};
