import{a as D,i as R}from"./DataTable.types-DKc2i3jV.js";import{an as z,d as k,e as $,r as i,a8 as P,a9 as g,a4 as w,a6 as r,aa as n,ae as T,ao as W,ad as N,ag as G,h as C,ai as M,aj as E,ac as I,ab as x,ah as U,ak as L,_ as V,al as q}from"./index-BDy3jz-R.js";import{_ as j}from"./Dropdown-DschnT-y.js";import{_ as F}from"./ButtonGroup-1rx1ZqCK.js";import{N as H,_ as J,a as K}from"./Col-C2AyWxkb.js";import{_ as Q}from"./DocumentTypeForm.vue_vue_type_script_setup_true_lang-BTtS_B8X.js";import{d as X}from"./debounce.utils-DqPPCsFD.js";import{_ as Y}from"./FormItem-DAU9UqDA.js";import{_ as Z}from"./DataTable-BjnUjyJ9.js";import{_ as ee,c as ae}from"./selectables.services-Dh18oZu3.js";import"./get-I814HMgj.js";import"./documentType.services-CWSTuR9m.js";import"./Switch-HHJXHes7.js";import"./Tooltip-BC78MQpo.js";const te=async t=>{try{return(await z().post("/enrollment-groups/load-data-table",t)).data.data}catch{return D()}},ne=async t=>{try{return{status:!0,data:(await z().post("/enrollment-groups/change-status-group",{...t})).data.data}}catch{return{status:!1,data:null}}},oe=k({__name:"GroupStatus",props:{groupId:{},status:{}},emits:["success"],setup(t,{emit:e}){const p=e,l=t,d=$(()=>[{label:"Cerrar",key:"CERRADO",disabled:l.status=="CERRADO"},{label:"Reabrir",key:"ABIERTO",disabled:l.status=="ABIERTO"}]),o=i(!1),s=async a=>{o.value=!0,await ne({id:l.groupId,status:a}),p("success"),o.value=!1};return(a,c)=>{const u=G,f=P("LnxIcon"),v=j,y=F;return g(),w(y,null,{default:r(()=>[n(u,{quaternary:""},{default:r(()=>[T(W(a.status),1)]),_:1}),a.status=="ABIERTO"||a.status=="CERRADO"?(g(),w(v,{key:0,trigger:"click",options:d.value,onSelect:s},{default:r(()=>[n(u,{tertiary:"",loading:o.value},{icon:r(()=>[n(f,{"icon-name":"edit"})]),_:1},8,["loading"])]),_:1},8,["options"])):N("",!0)]),_:1})}}}),se=t=>[{title:"Grupo",key:"group",minWidth:"80px"},{title:"Curso",key:"course",minWidth:"200px"},{title:"Módulo",key:"module",minWidth:"200px"},{title:"Area",key:"area",minWidth:"200px"},{title:"Modalidad",key:"modality",minWidth:"120px"},{title:"Min. Est.",key:"minStudents",minWidth:"80px"},{title:"Matriculados",key:"studentEnrolled",minWidth:"110px"},{title:"Con reservados",key:"studentReserved",minWidth:"80px"},{title:"% Apertura",key:"percentageOpening",render:e=>C(H,{type:e.percentageOpening?e.percentageOpening<60?"error":e.percentageOpening<100?"warning":"success":"default",tertiary:!0,bordered:!1,strong:!0},{default:()=>`${e.percentageOpening}%`})},{title:"Estado",key:"status",width:"150px",fixed:"right",render:e=>C(oe,{status:e.status,groupId:e.id,onSuccess:t})}],re=(t=R())=>({page:t.page,total:t.total,pageSize:t.pageSize,pageCount:t.pageCount,showSizePicker:!0,pageSizes:[10,50,100,500,1e3,5e3],style:{paddingRight:"16px",paddingBottom:"12px"},prefix(){return`Total ${t.total} registros`}}),ie={style:{"border-bottom":"1px solid #e9e9e9"}},le=k({__name:"EnrollmentGroupDataTable",setup(t){const e=i(!1),p=i([]),l=i(!1),d=i(null),o=M({...R()}),s=i({search:null,page:o.page,pageSize:o.pageSize}),a=i({}),c=async()=>{s.value.page=1,await u()},u=async()=>{e.value=!0,a.value=await te(s.value),p.value=a.value.data,o.total=a.value.total,o.pageSize=a.value.per_page,o.page=a.value.current_page,o.pageCount=a.value.last_page,e.value=!1},f=X(()=>{c()},400),v=async _=>{s.value.page=_,await u()},y=async _=>{s.value.page=1,s.value.pageSize=_,await u()},O=se(u);return(async()=>{await u()})(),(_,m)=>{const h=J,A=Y,S=K,B=Z;return g(),E(V,null,[I("div",ie,[n(S,{gutter:12,style:{padding:"12px 16px"}},{default:r(()=>[n(h,{span:12}),n(h,{span:12},{default:r(()=>[n(A,{size:"large",placeholder:"Buscar",value:s.value.search,"onUpdate:value":m[0]||(m[0]=b=>s.value.search=b),onInput:x(f),clearable:""},{suffix:r(()=>[n(U,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),n(S,null,{default:r(()=>[n(h,{span:24},{default:r(()=>[n(B,{key:"id",remote:"","single-line":!1,columns:x(O),data:p.value,pagination:x(re)(o),"pagination-show-size-picker":!0,loading:e.value,"onUpdate:page":v,"onUpdate:pageSize":y},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),L(_.$slots,"extra",{reLoadDataTable:c})]),n(Q,{modelValue:l.value,"onUpdate:modelValue":m[1]||(m[1]=b=>l.value=b),item:d.value,onSuccess:c},null,8,["modelValue","item"])],64)}}}),we=k({__name:"EnrollmentGroupView",setup(t){const e=i(!1),p=i([]),l=async s=>{e.value=!0,p.value=await ae(s),e.value=!1},d=i([]);return(async()=>{await l(""),d.value=await ee()})(),(s,a)=>{const c=q;return g(),E(V,null,[n(c,{segmented:{header:!0,content:!0}},{header:r(()=>a[0]||(a[0]=[I("h6",{style:{color:"#999",margin:"0"}},"Carga Académica",-1),T(" Apertura de grupos ")])),action:r(()=>a[1]||(a[1]=[])),_:1}),n(le)],64)}}});export{we as default};
