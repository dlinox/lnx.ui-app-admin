import{r as P}from"./icon.utils-BzaQiRL0.js";import{d as I,a9 as S,a4 as F,a6 as t,aa as e,ah as M,ag as B,h as N,an as V,e as X,r as c,g as Y,ae as E,al as G,am as Z,ai as ee,aj as j,ac as q,ab as C,ak as te,_ as H}from"./index-BDy3jz-R.js";import{i as A,a as ae}from"./DataTable.types-DKc2i3jV.js";import{_ as ne}from"./InputNumber-B6n7P9Iy.js";import{_ as L,a as oe,b as se}from"./FormItem-DAU9UqDA.js";import{N as le,_ as W,b as re,a as J}from"./Col-C2AyWxkb.js";import{_ as ue}from"./Switch-HHJXHes7.js";import{d as ie}from"./debounce.utils-DqPPCsFD.js";import{u as pe}from"./composables-D20BIpNr.js";import{_ as de}from"./Dropdown-DschnT-y.js";import{_ as me}from"./DataTable-BjnUjyJ9.js";import"./get-I814HMgj.js";import"./Tooltip-BC78MQpo.js";const ce=I({__name:"DataTableOp",props:{item:{}},emits:["edit","delete"],setup(l,{emit:n}){const i=pe(),o=n,p=[{label:"Editar",key:"edit",icon:P("edit-2"),props:{onClick:()=>o("edit")}},{label:"Eliminar",key:"delete",icon:P("trash","red"),props:{style:{color:"red"},onClick:()=>{i.warning({title:"Confirmar",content:"¿Está seguro que desea eliminar este registro?",positiveText:"Eliminar",negativeText:"Cancelar",closable:!1,showIcon:!1,negativeButtonProps:{secondary:!0,type:"tertiary",size:"large"},positiveButtonProps:{size:"large",type:"error"},onPositiveClick:()=>{o("delete")}})}}}];return(r,u)=>{const s=B,d=de;return S(),F(d,{options:p,placement:"bottom-start"},{default:t(()=>[e(s,null,{default:t(()=>[e(M,{"icon-name":"setting-5",size:"20"})]),_:1})]),_:1})}}}),_e=(l,n)=>[{title:"Ops.",key:"ops",width:"80px",fixed:"left",render(i){const o=i;return N(ce,{onEdit:()=>{l(o)},onDelete:()=>{n(o)},item:o},{default:()=>"Editar"})}},{title:"Nombre",key:"name",minWidth:"300px"},{title:"Comisión (S/.)",key:"commission",width:"120px",align:"right"},{title:"Habilitado",key:"isEnabled",width:"150px",render:i=>N(le,{type:i.isEnabled?"success":"error",tertiary:!0,bordered:!1,strong:!0},{default:()=>i.isEnabled?"	Habilitado":"Deshabilitado"})}],fe=(l=A())=>({page:l.page,total:l.total,pageSize:l.pageSize,pageCount:l.pageCount,showSizePicker:!0,pageSizes:[10,50,100,500,1e3,5e3],style:{paddingRight:"16px",paddingBottom:"12px"},prefix(){return`Total ${l.total} registros`}}),O=()=>({id:null,name:null,commission:null,isEnabled:!0}),ge=()=>({name:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}]}),ve=async l=>{try{return(await V().post("/payment-type/load-data-table",l)).data.data}catch{return ae()}},ye=async l=>{try{return{status:!0,data:(await V().post("/payment-type",l)).data.data}}catch(n){return n.response.status===422?{status:!1,data:n.response.data.errors}:{status:!1,data:null}}},be=async l=>{try{return{status:!0,data:(await V().put("/payment-type",l)).data.data}}catch(n){return n.response.status===422?{status:!1,data:n.response.data.errors}:{status:!1,data:null}}},we=async l=>{try{return await V().delete("/payment-type",{data:{id:l.id}}),!0}catch{return!1}},K=I({__name:"PaymentTypeForm",props:{item:{},modelValue:{type:Boolean}},emits:["update:modelValue","success"],setup(l,{emit:n}){const i=n,o=l,p=X({get:()=>o.modelValue,set:m=>i("update:modelValue",m)}),r=c(!1),u=c(null),s=c(O()),d=c(null),U=c({...ge()}),$=async()=>{if(u.value){const m=await u.value.validate();let a=null;m?(r.value=!0,s.value.id?a=await be(s.value):a=await ye(s.value),a.status?(i("success"),p.value=!1):d.value=a.data):console.log("Formulario inválido")}r.value=!1},g=()=>{console.log("Inicializando formulario"),s.value=o.item?{...o.item}:O()};return Y(p,m=>{m&&g()}),(m,a)=>{const D=L,b=oe,z=W,_=ne,v=ue,y=re,R=J,T=se,h=B,w=G,Q=Z;return S(),F(Q,{show:p.value,"onUpdate:show":a[6]||(a[6]=f=>p.value=f)},{default:t(()=>[e(w,{style:{width:"500px"},title:m.item?"EDITAR REGISTRO":"NUEVO REGISTRO",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:t(()=>[e(y,{justify:"end"},{default:t(()=>[e(h,{tertiary:"",size:"large",onClick:a[5]||(a[5]=f=>p.value=!1),disabled:r.value},{default:t(()=>a[7]||(a[7]=[E(" Cancelar ")])),_:1},8,["disabled"]),e(h,{size:"large",type:"primary",onClick:$,loading:r.value},{default:t(()=>a[8]||(a[8]=[E("Guardar")])),_:1},8,["loading"])]),_:1})]),default:t(()=>[e(T,{ref_key:"formRef",ref:u,model:s.value,rules:U.value,size:"large"},{default:t(()=>[e(R,null,{default:t(()=>[e(z,{span:"24"},{default:t(()=>{var f;return[e(b,{path:"name",label:"Nombre",feedback:(f=d.value)==null?void 0:f.name},{default:t(()=>{var k;return[e(D,{status:((k=d.value)==null?void 0:k.name)!=null?"error":"",value:s.value.name,"onUpdate:value":a[0]||(a[0]=x=>s.value.name=x),onInput:a[1]||(a[1]=x=>d.value!=null?d.value.name=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1}),e(z,{span:"24"},{default:t(()=>{var f;return[e(b,{path:"commission",label:"Comisión",feedback:(f=d.value)==null?void 0:f.commission},{default:t(()=>{var k;return[e(_,{status:((k=d.value)==null?void 0:k.commission)!=null?"error":"",value:s.value.commission,"onUpdate:value":a[2]||(a[2]=x=>s.value.commission=x),onInput:a[3]||(a[3]=x=>d.value!=null?d.value.commission=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1}),e(z,{span:"24"},{default:t(()=>[e(y,{justify:"end"},{default:t(()=>[e(b,{"label-placement":"left",label:"¿Habilitado?",path:"isEnabled","show-feedback":!1},{default:t(()=>[e(v,{value:s.value.isEnabled,"onUpdate:value":a[4]||(a[4]=f=>s.value.isEnabled=f)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),ke={style:{"border-bottom":"1px solid #e9e9e9"}},xe=I({__name:"DataTable",setup(l){const n=c(!1),i=c([]),o=c(!1),p=c(null),r=ee({...A()}),u=c({search:null,page:r.page,pageSize:r.pageSize}),s=c({}),$=_e(_=>{p.value=_,o.value=!0},async _=>{await we(_),await g()}),g=async()=>{u.value.page=1,await m()},m=async()=>{n.value=!0,s.value=await ve(u.value),i.value=s.value.data,r.total=s.value.total,r.pageSize=s.value.per_page,r.page=s.value.current_page,r.pageCount=s.value.last_page,n.value=!1},a=ie(()=>{g()},400),D=async _=>{u.value.page=_,await m()},b=async _=>{u.value.page=1,u.value.pageSize=_,await m()};return(async()=>{await m()})(),(_,v)=>{const y=W,R=L,T=J,h=me;return S(),j(H,null,[q("div",ke,[e(T,{gutter:12,style:{padding:"12px 16px"}},{default:t(()=>[e(y,{span:12}),e(y,{span:12},{default:t(()=>[e(R,{size:"large",placeholder:"Buscar",value:u.value.search,"onUpdate:value":v[0]||(v[0]=w=>u.value.search=w),onInput:C(a),clearable:""},{suffix:t(()=>[e(M,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),e(T,null,{default:t(()=>[e(y,{span:24},{default:t(()=>[e(h,{key:"id",remote:"","single-line":!1,columns:C($),data:i.value,pagination:C(fe)(r),"pagination-show-size-picker":!0,loading:n.value,"onUpdate:page":D,"onUpdate:pageSize":b},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),te(_.$slots,"extra",{reLoadDataTable:g})]),e(K,{modelValue:o.value,"onUpdate:modelValue":v[1]||(v[1]=w=>o.value=w),item:p.value,onSuccess:g},null,8,["modelValue","item"])],64)}}}),Ue=I({__name:"index",setup(l){const n=c(!1);return(i,o)=>{const p=B,r=G;return S(),j(H,null,[e(r,{segmented:{header:!0,content:!0}},{header:t(()=>o[2]||(o[2]=[q("h6",{style:{color:"#999",margin:"0"}},"Gestión de Tipos de Documentos",-1),E(" Tipos de Documentos ")])),"header-extra":t(()=>[e(p,{"render-icon":C(P)("additem"),onClick:o[0]||(o[0]=u=>n.value=!0)},{default:t(()=>o[3]||(o[3]=[E(" Agregar ")])),_:1},8,["render-icon"])]),_:1}),e(xe,null,{extra:t(({reLoadDataTable:u})=>[e(K,{modelValue:n.value,"onUpdate:modelValue":o[1]||(o[1]=s=>n.value=s),item:null,onSuccess:u},null,8,["modelValue","onSuccess"])]),_:1})],64)}}});export{Ue as default};
