import{r as E}from"./icon.utils-awSo8SDm.js";import{d as A,a3 as L,a9 as V,ad as M,ae as f,aa as x,ab as t,ac as e,ag as P,aH as G,h as oe,az as ne,e as N,r as c,j as se,a8 as W,aB as j,aA as T,b2 as le,aI as re,aJ as ie,aG as H,_ as J,af as O,aK as ue}from"./index-C2RAjY4S.js";import{i as K,a as pe}from"./DataTable.types-BEg5m_To.js";import{_ as ce,a as de}from"./FormItem-8N6y2FM0.js";import{_ as Q,a as X}from"./Col-C7IEyeD2.js";import{_ as me}from"./Alert-5ipw5VW6.js";import{_ as _e}from"./Select-CIfpunuo.js";import{_ as Y}from"./Input-BZPRw-RC.js";import{_ as ge}from"./Space-BaG8M23m.js";import{u as ve}from"./composables-DbeQn7Bu.js";import{_ as fe}from"./Dropdown-BWuyXyEl.js";import{d as be}from"./debounce.utils-DqPPCsFD.js";import{_ as ye}from"./DataTable-DlDvNeW4.js";import"./get-48KRp-YV.js";import"./Popover-BEcuqLKM.js";import"./use-merged-state-CKm63525.js";import"./Suffix-brr6nX72.js";import"./Tag-ANStCmMW.js";import"./Tooltip-X6AAy4Yb.js";const we=A({__name:"DataTableOp",props:{item:{}},emits:["edit","delete"],setup(o,{emit:n}){const{hasPermission:i}=L(),u=ve(),s=n,l=[{label:"Editar",key:"edit",icon:E("edit-2"),props:{onClick:()=>s("edit")},show:i(["academic-supervision.edit"])},{label:"Eliminar",key:"delete",icon:E("trash","red"),show:i(["academic-supervision.delete"]),props:{style:{color:"red"},onClick:()=>{u.warning({title:"Confirmar",content:"¿Está seguro que desea eliminar este registro?",positiveText:"Eliminar",negativeText:"Cancelar",closable:!1,showIcon:!1,negativeButtonProps:{secondary:!0,type:"tertiary",size:"large"},positiveButtonProps:{size:"large",type:"error"},onPositiveClick:()=>{s("delete")}})}}}];return(p,r)=>{const d=P,b=fe;return f(i)(["academic-supervision.edit","academic-supervision.delete"])?(x(),V(b,{key:0,options:l,placement:"bottom-start"},{default:t(()=>[e(d,null,{default:t(()=>[e(G,{"icon-name":"setting-5",size:"20"})]),_:1})]),_:1})):M("",!0)}}}),ke=(o,n)=>[{title:"Ops.",key:"ops",width:"80px",fixed:"left",render(i){const u=i;return oe(we,{onEdit:()=>{o(u)},onDelete:()=>{n(u)},item:u},{default:()=>"Editar"})}},{title:"Periodo",key:"period",minWidth:"120px"},{title:"Docente",key:"teacher",minWidth:"120px"},{title:"Curso",key:"course",minWidth:"120px"},{title:"Tipo",key:"type",width:"120px"},{title:"Observaciones",key:"observations",minWidth:"200px"}],xe=(o=K())=>({page:o.page,total:o.total,pageSize:o.pageSize,pageCount:o.pageCount,showSizePicker:!0,pageSizes:[10,50,100,500,1e3],style:{paddingRight:"16px",paddingBottom:"12px"},prefix(){return`Total ${o.total} registros`}}),F=()=>({id:null,groupId:null,type:null,observations:""}),he=()=>({groupId:[{required:!0,type:"number",message:"Obligatorio",trigger:"blur"}],type:[{required:!0,message:"Obligatorio",trigger:"blur"}],observations:[{required:!0,message:"Obligatorio",trigger:"blur"}]}),$=ne(),D="/academic-supervision",ze=async o=>{try{return(await $.post(`${D}/load-data-table`,o)).data.data}catch{return pe()}},Se=async o=>{try{return{status:!0,data:(await $.post(`${D}/save`,o)).data.data}}catch(n){return n.response.status===422?{status:!1,data:n.response.data.errors}:{status:!1,data:null}}},Ie=async o=>{try{return(await $.post(`${D}/delete`,o)).data.status}catch{return!1}},Ce=async()=>{try{return(await $.get(`${D}/active-groups`)).data.data}catch{return[]}},Z=A({__name:"Form",props:{item:{},modelValue:{type:Boolean}},emits:["update:modelValue","success"],setup(o,{emit:n}){const i=n,u=o,s=N({get:()=>u.modelValue,set:g=>i("update:modelValue",g)}),l=c(!1),p=c(null),r=c(F()),d=c(null),b=N(()=>({...he()})),I=c([]),y=async()=>{if(p.value){const g=await p.value.validate();let a=null;g&&(l.value=!0,a=await Se(r.value),a.status?(i("success"),s.value=!1):d.value=a.data)}l.value=!1},w=async()=>{r.value=u.item?{...u.item,groupId:u.item.groupId}:F(),I.value=await Ce()};return se(s,g=>{g&&(d.value=null,w())}),(g,a)=>{const R=W("LnxIcon"),U=le,m=me,v=X,k=_e,h=de,C=Y,B=Q,z=ce,q=P,ee=ge,te=j,ae=re;return x(),V(ae,{show:s.value,"onUpdate:show":a[4]||(a[4]=_=>s.value=_)},{default:t(()=>[e(te,{style:{width:"500px"},title:g.item?"Editar registro":"Nuevo registro",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:t(()=>[e(ee,{justify:"end"},{default:t(()=>[e(q,{tertiary:"",size:"large",onClick:a[3]||(a[3]=_=>s.value=!1),disabled:l.value},{default:t(()=>a[6]||(a[6]=[T(" Cancelar ")])),_:1},8,["disabled"]),e(q,{size:"large",type:"primary",onClick:y,loading:l.value},{default:t(()=>a[7]||(a[7]=[T(" Guardar ")])),_:1},8,["loading"])]),_:1})]),default:t(()=>[e(z,{ref_key:"formRef",ref:p,model:r.value,rules:b.value,size:"large"},{default:t(()=>[e(B,{gutter:16},{default:t(()=>[e(v,{span:24},{default:t(()=>[e(m,{stype:"default",closable:"",class:"mb-2"},{icon:t(()=>[e(U,null,{default:t(()=>[e(R,{iconName:"info-circle"})]),_:1})]),default:t(()=>[a[5]||(a[5]=T(" Solo se listan los grupos que todavía están activos o disponibles para matrícula. "))]),_:1})]),_:1}),e(v,{span:24},{default:t(()=>{var _;return[e(h,{path:"groupId",label:"Grupo - Docente","show-require-mark":!0,feedback:(_=d.value)==null?void 0:_.groupId},{default:t(()=>[e(k,{value:r.value.groupId,"onUpdate:value":a[0]||(a[0]=S=>r.value.groupId=S),options:I.value,placeholder:"Seleccione un grupo",clearable:!0,loading:l.value,disabled:l.value},null,8,["value","options","loading","disabled"])]),_:1},8,["feedback"])]}),_:1}),e(v,{span:24},{default:t(()=>{var _;return[e(h,{path:"type",label:"Tipo","show-require-mark":!0,feedback:(_=d.value)==null?void 0:_.type},{default:t(()=>[e(k,{value:r.value.type,"onUpdate:value":a[1]||(a[1]=S=>r.value.type=S),options:[{label:"TARDE",value:"TARDE"},{label:"FALTA",value:"FALTA"},{label:"OTROS",value:"OTROS"}],placeholder:"Seleccione el tipo",clearable:!0},null,8,["value"])]),_:1},8,["feedback"])]}),_:1}),e(v,{span:24},{default:t(()=>{var _;return[e(h,{path:"observations",label:"Observaciones","show-require-mark":!0,feedback:(_=d.value)==null?void 0:_.observations},{default:t(()=>[e(C,{value:r.value.observations,"onUpdate:value":a[2]||(a[2]=S=>r.value.observations=S),type:"textarea",placeholder:"Ingrese las observaciones",disabled:l.value},null,8,["value","disabled"])]),_:1},8,["feedback"])]}),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),Te={style:{"border-bottom":"1px solid #e9e9e9"}},Ve=A({__name:"DataTable",setup(o){const n=c(!1),i=c([]),u=c(!1),s=c(null),l=ie({...K()}),p=c({search:null,page:l.page,pageSize:l.pageSize}),r=c({}),I=ke(m=>{s.value=m,u.value=!0},async m=>{await Ie(m),await y()}),y=async()=>{p.value.page=1,await w()},w=async()=>{n.value=!0,r.value=await ze(p.value),i.value=r.value.data,l.total=r.value.total,l.pageSize=r.value.per_page,l.page=r.value.current_page,l.pageCount=r.value.last_page,n.value=!1},g=be(()=>{y()},400),a=async m=>{p.value.page=m,await w()},R=async m=>{p.value.page=1,p.value.pageSize=m,await w()};return(async()=>{await w()})(),(m,v)=>{const k=X,h=Y,C=Q,B=ye;return x(),H(J,null,[O("div",Te,[e(C,{gutter:12,style:{padding:"12px 16px"}},{default:t(()=>[e(k,{span:12}),e(k,{span:12},{default:t(()=>[e(h,{size:"large",placeholder:"Buscar",value:p.value.search,"onUpdate:value":v[0]||(v[0]=z=>p.value.search=z),onInput:f(g),clearable:""},{suffix:t(()=>[e(G,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),e(C,null,{default:t(()=>[e(k,{span:24},{default:t(()=>[e(B,{key:"id",remote:"",size:"small","single-line":!1,columns:f(I),data:i.value,pagination:f(xe)(l),"pagination-show-size-picker":!0,loading:n.value,"onUpdate:page":a,"onUpdate:pageSize":R},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),ue(m.$slots,"extra",{reLoadDataTable:y})]),e(Z,{modelValue:u.value,"onUpdate:modelValue":v[1]||(v[1]=z=>u.value=z),item:s.value,onSuccess:y},null,8,["modelValue","item"])],64)}}}),Ke=A({__name:"AcademicSupervisionView",setup(o){const{hasPermission:n}=L(),i=c(!1);return(u,s)=>{const l=P,p=j,r=W("AppNotAuthorization");return f(n)(["academic-supervision.create","academic-supervision.edit","academic-supervision.delete"])?(x(),H(J,{key:0},[e(p,{segmented:{header:!0,content:!0}},{header:t(()=>s[2]||(s[2]=[O("span",{class:"text-sm text-slate-500"}," Registro de supervisión académica ",-1),O("h5",{class:"text-lg font-bold text-slate-800"},"Supervisión académica",-1)])),"header-extra":t(()=>[f(n)(["academic-supervision.create"])?(x(),V(l,{key:0,size:"large",type:"primary","render-icon":f(E)("additem"),onClick:s[0]||(s[0]=d=>i.value=!0)},{default:t(()=>s[3]||(s[3]=[T(" Agregar ")])),_:1},8,["render-icon"])):M("",!0)]),_:1}),e(Ve,null,{extra:t(({reLoadDataTable:d})=>[e(Z,{modelValue:i.value,"onUpdate:modelValue":s[1]||(s[1]=b=>i.value=b),item:null,onSuccess:d},null,8,["modelValue","onSuccess"])]),_:1})],64)):(x(),V(r,{key:1}))}}});export{Ke as default};
