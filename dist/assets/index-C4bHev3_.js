import{r as b}from"./icon.utils-BkZ-Dn8n.js";import{d as T,a3 as I,e as L,a9 as w,aa as f,ab as o,ac as t,ag as P,aH as D,h as k,r as c,aJ as O,aG as N,_ as V,af as C,aK as R,ae as y,ad as J,aA as S,aB as K,aL as j}from"./index-DRRg_eBM.js";import{_ as B}from"./StudentForm.vue_vue_type_script_setup_true_lang-CN_c34dV.js";import{d as Q}from"./debounce.utils-DqPPCsFD.js";import{i as $}from"./DataTable.types-BEg5m_To.js";import{u as X}from"./composables-i7kb42iS.js";import{_ as Y}from"./Dropdown-CweT_dMY.js";import{N as E}from"./Tag-DLFVs5T4.js";import{_ as Z,a as ee,b as te}from"./student.services-xrSQ_Sb9.js";import{c as ae}from"./studentType.services-qFZjJDlz.js";import{c as oe}from"./documentType.services-lOLtMmx1.js";import{_ as ne,a as se}from"./Col-B7SFfu7K.js";import{_ as le}from"./Input-BJ4gQKpn.js";import{_ as re}from"./DataTable--fXJaN9P.js";import"./genders.constans-BK559Fh_.js";import"./useBreakpoints-BNPff5Lt.js";import"./Select-BARTLa82.js";import"./Popover-CJcKKGg6.js";import"./get-CpGV-8IY.js";import"./use-merged-state-CaVxhrEA.js";import"./Suffix-ByhxVsOv.js";import"./FormItem-BmvuZJcR.js";import"./Space-BljgdQMa.js";import"./Switch-DHyvHpJK.js";import"./Tooltip-BnJ19Urq.js";const ie=T({__name:"DataTableOp",props:{item:{}},emits:["edit","delete","create-user"],setup(l,{emit:u}){const n=u,a=X(),{hasPermission:e}=I(),s=l,r=L(()=>[{show:s.item.userId==null&&e(["student.create-account"]),label:"Crear cuenta de usuario",id:"create-user",key:"create-user",icon:b("security-user"),props:{onClick:()=>n("create-user")}},{show:e(["student.edit"]),label:"Editar",key:"edit",icon:b("edit-2"),props:{onClick:()=>n("edit")}},{show:e(["student.delete"]),label:"Eliminar",key:"delete",icon:b("trash","red"),props:{style:{color:"red"},onClick:()=>{a.warning({title:"Confirmar",content:"¿Está seguro que desea eliminar este registro?",positiveText:"Eliminar",negativeText:"Cancelar",closable:!1,showIcon:!0,negativeButtonProps:{size:"large"},positiveButtonProps:{size:"large",type:"error"},onPositiveClick:()=>{n("delete")}})}}}]);return(p,m)=>{const _=P,d=Y;return f(),w(d,{options:r.value,placement:"bottom-start"},{default:o(()=>[t(_,null,{default:o(()=>[t(D,{"icon-name":"setting-5",size:"20"})]),_:1})]),_:1},8,["options"])}}}),ue=(l,u,n)=>[{title:"Ops.",key:"ops",width:"80px",fixed:"left",render(a){const e=a;return k(ie,{onEdit:()=>{l(e)},onDelete:()=>{u(e)},onCreateUser:()=>{n(e)},item:e},{default:()=>"Editar"})}},{title:"Codigo",key:"code",minWidth:"100px"},{title:"Nro. Documento",key:"documentNumber",minWidth:"90px"},{title:"Nombre",key:"name",minWidth:"120px"},{title:"Apellido Paterno",key:"lastNameFather",minWidth:"100px"},{title:"Apellido Materno",key:"lastNameMother",minWidth:"100px"},{title:"Género",key:"gender",width:"75px"},{title:"Email",key:"email",minWidth:"130px"},{title:"Celular",key:"phone",minWidth:"100px"},{title:"Tipo de estudiante",key:"studentType",minWidth:"150px",render:a=>k(E,{tertiary:!0,bordered:!1,strong:!0},{default:()=>a.studentType})},{title:"Habilitado",key:"isEnabled",width:"150px",render:a=>k(E,{type:a.isEnabled?"success":"error",tertiary:!0,bordered:!1,strong:!0},{default:()=>a.isEnabled?"	Habilitado":"Deshabilitado"})}],pe=(l=$())=>({page:l.page,total:l.total,pageSize:l.pageSize,pageCount:l.pageCount,showSizePicker:!0,pageSizes:[10,50,100,500,1e3,5e3],style:{paddingRight:"16px",paddingBottom:"12px"},prefix(){return`Total ${l.total} registros`}}),de={style:{"border-bottom":"1px solid #e9e9e9"}},ce=T({__name:"DataTable",setup(l){const u=c(!1),n=c([]),a=c(!1),e=c(null),s=O({...$()}),r=c({search:null,page:s.page,pageSize:s.pageSize}),p=c({}),m=c({}),_=c([]),d=async()=>{r.value.page=1,console.log("reloading data table"),await v()},v=async()=>{u.value=!0,p.value=await Z(r.value),n.value=p.value.data,s.total=p.value.total,s.pageSize=p.value.per_page,s.page=p.value.current_page,s.pageCount=p.value.last_page,u.value=!1},U=Q(()=>{d()},400),W=async i=>{r.value.page=i,await v()},F=async i=>{r.value.page=1,r.value.pageSize=i,await v()},M=i=>{e.value=i,a.value=!0},A=async i=>{await ee(i),await d()},G=async i=>{await te(i)&&await d()};return(async()=>{_.value=ue(M,A,G),await v(),m.value.studentTypesItems=await ae(),m.value.documentTypesItems=await oe()})(),(i,g)=>{const x=se,H=le,z=ne,q=re;return f(),N(V,null,[C("div",de,[t(z,{gutter:12,style:{padding:"12px 16px"}},{default:o(()=>[t(x,{span:12}),t(x,{span:12},{default:o(()=>[t(H,{size:"large",placeholder:"Buscar",value:r.value.search,"onUpdate:value":g[0]||(g[0]=h=>r.value.search=h),onInput:y(U),clearable:""},{suffix:o(()=>[t(D,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),t(z,null,{default:o(()=>[t(x,{span:24},{default:o(()=>[t(q,{key:"id",remote:"",size:"small","single-line":!1,columns:_.value,data:n.value,pagination:y(pe)(s),"pagination-show-size-picker":!0,loading:u.value,"onUpdate:page":W,"onUpdate:pageSize":F},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),R(i.$slots,"extra",{reLoadDataTable:d,selectables:m.value})]),t(B,{modelValue:a.value,"onUpdate:modelValue":g[1]||(g[1]=h=>a.value=h),item:e.value,onSuccess:d,selectables:m.value},null,8,["modelValue","item","selectables"])],64)}}}),Me=T({__name:"index",setup(l){const{hasPermission:u}=I(),n=c(!1);return(a,e)=>{const s=P,r=K,p=j;return y(u)(["student.create"])?(f(),N(V,{key:0},[t(r,{segmented:{header:!0,content:!0}},{header:o(()=>e[2]||(e[2]=[C("span",{class:"text-sm text-slate-500"}," Gestión de Estudiantes ",-1),C("h5",{class:"text-lg font-bold text-slate-800"},"Estudiantes",-1)])),"header-extra":o(()=>[y(u)(["student.create"])?(f(),w(s,{key:0,size:"large",type:"primary","render-icon":y(b)("additem"),onClick:e[0]||(e[0]=m=>n.value=!0)},{default:o(()=>e[3]||(e[3]=[S(" Agregar ")])),_:1},8,["render-icon"])):J("",!0)]),_:1}),t(ce,null,{extra:o(({reLoadDataTable:m,selectables:_})=>[t(B,{modelValue:n.value,"onUpdate:modelValue":e[1]||(e[1]=d=>n.value=d),item:null,onSuccess:m,selectables:_},null,8,["modelValue","onSuccess","selectables"])]),_:1})],64)):(f(),w(p,{key:1,status:"403",title:"403 Forbidden",description:"Some of the doors are always close to you."},{footer:o(()=>[t(s,null,{default:o(()=>e[4]||(e[4]=[S("Take It Easy")])),_:1})]),_:1}))}}});export{Me as default};
