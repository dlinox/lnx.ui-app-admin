import{r as $}from"./icon.utils-CvbdSYhW.js";import{d as h,aa as z,a5 as G,a8 as t,ab as e,ag as H,af as B,h as F,an as X,e as Y,r as m,g as Z,ah as I,ai as j,aj as ee,ak as te,al as q,ad as R,ac as k,am as ae,_ as A}from"./index-B1moMmGf.js";import{i as L,a as ne}from"./DataTable.types-BIkVFYV7.js";import{_ as W}from"./Input-CnTYTM92.js";import{_ as oe,a as le}from"./FormItem-Dinphbxr.js";import{_ as J,a as K}from"./Col-Jp9hAiy_.js";import{_ as se}from"./Switch-BmkbJoFt.js";import{_ as re}from"./Space-DLhth_1u.js";import{d as ie}from"./debounce.utils-DqPPCsFD.js";import{u as ue}from"./composables-Dzo7p1MU.js";import{_ as pe}from"./Dropdown-56SzW5B2.js";import{N as de}from"./Select-CFNlPL_t.js";import{_ as me}from"./DataTable-CmGk2gV6.js";import"./get-DK0dPHvI.js";import"./Tooltip-BxjKzuTH.js";const ce=h({__name:"DataTableOp",props:{item:{}},emits:["edit","delete"],setup(l,{emit:n}){const u=ue(),a=n,p=[{label:"Editar",key:"edit",icon:$("edit-2"),props:{onClick:()=>a("edit")}},{label:"Eliminar",key:"delete",icon:$("trash","red"),props:{style:{color:"red"},onClick:()=>{u.warning({title:"Confirmar",content:"¿Está seguro que desea eliminar este registro?",positiveText:"Eliminar",negativeText:"Cancelar",closable:!1,showIcon:!1,negativeButtonProps:{secondary:!0,type:"tertiary",size:"large"},positiveButtonProps:{size:"large",type:"error"},onPositiveClick:()=>{a("delete")}})}}}];return(r,i)=>{const s=B,_=pe;return z(),G(_,{options:p,placement:"bottom-start"},{default:t(()=>[e(s,null,{default:t(()=>[e(H,{"icon-name":"setting-5",size:"20"})]),_:1})]),_:1})}}}),_e=(l,n)=>[{title:"Ops.",key:"ops",width:"80px",fixed:"left",render(u){const a=u;return F(ce,{onEdit:()=>{l(a)},onDelete:()=>{n(a)},item:a},{default:()=>"Editar"})}},{title:"Nombre",key:"name",minWidth:"300px"},{title:"Comisión (S/.)",key:"commission",width:"120px",align:"right"},{title:"Habilitado",key:"isEnabled",width:"150px",render:u=>F(de,{type:u.isEnabled?"success":"error",tertiary:!0,bordered:!1,strong:!0},{default:()=>u.isEnabled?"	Habilitado":"Deshabilitado"})}],ge=(l=L())=>({page:l.page,total:l.total,pageSize:l.pageSize,pageCount:l.pageCount,showSizePicker:!0,pageSizes:[10,50,100,500,1e3,5e3],style:{paddingRight:"16px",paddingBottom:"12px"},prefix(){return`Total ${l.total} registros`}}),M=()=>({id:null,name:null,isEnabled:!0}),fe=()=>({name:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}]}),D=X(),P="/payment-type",ve=async l=>{try{return(await D.post(`${P}/load-data-table`,l)).data.data}catch{return ne()}},be=async l=>{try{return{status:!0,data:(await D.post(`${P}/save`,l)).data.data}}catch(n){return n.response.status===422?{status:!1,data:n.response.data.errors}:{status:!1,data:null}}},ye=async l=>{try{return await D.delete(`${P}`,{data:{id:l.id}}),!0}catch{return!1}},Q=h({__name:"PaymentTypeForm",props:{item:{},modelValue:{type:Boolean}},emits:["update:modelValue","success"],setup(l,{emit:n}){const u=n,a=l,p=Y({get:()=>a.modelValue,set:d=>u("update:modelValue",d)}),r=m(!1),i=m(null),s=m(M()),_=m(null),U=m({...fe()}),E=async()=>{if(i.value){const d=await i.value.validate();let o=null;d?(r.value=!0,o=await be(s.value),o.status?(u("success"),p.value=!1):_.value=o.data):console.log("Formulario inválido")}r.value=!1},v=()=>{s.value=a.item?{...a.item}:M()};return Z(p,d=>{d&&v()}),(d,o)=>{const T=W,x=oe,S=J,c=se,g=re,b=K,C=le,y=B,V=j,w=ee;return z(),G(w,{show:p.value,"onUpdate:show":o[4]||(o[4]=f=>p.value=f)},{default:t(()=>[e(V,{style:{width:"500px"},title:d.item?"EDITAR REGISTRO":"NUEVO REGISTRO",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:t(()=>[e(g,{justify:"end"},{default:t(()=>[e(y,{tertiary:"",size:"large",onClick:o[3]||(o[3]=f=>p.value=!1),disabled:r.value},{default:t(()=>o[5]||(o[5]=[I(" Cancelar ")])),_:1},8,["disabled"]),e(y,{size:"large",type:"primary",onClick:E,loading:r.value},{default:t(()=>o[6]||(o[6]=[I("Guardar")])),_:1},8,["loading"])]),_:1})]),default:t(()=>[e(C,{ref_key:"formRef",ref:i,model:s.value,rules:U.value,size:"large"},{default:t(()=>[e(b,null,{default:t(()=>[e(S,{span:"24"},{default:t(()=>{var f;return[e(x,{path:"name",label:"Nombre",feedback:(f=_.value)==null?void 0:f.name},{default:t(()=>{var N;return[e(T,{status:((N=_.value)==null?void 0:N.name)!=null?"error":"",value:s.value.name,"onUpdate:value":o[0]||(o[0]=O=>s.value.name=O),onInput:o[1]||(o[1]=O=>_.value!=null?_.value.name=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1}),e(S,{span:"24"},{default:t(()=>[e(g,{justify:"end"},{default:t(()=>[e(x,{"label-placement":"left",label:"¿Habilitado?",path:"isEnabled","show-feedback":!1},{default:t(()=>[e(c,{value:s.value.isEnabled,"onUpdate:value":o[2]||(o[2]=f=>s.value.isEnabled=f)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),we={style:{"border-bottom":"1px solid #e9e9e9"}},xe=h({__name:"DataTable",setup(l){const n=m(!1),u=m([]),a=m(!1),p=m(null),r=te({...L()}),i=m({search:null,page:r.page,pageSize:r.pageSize}),s=m({}),E=_e(c=>{p.value=c,a.value=!0},async c=>{await ye(c),await v()}),v=async()=>{i.value.page=1,await d()},d=async()=>{n.value=!0,s.value=await ve(i.value),u.value=s.value.data,r.total=s.value.total,r.pageSize=s.value.per_page,r.page=s.value.current_page,r.pageCount=s.value.last_page,n.value=!1},o=ie(()=>{v()},400),T=async c=>{i.value.page=c,await d()},x=async c=>{i.value.page=1,i.value.pageSize=c,await d()};return(async()=>{await d()})(),(c,g)=>{const b=J,C=W,y=K,V=me;return z(),q(A,null,[R("div",we,[e(y,{gutter:12,style:{padding:"12px 16px"}},{default:t(()=>[e(b,{span:12}),e(b,{span:12},{default:t(()=>[e(C,{size:"large",placeholder:"Buscar",value:i.value.search,"onUpdate:value":g[0]||(g[0]=w=>i.value.search=w),onInput:k(o),clearable:""},{suffix:t(()=>[e(H,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),e(y,null,{default:t(()=>[e(b,{span:24},{default:t(()=>[e(V,{key:"id",remote:"","single-line":!1,columns:k(E),data:u.value,pagination:k(ge)(r),"pagination-show-size-picker":!0,loading:n.value,"onUpdate:page":T,"onUpdate:pageSize":x},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),ae(c.$slots,"extra",{reLoadDataTable:v})]),e(Q,{modelValue:a.value,"onUpdate:modelValue":g[1]||(g[1]=w=>a.value=w),item:p.value,onSuccess:v},null,8,["modelValue","item"])],64)}}}),Ne=h({__name:"index",setup(l){const n=m(!1);return(u,a)=>{const p=B,r=j;return z(),q(A,null,[e(r,{segmented:{header:!0,content:!0}},{header:t(()=>a[2]||(a[2]=[R("span",{class:"text-sm text-slate-500"}," Gestionar los tipos de pago ",-1),R("h5",{class:"text-lg font-bold text-slate-800"},"Tipos de pago",-1)])),"header-extra":t(()=>[e(p,{"render-icon":k($)("additem"),onClick:a[0]||(a[0]=i=>n.value=!0)},{default:t(()=>a[3]||(a[3]=[I(" Agregar ")])),_:1},8,["render-icon"])]),_:1}),e(xe,null,{extra:t(({reLoadDataTable:i})=>[e(Q,{modelValue:n.value,"onUpdate:modelValue":a[1]||(a[1]=s=>n.value=s),item:null,onSuccess:i},null,8,["modelValue","onSuccess"])]),_:1})],64)}}});export{Ne as default};
