import{r as ee}from"./icon.utils-BQfYQcDe.js";import{_ as ae,u as te,a as ne}from"./period.stores-C9HnWHFY.js";import{d as R}from"./debounce.utils-DqPPCsFD.js";import{b as le}from"./selectables.services-C9LRGVu0.js";import{h as I,af as F,d as M,e as O,r as p,g as oe,aa as T,a5 as se,a8 as t,ab as a,ah as U,ac as S,ai as j,aj as re,ak as ue,al as A,ad as $,ag as ie,am as de,_ as q}from"./index-BOXL2TiF.js";import{_ as pe}from"./Select-Biy6SjtC.js";import{_ as me,a as ce}from"./FormItem-C4wDlZap.js";import{_ as W,a as G}from"./Col-BTffZrwQ.js";import{_ as H}from"./Input-C8gwYOc9.js";import{_ as _e}from"./Switch-TLL8GsvW.js";import{_ as ve}from"./Space-CbJKgSxe.js";import{i as J}from"./DataTable.types-B90ErchY.js";import{_ as fe}from"./DataTable-D2zYKQJM.js";import"./index-ChN7EhXt.js";import"./get-DOtZouVG.js";import"./Tooltip-BHYxHC_t.js";import"./Dropdown-d17eZhwV.js";function L(r){const s=new Date(r);return new Intl.DateTimeFormat("es-ES",{day:"2-digit",month:"long"}).format(s).replace(" "," de ")}const ge=r=>[{title:"Ops.",key:"ops",width:"80px",fixed:"left",render(s){const o=s;return I(F,{disabled:o.type==="AMPLIACION",onClick:()=>{r(o)},item:o},{default:()=>"Ampliación"})}},{title:"Periodo",key:"period",minWidth:"120px"},{title:"Fecha de Inicio",key:"startDate",minWidth:"140px",render(s){const o=s;return I("span",{},{default:()=>L(o.startDate)})}},{title:"Fecha de Fin",key:"endDate",minWidth:"140px",render(s){const o=s;return I("span",{},{default:()=>L(o.endDate)})}},{title:"Tipo",key:"type",width:"120px"},{title:"Matrícula Virtual",key:"virtual",width:"120px",render(s){const o=s;return I("span",{},{default:()=>o.virtual?"Habilitado":"No habilitado"})}},{title:"Observaciones",key:"observations",minWidth:"200px"}],be=(r=J())=>({page:r.page,total:r.total,pageSize:r.pageSize,pageCount:r.pageCount,showSizePicker:!0,pageSizes:[10,50,100,500,1e3],style:{paddingRight:"16px",paddingBottom:"12px"},prefix(){return`Total ${r.total} registros`}}),N=()=>({id:null,startDate:null,endDate:null,observations:"",periodId:null,virtual:!0}),De=r=>({startDate:[{required:!0,trigger:["blur","input"],message:"Obligatorio"},{message:"La fecha de inicio debe ser menor",trigger:"blur",validator:(s,o)=>r.endDate&&o>r.endDate?Promise.reject("La fecha de inicio debe ser menor"):Promise.resolve()}],endDate:[{required:!0,trigger:["blur","input"],message:"Obligatorio"},{message:"La fecha de fin debe ser mayor",trigger:"blur",validator:(s,o)=>r.startDate&&o<r.startDate?Promise.reject("La fecha de fin debe ser mayor"):Promise.resolve()}],periodId:[{type:"number",required:!0,trigger:["blur","input"],message:"Obligatorio"}]}),K=M({__name:"Form",props:{item:{},modelValue:{type:Boolean}},emits:["update:modelValue","success"],setup(r,{emit:s}){const o=s,u=r,c=O({get:()=>u.modelValue,set:m=>o("update:modelValue",m)}),v=p(!1),d=p(null),n=p(N()),l=p(null),E=O(()=>({...De(n.value)})),k=p(!1),D=p([]),g=async m=>{k.value=!0,D.value=await le(m),k.value=!1},P=R(m=>{g(m)},400),z=async()=>{if(d.value){const m=await d.value.validate();let e=null;m&&(v.value=!0,e=await ae(n.value),e.status?(o("success"),c.value=!1):l.value=e.data)}v.value=!1},V=()=>{n.value=u.item?{...u.item,startDate:u.item.lastDate?u.item.lastDate.slice(0,10):null,endDate:null,observations:null}:N()};return oe(c,m=>{m&&(l.value=null,g(""),V())}),(m,e)=>{const y=pe,f=me,b=W,w=H,C=_e,h=ve,Q=G,X=ce,B=F,Y=j,Z=re;return T(),se(Z,{show:c.value,"onUpdate:show":e[10]||(e[10]=i=>c.value=i)},{default:t(()=>[a(Y,{style:{width:"500px"},title:m.item?"Editar registro":"Nuevo registro",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:t(()=>[a(h,{justify:"end"},{default:t(()=>[a(B,{tertiary:"",size:"large",onClick:e[9]||(e[9]=i=>c.value=!1),disabled:v.value},{default:t(()=>e[11]||(e[11]=[U(" Cancelar ")])),_:1},8,["disabled"]),a(B,{size:"large",type:"primary",onClick:z,loading:v.value},{default:t(()=>e[12]||(e[12]=[U("Guardar")])),_:1},8,["loading"])]),_:1})]),default:t(()=>[a(X,{ref_key:"formRef",ref:d,model:n.value,rules:E.value,size:"large"},{default:t(()=>[a(Q,{gutter:16},{default:t(()=>[a(b,{span:"24"},{default:t(()=>{var i;return[a(f,{path:"periodId",label:"Periodo",feedback:(i=l.value)==null?void 0:i.periodId},{default:t(()=>[a(y,{value:n.value.periodId,"onUpdate:value":[e[0]||(e[0]=_=>n.value.periodId=_),e[1]||(e[1]=()=>l.value!=null?l.value.periodId=null:()=>{})],placeholder:"Seleccionar Periodo Académico",filterable:"",options:D.value,loading:k.value,clearable:"",remote:"",disabled:n.value.id!=null,"virtual-scroll":!1,onSearch:S(P)},null,8,["value","options","loading","disabled","onSearch"])]),_:1},8,["feedback"])]}),_:1}),a(b,{span:"12"},{default:t(()=>{var i;return[a(f,{path:"startDate",label:"Fecha de inicio",feedback:(i=l.value)==null?void 0:i.startDate},{default:t(()=>{var _;return[a(w,{type:"date",disabled:n.value.id!=null,value:n.value.startDate,"onUpdate:value":[e[2]||(e[2]=x=>n.value.startDate=x),e[3]||(e[3]=()=>l.value!=null?l.value.startDate=null:()=>{})],status:((_=l.value)==null?void 0:_.startDate)!=null?"error":"",clearable:"",placeholder:""},null,8,["disabled","value","status"])]}),_:1},8,["feedback"])]}),_:1}),a(b,{span:"12"},{default:t(()=>{var i;return[a(f,{path:"endDate",label:"Fecha de fin",feedback:(i=l.value)==null?void 0:i.endDate},{default:t(()=>{var _;return[a(w,{type:"date",placeholder:"",value:n.value.endDate,"onUpdate:value":[e[4]||(e[4]=x=>n.value.endDate=x),e[5]||(e[5]=()=>l.value!=null?l.value.endDate=null:()=>{})],status:((_=l.value)==null?void 0:_.endDate)!=null?"error":"",clearable:""},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1}),a(b,{span:"24"},{default:t(()=>{var i;return[a(f,{path:"observations",label:"Observaciones",feedback:(i=l.value)==null?void 0:i.observations},{default:t(()=>{var _;return[a(w,{type:"textarea",value:n.value.observations,"onUpdate:value":[e[6]||(e[6]=x=>n.value.observations=x),e[7]||(e[7]=()=>l.value!=null?l.value.observations=null:()=>{})],status:((_=l.value)==null?void 0:_.observations)!=null?"error":"",clearable:"",placeholder:"Ingrese observaciones"},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1}),a(b,{span:"24"},{default:t(()=>[a(h,{justify:"end"},{default:t(()=>[a(f,{"label-placement":"left",label:"Matrícula virtual",path:"isEnabled","show-feedback":!1},{default:t(()=>[a(C,{value:n.value.virtual,"onUpdate:value":e[8]||(e[8]=i=>n.value.virtual=i)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),ye={style:{"border-bottom":"1px solid #e9e9e9"}},we=M({__name:"DataTable",setup(r){const s=te(),o=p(!1),u=p([]),c=p(!1),v=p(null),d=ue({...J()}),n=p({search:null,page:d.page,pageSize:d.pageSize}),l=p({}),k=ge(e=>{v.value=e,c.value=!0}),D=async()=>{n.value.page=1,await g()},g=async()=>{o.value=!0,await s.getEnrollment(),l.value=await ne(n.value),u.value=l.value.data,d.total=l.value.total,d.pageSize=l.value.per_page,d.page=l.value.current_page,d.pageCount=l.value.last_page,o.value=!1},P=R(()=>{D()},400),z=async e=>{n.value.page=e,await g()},V=async e=>{n.value.page=1,n.value.pageSize=e,await g()};return(async()=>{await g()})(),(e,y)=>{const f=W,b=H,w=G,C=fe;return T(),A(q,null,[$("div",ye,[a(w,{gutter:12,style:{padding:"12px 16px"}},{default:t(()=>[a(f,{span:12}),a(f,{span:12},{default:t(()=>[a(b,{size:"large",placeholder:"Buscar",value:n.value.search,"onUpdate:value":y[0]||(y[0]=h=>n.value.search=h),onInput:S(P),clearable:""},{suffix:t(()=>[a(ie,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),a(w,null,{default:t(()=>[a(f,{span:24},{default:t(()=>[a(C,{key:"id",remote:"","single-line":!1,columns:S(k),data:u.value,pagination:S(be)(d),"pagination-show-size-picker":!0,loading:o.value,"onUpdate:page":z,"onUpdate:pageSize":V},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),de(e.$slots,"extra",{reLoadDataTable:D})]),a(K,{modelValue:c.value,"onUpdate:modelValue":y[1]||(y[1]=h=>c.value=h),item:v.value,onSuccess:D},null,8,["modelValue","item"])],64)}}}),Le=M({__name:"EnrollmentDeadlineView",setup(r){const s=p(!1);return(o,u)=>{const c=F,v=j;return T(),A(q,null,[a(v,{segmented:{header:!0,content:!0}},{header:t(()=>u[2]||(u[2]=[$("span",{class:"text-sm text-slate-500"},"Gestión de Periodos de Matrícula",-1),$("h5",{class:"text-lg font-bold text-slate-800"},"Periodos de Matrícula",-1)])),"header-extra":t(()=>[a(c,{"render-icon":S(ee)("additem"),onClick:u[0]||(u[0]=d=>s.value=!0)},{default:t(()=>u[3]||(u[3]=[U(" Agregar ")])),_:1},8,["render-icon"])]),_:1}),a(we,null,{extra:t(({reLoadDataTable:d})=>[a(K,{modelValue:s.value,"onUpdate:modelValue":u[1]||(u[1]=n=>s.value=n),item:null,onSuccess:d},null,8,["modelValue","onSuccess"])]),_:1})],64)}}});export{Le as default};
