import{d as ie,a3 as de,a5 as me,r as i,aD as pe,a8 as ce,aN as _e,aG as h,a9 as v,ae as p,aa as s,ac as o,af as t,ab as e,aB as fe,aA as f,ah as r,w as ve,_ as x,aL as R,ad as C,ag as ge}from"./index-DJC0BDyi.js";import{r as he}from"./icon.utils-BskQV8nf.js";import{u as be}from"./useBreakpoints-BhByDZGO.js";import{d as ye,e as Ie,f as Se,h as we}from"./EditEnrollmentGroup.vue_vue_type_script_setup_true_lang-7CvFCngc.js";import"./studentType.services-ks8_o98X.js";import{j as Ne}from"./student.services-ZHOutMje.js";import"./documentType.services-PTXLfbbz.js";import{_ as ke,a as Ee}from"./selectables.services-S-WFd6Ss.js";import{u as xe}from"./period.stores-CdXAXpMt.js";import{d as Ce}from"./debounce.utils-DqPPCsFD.js";import{_ as $e}from"./Select-DspmZ1pU.js";import{a as Pe,_ as Me}from"./Col-C21edevQ.js";import{_ as Ae}from"./Spin-dbEnzqta.js";import{_ as Be}from"./Space-B52NGJNL.js";import{_ as De}from"./Statistic-BwVQMhAY.js";import{_ as Ve,a as Re}from"./CollapseItem-BoZMOQO4.js";import{a as ze,_ as Fe}from"./ListItem-C4iNgzvu.js";import{_ as Te}from"./Thing-B2WvJBao.js";import{_ as Ue}from"./Table-BpmzSwUW.js";import{N as Le}from"./Tag-Dk2E0f9P.js";import"./course.services-BaqRewrM.js";import"./DataTable.types-BEg5m_To.js";import"./Alert-DmCNILB5.js";import"./FormItem-hkNBqYHR.js";import"./get-8hg4PRDN.js";import"./Input-DBFrJf3T.js";import"./Suffix-DoGO01ad.js";import"./use-merged-state-Cj4Aargr.js";import"./Switch-BVWaAsm_.js";import"./composables-Blw5S8Da.js";import"./Dropdown-BOxrGR0y.js";import"./Popover-0ZzN24Gj.js";const je={class:"p-4"},Oe={class:"flex bg-gray-100 p-4 -mx-6 -mt-6 mb-4"},Ge={class:"text-lg font-semibold w-full text-blue-800 p-2"},We={key:1},kt=ie({__name:"EnrollmentSpecialStudentView",setup(qe){const{hasPermission:J}=de(),{screenSize:z}=be(),F=me(),b=xe(),$=i(!1),y=i(null),K=i(null),P=i([]),T=i([]),M=i(!1),A=i(!0),c=i({}),U=i(!0),L=i(null),j=i(null),O=i(null),k=i(null),Q=Ce(d=>{G(d)},400),G=async d=>{M.value=!0,T.value=await Ee(d),M.value=!1},X=async d=>{let l=await Se({id:d}),g=new Blob([l],{type:"application/pdf"}),S=window.URL.createObjectURL(g),_=document.getElementById("printFrame");_.src=S,_.onload=function(){var w;(w=_.contentWindow)==null||w.print()}},Y=async()=>{const d=F.params.id;A.value=!0,c.value=await Ne(d),A.value=!1},I=async()=>{var g;const d=F.params.id,l=(g=K.value)==null?void 0:g.id;U.value=!0,L.value=await we(d,y.value,l),U.value=!1},B=(d,l=null)=>{j.value=d,O.value=l,$.value=!0},Z=async()=>{P.value=await ke(),y.value=P.value[0].value,await G(""),Y(),I()};return pe(()=>{Z()}),(d,l)=>{const g=$e,S=fe,_=De,w=Be,ee=Ae,D=Pe,V=Le,W=Me,q=ge,te=Ue,ne=Te,le=Fe,oe=ze,ae=Re,re=Ve,se=ce("AppNotAuthorization"),ue=_e("permission");return p(J)(["enrollment.create-special"])?(s(),h(x,{key:0},[o(S,{segmented:{header:!0,footer:!0,content:!0}},{header:e(()=>l[3]||(l[3]=[t("span",{class:"text-sm text-slate-500"}," Matricular estudiante ",-1),t("h5",{class:"text-lg font-bold text-slate-800"},"Matricula Especial",-1)])),"header-extra":e(()=>[o(g,{value:y.value,"onUpdate:value":[l[0]||(l[0]=n=>y.value=n),I],placeholder:"Seleccionar Plan de estudio",filterable:"",options:P.value,"virtual-scroll":!1,"default-value":1},null,8,["value","options"])]),action:e(()=>l[4]||(l[4]=[])),_:1}),t("div",je,[o(W,{gutter:16},{default:e(()=>[o(D,{span:p(z)=="lg"?6:24},{default:e(()=>[o(S,{segmented:{header:!0,content:!0},title:"Información Personal",subtitle:"Datos del estudiante"},{default:e(()=>[o(ee,{show:A.value},{default:e(()=>[o(w,{vertical:""},{default:e(()=>[o(_,{class:"small",label:"Tipo de estudiante"},{default:e(()=>{var n;return[f(r((n=c.value)==null?void 0:n.studentType),1)]}),_:1}),o(_,{class:"small",label:"Documento"},{default:e(()=>{var n,u;return[f(r((n=c.value)!=null&&n.documentNumber?(u=c.value)==null?void 0:u.documentNumber:"No registrado"),1)]}),_:1}),o(_,{class:"small",label:"Nombres"},{default:e(()=>{var n;return[f(r((n=c.value)==null?void 0:n.fullName),1)]}),_:1}),o(_,{class:"small",label:"Correo electronico"},{default:e(()=>{var n,u;return[f(r((n=c.value)!=null&&n.email?(u=c.value)==null?void 0:u.email:"No registrado"),1)]}),_:1}),o(_,{class:"small",label:"Telefono"},{default:e(()=>{var n,u;return[f(r((n=c.value)!=null&&n.phone?(u=c.value)==null?void 0:u.phone:"No registrado"),1)]}),_:1})]),_:1})]),_:1},8,["show"])]),_:1})]),_:1},8,["span"]),o(D,{span:p(z)=="lg"?18:24},{default:e(()=>[o(S,{segmented:{header:!0,content:!0},title:"Matricula"},{"header-extra":e(()=>[o(V,{bordered:!1,type:p(b).enrollment?"info":"error"},{default:e(()=>{var n;return[t("strong",null,r(p(b).enrollment?(n=p(b).enrollment)==null?void 0:n.period:"No habilitado"),1)]}),_:1},8,["type"])]),default:e(()=>[ve((s(),h("div",Oe,[o(W,null,{default:e(()=>[o(D,{span:"24"},{default:e(()=>[o(g,{value:k.value,"onUpdate:value":l[1]||(l[1]=n=>k.value=n),placeholder:"Seleccionar Periodo Académico",filterable:"",options:T.value,loading:M.value,clearable:"",remote:"",size:"large","virtual-scroll":!1,onSearch:p(Q)},null,8,["value","options","loading","onSearch"])]),_:1})]),_:1})])),[[ue,["enrollment.extraordinary"]]]),o(re,null,{default:e(()=>{var n;return[(s(!0),h(x,null,R((n=L.value)==null?void 0:n.enrollments,u=>(s(),v(ae,{key:u.moduleId,name:u.moduleId},{header:e(()=>[t("h2",Ge,r(u.moduleName)+" "+r(u.isExtracurricular?"(Extracurricular)":""),1)]),default:e(()=>[o(oe,{hoverable:"",clickable:""},{default:e(()=>[(s(!0),h(x,null,R(u.courses,m=>(s(),v(le,{key:m.id},{default:e(()=>[o(ne,{title:`${m.code} - ${m.name}`},{"header-extra":e(()=>[m.enrollmentGroups.length==0||m.enrollmentGroups.filter(a=>{var N;return a.period==((N=p(b).enrollment)==null?void 0:N.period)}).length==0?(s(),v(q,{key:0,type:"primary",onClick:a=>B(m.id)},{default:e(()=>l[5]||(l[5]=[f(" Matricular ")])),_:2},1032,["onClick"])):C("",!0)]),description:e(()=>[o(w,{size:"small"},{default:e(()=>[o(V,{bordered:!1,size:"small"},{default:e(()=>[f(" Area: "+r(m.area),1)]),_:2},1024)]),_:2},1024)]),default:e(()=>[m.enrollmentGroups.length>0?(s(),v(te,{key:0,"single-line":!1},{default:e(()=>[l[7]||(l[7]=t("thead",null,[t("tr",null,[t("th",{colspan:"2"},"Matricula"),t("th",{colspan:"3"},"Grupo"),t("th",{colspan:"2"})]),t("tr",null,[t("th",null,"Periodo"),t("th",null,"Estado"),t("th",null,"Grupo"),t("th",null,"Modalidad"),t("th",null,"Estado"),t("th",{rowspan:"2"},"Nota"),t("th",null,"Acciones")])],-1)),t("tbody",null,[(s(!0),h(x,null,R(m.enrollmentGroups,a=>{var N,H;return s(),h("tr",null,[t("td",null,[((N=p(b).enrollment)==null?void 0:N.period)==a.period?(s(),v(V,{key:0,type:"info"},{default:e(()=>[f(r(a.period),1)]),_:2},1024)):(s(),h("span",We,r(a.period),1))]),t("td",null,r(a.enrollmentStatus),1),t("td",null,r(a.groupName),1),t("td",null,r(a.groupModality),1),t("td",null,r(a.groupStatus),1),t("td",null,r(a.grade),1),t("td",null,[((H=p(b).enrollment)==null?void 0:H.period)==a.period||a.periodId==k.value?(s(),v(ye,{key:0,item:a,onResetEnrollment:E=>B(m.id,E),onChangeGroup:E=>B(m.id,E),onReserveEnrollment:I,onCancelEnrollment:I},null,8,["item","onResetEnrollment","onChangeGroup"])):C("",!0),a.enrollmentStatus==="MATRICULADO"?(s(),v(q,{key:1,"render-icon":p(he)("printer"),onClick:E=>X(a.id)},{default:e(()=>l[6]||(l[6]=[f(" Ficha ")])),_:2},1032,["render-icon","onClick"])):C("",!0)])])}),256))])]),_:2},1024)):C("",!0)]),_:2},1032,["title"])]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["name"]))),128))]}),_:1})]),_:1})]),_:1},8,["span"])]),_:1})]),l[8]||(l[8]=t("iframe",{id:"printFrame",style:{display:"none"}},null,-1)),o(Ie,{modelValue:$.value,"onUpdate:modelValue":l[2]||(l[2]=n=>$.value=n),studentId:c.value.id,curriculumId:y.value,courseId:j.value,enrollmetGroup:O.value,periodId:k.value,isSpecial:!0,onSuccess:I},null,8,["modelValue","studentId","curriculumId","courseId","enrollmetGroup","periodId"])],64)):(s(),v(se,{key:1}))}}});export{kt as default};
