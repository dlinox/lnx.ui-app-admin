import{r as z}from"./icon.utils-Cdau1lmo.js";import{G as ne}from"./genders.constans-BK559Fh_.js";import{u as le}from"./useBreakpoints-BU-ftBRs.js";import{d as F,aK as oe,e as H,a8 as j,a9 as D,aa as a,ab as e,af as W,aG as L,h as B,ay as se,r as f,j as re,aL as ue,aA as J,ad as _,w as P,az as R,aH as ie,aI as de,aF as K,_ as Q,ae as A,aJ as pe}from"./index--Fiy2I4t.js";import{i as X,a as me}from"./DataTable.types-BEg5m_To.js";import{_ as ce,a as _e}from"./FormItem-64Oo6hS7.js";import{_ as Y,a as Z}from"./Col-Bhohzmu6.js";import{_ as ve}from"./Select-JHMV7BBf.js";import{_ as ee}from"./Input-CfWAw0Qs.js";import{_ as fe}from"./Space-CHReEK5D.js";import{_ as ge}from"./Switch-DDt0T-WF.js";import{d as be}from"./debounce.utils-DqPPCsFD.js";import{u as ye}from"./composables-CN96FFP-.js";import{_ as he}from"./Dropdown-B9vn1Rts.js";import{_ as q}from"./Tag-CmlrV2vM.js";import{c as we}from"./documentType.services-DsNWuLGx.js";import{_ as Ne}from"./DataTable-D69-Uvxy.js";import"./get-BxuUz3sF.js";import"./Popover-_nZkNipR.js";import"./use-merged-state-Hew3oQWq.js";import"./Suffix-Cejid3DV.js";import"./get-slot-Bk_rJcZu.js";import"./Tooltip-B09_9Vum.js";const ke=F({__name:"DataTableOp",props:{item:{}},emits:["edit","delete","createUser"],setup(r,{emit:l}){const g=l,o=ye(),{hasPermission:u}=oe(),p=r,m=H(()=>[{show:p.item.userId==null&&u([""]),label:"Crear cuenta de usuario",id:"create-user",key:"create-user",icon:z("security-user"),props:{onClick:()=>g("createUser")}},{label:"Editar",key:"edit",icon:z("edit-2"),props:{onClick:()=>g("edit")}},{label:"Eliminar",key:"delete",icon:z("trash","red"),props:{style:{color:"red"},onClick:()=>{o.warning({title:"Confirmar",content:"¿Está seguro que desea eliminar este registro?",positiveText:"Eliminar",negativeText:"Cancelar",closable:!1,showIcon:!1,negativeButtonProps:{size:"large"},positiveButtonProps:{size:"large",type:"error"},onPositiveClick:()=>{g("delete")}})}}}]);return(v,n)=>{const i=W,E=he;return D(),j(E,{options:m.value,placement:"bottom-start"},{default:a(()=>[e(i,null,{default:a(()=>[e(L,{"icon-name":"setting-5",size:"20"})]),_:1})]),_:1},8,["options"])}}}),Ie=(r,l,g)=>[{title:"Ops.",key:"ops",width:"80px",fixed:"left",render(o){const u=o;return B(ke,{onEdit:()=>{r(u)},onDelete:()=>{l(u)},onCreateUser:()=>{g(u)},item:u},{default:()=>"Editar"})}},{title:"Codigo",key:"code",minWidth:"120px"},{title:"Número de documento",key:"documentNumber",minWidth:"120px"},{title:"Nombre",key:"name",minWidth:"120px"},{title:"Apellido Paterno",key:"lastNameFather",minWidth:"120px"},{title:"Apellido Materno",key:"lastNameMother",minWidth:"120px"},{title:"Género",key:"gender",minWidth:"150px",render:o=>B(q,{tertiary:!0,bordered:!1,strong:!0},{default:()=>o.gender===1?"MASCULINO":o.gender===2?"FEMENINO":"NO ESPECIFICADO"})},{title:"Email",key:"email",minWidth:"80px"},{title:"Teléfono",key:"phone",minWidth:"100px"},{title:"Habilitado",key:"isEnabled",width:"150px",render:o=>B(q,{type:o.isEnabled?"success":"error",tertiary:!0,bordered:!1,strong:!0},{default:()=>o.isEnabled?"	Habilitado":"Deshabilitado"})}],xe=(r=X())=>({page:r.page,total:r.total,pageSize:r.pageSize,pageCount:r.pageCount,showSizePicker:!0,pageSizes:[10,50,100,500,1e3,5e3],style:{paddingRight:"16px",paddingBottom:"12px"},prefix(){return`Total ${r.total} registros`}}),G=()=>({id:null,personId:null,code:null,documentTypeId:1,documentNumber:null,name:null,lastNameFather:null,lastNameMother:null,gender:null,email:null,phone:null,address:null,isEnabled:!0}),Te=()=>({code:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}],documentNumber:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}],name:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}],lastNameFather:[],lastNameMother:[],gender:[],email:[],phone:[],address:[],TeacherTypeId:[{type:"number",required:!0,trigger:["blur","input"],message:"Obligatorio"}]}),x=se(),Ee=async r=>{try{return(await x.post("/teacher/load-data-table",r)).data.data}catch{return me()}},Ce=async r=>{try{return(await x.get(`/teacher/item/by-id/${r}`)).data.data}catch{return G()}},Se=async r=>{try{return{status:!0,data:(await x.post("/teacher",r)).data.data}}catch(l){return l.response.status===422?{status:!1,data:l.response.data.errors}:{status:!1,data:null}}},Ue=async r=>{try{return{status:!0,data:(await x.put("/teacher",r)).data.data}}catch(l){return l.response.status===422?{status:!1,data:l.response.data.errors}:{status:!1,data:null}}},ze=async r=>{try{return await x.delete("/teacher",{data:{id:r.id}}),!0}catch{return!1}},Fe=async r=>{try{return await x.post("/teacher/create-user",r),!0}catch{return!1}},te=F({__name:"TeacherForm",props:{item:{},modelValue:{type:Boolean},selectables:{}},emits:["update:modelValue","success"],setup(r,{emit:l}){const g=l,o=r,{screenSize:u}=le(),p=H({get:()=>o.modelValue,set:c=>g("update:modelValue",c)}),m=f(!1),v=f(null),n=f(G()),i=f(null),E=f({...Te()}),$=async()=>{if(v.value){const c=await v.value.validate();let t=null;c?(m.value=!0,n.value.id?t=await Ue(n.value):t=await Se(n.value),t.status?(g("success"),p.value=!1):i.value=t.data):console.log("Formulario inválido")}m.value=!1},M=async()=>{var c;return(c=o.item)!=null&&c.id?n.value=await Ce(o.item.id):n.value=G(),n.value},N=async()=>{console.log("Inicializando formulario"),await M()};return re(p,c=>{c&&N()}),(c,t)=>{const C=ve,b=_e,y=Z,d=ee,k=ge,I=fe,V=Y,S=ce,U=W,T=J,ae=ie,O=ue("upper-case");return D(),j(ae,{show:p.value,"onUpdate:show":t[15]||(t[15]=s=>p.value=s)},{default:a(()=>[e(T,{style:{width:"1024px"},title:c.item?"EDITAR REGISTRO":"NUEVO REGISTRO",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:a(()=>[e(I,{justify:"end"},{default:a(()=>[e(U,{tertiary:"",size:"large",onClick:t[14]||(t[14]=s=>p.value=!1),disabled:m.value},{default:a(()=>t[16]||(t[16]=[R(" Cancelar ")])),_:1},8,["disabled"]),e(U,{size:"large",type:"primary",onClick:$,loading:m.value},{default:a(()=>t[17]||(t[17]=[R("Guardar")])),_:1},8,["loading"])]),_:1})]),default:a(()=>[e(S,{ref_key:"formRef",ref:v,model:n.value,rules:E.value,size:"large",onSubmit:$},{default:a(()=>[e(V,{gutter:16},{default:a(()=>[e(y,{span:_(u)==="sm"?12:8},{default:a(()=>[e(b,{path:"documentTypeId",label:"Tipo de Documento"},{default:a(()=>[e(C,{value:n.value.documentTypeId,"onUpdate:value":t[0]||(t[0]=s=>n.value.documentTypeId=s),clearable:"","virtual-scroll":!1,placeholder:"Seleccione",options:c.selectables.documentTypesItems},null,8,["value","options"])]),_:1})]),_:1},8,["span"]),e(y,{span:_(u)==="sm"?12:8},{default:a(()=>{var s;return[e(b,{path:"documentNumber",label:"Número de Documento",feedback:(s=i.value)==null?void 0:s.documentNumber},{default:a(()=>{var h;return[e(d,{value:n.value.documentNumber,"onUpdate:value":t[1]||(t[1]=w=>n.value.documentNumber=w),status:((h=i.value)==null?void 0:h.documentNumber)!=null?"error":"",onInput:t[2]||(t[2]=w=>i.value!=null?i.value.documentNumber=null:()=>{})},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),e(y,{span:_(u)==="sm"?24:8},{default:a(()=>{var s;return[e(b,{path:"name",label:"Nombre",feedback:(s=i.value)==null?void 0:s.name},{default:a(()=>{var h;return[P(e(d,{status:((h=i.value)==null?void 0:h.name)!=null?"error":"",value:n.value.name,"onUpdate:value":t[3]||(t[3]=w=>n.value.name=w),onInput:t[4]||(t[4]=w=>i.value!=null?i.value.name=null:()=>{})},null,8,["status","value"]),[[O]])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),e(y,{span:_(u)==="sm"?12:8},{default:a(()=>{var s;return[e(b,{path:"lastNameFather",label:"Apellido Paterno",feedback:(s=i.value)==null?void 0:s.lastNameFather},{default:a(()=>{var h;return[P(e(d,{status:((h=i.value)==null?void 0:h.lastNameFather)!=null?"error":"",value:n.value.lastNameFather,"onUpdate:value":t[5]||(t[5]=w=>n.value.lastNameFather=w),onInput:t[6]||(t[6]=w=>i.value!=null?i.value.lastNameFather=null:()=>{})},null,8,["status","value"]),[[O]])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),e(y,{span:_(u)==="sm"?12:8},{default:a(()=>{var s;return[e(b,{path:"lastNameMother",label:"Apellido Materno",feedback:(s=i.value)==null?void 0:s.lastNameMother},{default:a(()=>{var h;return[P(e(d,{status:((h=i.value)==null?void 0:h.lastNameMother)!=null?"error":"",value:n.value.lastNameMother,"onUpdate:value":t[7]||(t[7]=w=>n.value.lastNameMother=w),onInput:t[8]||(t[8]=w=>i.value!=null?i.value.lastNameMother=null:()=>{})},null,8,["status","value"]),[[O]])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),e(y,{span:_(u)==="sm"?12:8},{default:a(()=>[e(b,{path:"gender",label:"Genero"},{default:a(()=>[e(C,{value:n.value.gender,"onUpdate:value":t[9]||(t[9]=s=>n.value.gender=s),clearable:"",placeholder:"Seleccione","virtual-scroll":!1,options:_(ne)},null,8,["value","options"])]),_:1})]),_:1},8,["span"]),e(y,{span:_(u)==="sm"?12:8},{default:a(()=>[e(b,{path:"birthDate",label:"Fecha de Nacimiento"},{default:a(()=>[e(d,{value:n.value.dateOfBirth,"onUpdate:value":t[10]||(t[10]=s=>n.value.dateOfBirth=s),type:"date",clearable:"",placeholder:""},null,8,["value"])]),_:1})]),_:1},8,["span"]),e(y,{span:_(u)==="sm"?12:8},{default:a(()=>[e(b,{path:"email",label:"Correo Electrónico"},{default:a(()=>[e(d,{value:n.value.email,"onUpdate:value":t[11]||(t[11]=s=>n.value.email=s)},null,8,["value"])]),_:1})]),_:1},8,["span"]),e(y,{span:_(u)==="sm"?12:8},{default:a(()=>[e(b,{path:"phone",label:"Teléfono"},{default:a(()=>[e(d,{value:n.value.phone,"onUpdate:value":t[12]||(t[12]=s=>n.value.phone=s)},null,8,["value"])]),_:1})]),_:1},8,["span"]),e(y,{span:"24"},{default:a(()=>[e(I,{justify:"end"},{default:a(()=>[e(b,{"label-placement":"left",label:"¿Habilitado?",path:"isEnabled","show-feedback":!1},{default:a(()=>[e(k,{value:n.value.isEnabled,"onUpdate:value":t[13]||(t[13]=s=>n.value.isEnabled=s)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),De={style:{"border-bottom":"1px solid #e9e9e9"}},$e=F({__name:"DataTable",setup(r){const l=f(!1),g=f([]),o=f(!1),u=f(null),p=de({...X()}),m=f({search:null,page:p.page,pageSize:p.pageSize}),v=f({}),n=f({}),M=Ie(d=>{u.value=d,o.value=!0},async d=>{await ze(d),await N()},async d=>{await Fe(d)&&await N()}),N=async()=>{m.value.page=1,await c()},c=async()=>{l.value=!0,v.value=await Ee(m.value),g.value=v.value.data,p.total=v.value.total,p.pageSize=v.value.per_page,p.page=v.value.current_page,p.pageCount=v.value.last_page,l.value=!1},t=be(()=>{N()},400),C=async d=>{m.value.page=d,await c()},b=async d=>{m.value.page=1,m.value.pageSize=d,await c()};return(async()=>{await c(),n.value.documentTypesItems=await we()})(),(d,k)=>{const I=Z,V=ee,S=Y,U=Ne;return D(),K(Q,null,[A("div",De,[e(S,{gutter:12,style:{padding:"12px 16px"}},{default:a(()=>[e(I,{span:12}),e(I,{span:12},{default:a(()=>[e(V,{size:"large",placeholder:"Buscar",value:m.value.search,"onUpdate:value":k[0]||(k[0]=T=>m.value.search=T),onInput:_(t),clearable:""},{suffix:a(()=>[e(L,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),e(S,null,{default:a(()=>[e(I,{span:24},{default:a(()=>[e(U,{key:"id",remote:"","single-line":!1,columns:_(M),data:g.value,pagination:_(xe)(p),"pagination-show-size-picker":!0,loading:l.value,"onUpdate:page":C,"onUpdate:pageSize":b},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),pe(d.$slots,"extra",{reLoadDataTable:N,selectables:n.value})]),e(te,{modelValue:o.value,"onUpdate:modelValue":k[1]||(k[1]=T=>o.value=T),item:u.value,onSuccess:N,selectables:n.value},null,8,["modelValue","item","selectables"])],64)}}}),lt=F({__name:"index",setup(r){const l=f(!1);return(g,o)=>{const u=W,p=J;return D(),K(Q,null,[e(p,{segmented:{header:!0,content:!0}},{header:a(()=>o[2]||(o[2]=[A("span",{class:"text-sm text-slate-500"}," Gestión de Docentes ",-1),A("h5",{class:"text-lg font-bold text-slate-800"},"Docentes",-1)])),"header-extra":a(()=>[e(u,{"render-icon":_(z)("additem"),onClick:o[0]||(o[0]=m=>l.value=!0)},{default:a(()=>o[3]||(o[3]=[R(" Agregar ")])),_:1},8,["render-icon"])]),_:1}),e($e,null,{extra:a(({reLoadDataTable:m,selectables:v})=>[e(te,{modelValue:l.value,"onUpdate:modelValue":o[1]||(o[1]=n=>l.value=n),item:null,onSuccess:m,selectables:v},null,8,["modelValue","onSuccess","selectables"])]),_:1})],64)}}});export{lt as default};
