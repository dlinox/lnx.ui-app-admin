import{r as h}from"./icon.utils-DDsaHdGI.js";import{_ as G,a as q,G as J,b as K,c as Q,d as W,e as X,f as Y,g as Z}from"./curriculum.services-CGnuil-M.js";import{d as E,e as ee,r,j as ae,a8 as te,a9 as U,aa as t,ab as e,aA as B,ad as I,af as N,az as R,aH as ne,aI as oe,aF as F,_ as O,ae as T,aJ as le,aG as se}from"./index-C9c7JGRw.js";import{_ as ue,a as re}from"./FormItem-BhYV6jh0.js";import{_ as A,a as P}from"./Col-DDZ8Pssk.js";import{_ as j}from"./Input-MpWbaTbN.js";import{_ as ie}from"./Select-Bv507AmW.js";import{_ as de}from"./Space-B7YONKnB.js";import{_ as me}from"./Switch-gPDoD87R.js";import{i as pe}from"./DataTable.types-BEg5m_To.js";import{d as _e}from"./debounce.utils-DqPPCsFD.js";import{_ as ce}from"./DataTable-3NU7cn1U.js";import"./ButtonGroup-D_3c1qR3.js";import"./composables-BO6PXfsE.js";import"./Dropdown-CKOP4Jno.js";import"./Popover-U50KL7Ta.js";import"./get-DMitJf1L.js";import"./use-merged-state-BO0aND_o.js";import"./Tag-CIenDrrK.js";import"./Suffix-BAJCskMY.js";import"./get-slot-Bk_rJcZu.js";import"./Tooltip-BbKh1Nso.js";const H=E({__name:"CurriculumForm",props:{item:{},modelValue:{type:Boolean}},emits:["update:modelValue","success"],setup(k,{emit:_}){const c=_,o=k,d=ee({get:()=>o.modelValue,set:u=>c("update:modelValue",u)}),l=r(!1),s=r(null),n=r(G()),m=r(null),D=r({...q()}),S=async()=>{if(s.value){const u=await s.value.validate();let a=null;u?(l.value=!0,n.value.id?a=await K(n.value):a=await Q(n.value),a.status?(c("success"),d.value=!1):m.value=a.data):console.log("Formulario inválido")}l.value=!1},f=()=>{console.log("Inicializando formulario"),n.value=o.item?{...o.item}:G()};return ae(d,u=>{u&&f()}),(u,a)=>{const M=j,b=re,C=P,i=ie,v=me,g=de,$=A,V=ue,z=N,w=B,L=ne;return U(),te(L,{show:d.value,"onUpdate:show":a[6]||(a[6]=p=>d.value=p)},{default:t(()=>[e(w,{style:{width:"500px"},title:u.item?"EDITAR REGISTRO":"NUEVO REGISTRO",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:t(()=>[e(g,{justify:"end"},{default:t(()=>[e(z,{tertiary:"",size:"large",onClick:a[5]||(a[5]=p=>d.value=!1),disabled:l.value},{default:t(()=>a[7]||(a[7]=[R(" Cancelar ")])),_:1},8,["disabled"]),e(z,{size:"large",type:"primary",onClick:S,loading:l.value},{default:t(()=>a[8]||(a[8]=[R("Guardar")])),_:1},8,["loading"])]),_:1})]),default:t(()=>[e(V,{ref_key:"formRef",ref:s,model:n.value,rules:D.value,size:"large"},{default:t(()=>[e($,null,{default:t(()=>[e(C,{span:"24"},{default:t(()=>{var p;return[e(b,{path:"name",label:"Nombre",feedback:(p=m.value)==null?void 0:p.name},{default:t(()=>{var y;return[e(M,{value:n.value.name,"onUpdate:value":a[0]||(a[0]=x=>n.value.name=x),status:((y=m.value)==null?void 0:y.name)!=null?"error":"",onInput:a[1]||(a[1]=x=>m.value!=null?m.value.name=null:()=>{})},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1}),e(C,{span:"24"},{default:t(()=>{var p;return[e(b,{path:"gradingModel",label:"Modelo de calificación",feedback:(p=m.value)==null?void 0:p.gradingModel},{default:t(()=>{var y;return[e(i,{value:n.value.gradingModel,"onUpdate:value":[a[2]||(a[2]=x=>n.value.gradingModel=x),a[3]||(a[3]=x=>m.value!=null?m.value.gradingModel=null:()=>{})],options:I(J),"virtual-scroll":!1,status:((y=m.value)==null?void 0:y.gradingModel)!=null?"error":""},null,8,["value","options","status"])]}),_:1},8,["feedback"])]}),_:1}),e(C,{span:"24"},{default:t(()=>[e(g,{justify:"end"},{default:t(()=>[e(b,{"label-placement":"left",label:"¿Habilitado?",path:"isEnabled","show-feedback":!1},{default:t(()=>[e(v,{value:n.value.isEnabled,"onUpdate:value":a[4]||(a[4]=p=>n.value.isEnabled=p)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),fe={style:{"border-bottom":"1px solid #e9e9e9"}},ve=E({__name:"DataTable",setup(k){const _=r(!1),c=r([]),o=r(!1),d=r(null),l=oe({...pe()}),s=r({search:null,page:l.page,pageSize:l.pageSize}),n=r({}),S=X(i=>{d.value=i,o.value=!0},async i=>{await Z(i),await f()}),f=async()=>{s.value.page=1,await u()},u=async()=>{_.value=!0,n.value=await Y(s.value),c.value=n.value.data,l.total=n.value.total,l.pageSize=n.value.per_page,l.page=n.value.current_page,l.pageCount=n.value.last_page,_.value=!1},a=_e(()=>{f()},400),M=async i=>{s.value.page=i,await u()},b=async i=>{s.value.page=1,s.value.pageSize=i,await u()};return(async()=>{await u()})(),(i,v)=>{const g=P,$=j,V=A,z=ce;return U(),F(O,null,[T("div",fe,[e(V,{gutter:12,style:{padding:"12px 16px"}},{default:t(()=>[e(g,{span:12}),e(g,{span:12},{default:t(()=>[e($,{size:"large",placeholder:"Buscar",value:s.value.search,"onUpdate:value":v[0]||(v[0]=w=>s.value.search=w),onInput:I(a),clearable:""},{suffix:t(()=>[e(se,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),e(V,null,{default:t(()=>[e(g,{span:24},{default:t(()=>[e(z,{key:"id",remote:"","single-line":!1,columns:I(S),data:c.value,pagination:I(W)(l),"pagination-show-size-picker":!0,loading:_.value,"onUpdate:page":M,"onUpdate:pageSize":b},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),le(i.$slots,"extra",{reLoadDataTable:f})]),e(H,{modelValue:o.value,"onUpdate:modelValue":v[1]||(v[1]=w=>o.value=w),item:d.value,onSuccess:f},null,8,["modelValue","item"])],64)}}}),Oe=E({__name:"index",setup(k){const _=r(!1);return(c,o)=>{const d=N,l=B;return U(),F(O,null,[e(l,{segmented:{header:!0,content:!0}},{header:t(()=>o[2]||(o[2]=[T("span",{class:"text-sm text-slate-500"}," Gestión Curricular ",-1),T("h5",{class:"text-lg font-bold text-slate-800"},"Curriculo",-1)])),"header-extra":t(()=>[e(d,{"render-icon":I(h)("additem"),onClick:o[0]||(o[0]=s=>_.value=!0)},{default:t(()=>o[3]||(o[3]=[R(" Agregar ")])),_:1},8,["render-icon"])]),_:1}),e(ve,null,{extra:t(({reLoadDataTable:s})=>[e(H,{modelValue:_.value,"onUpdate:modelValue":o[1]||(o[1]=n=>_.value=n),item:null,onSuccess:s},null,8,["modelValue","onSuccess"])]),_:1})],64)}}});export{Oe as default};
