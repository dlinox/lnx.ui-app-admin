import{G as D}from"./genders.constans-ZqlXwVVz.js";import{u as z}from"./useBreakpoints-CGGSJYYs.js";import{aj as _,d as G,e as q,r as g,g as j,a3 as A,a4 as l,ad as x,a7 as H,a8 as a,ab as U,a9 as v,ac as L,ae as P}from"./index-Bqe-vxMq.js";import{d as J,e as K,a as Q,b as W,c as X}from"./DataTable.types-C3XSPyHT.js";import{_ as Y,a as Z}from"./FormItem-BBmdDte0.js";import{_ as ee}from"./Input-yPERYFUO.js";import{_ as ae}from"./debounce.utils-rmPTix7t.js";const w=()=>({id:null,personId:null,code:null,documentTypeId:1,documentNumber:null,name:null,lastNameFather:null,lastNameMother:null,gender:null,email:null,phone:null,address:null,studentTypeId:null,isEnabled:!0}),te=()=>({code:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}],documentTypeId:[{type:"number",required:!0,trigger:["blur"],message:"Obligatorio"}],documentNumber:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}],name:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}],lastNameFather:[],lastNameMother:[],gender:[],email:[],phone:[],address:[],studentTypeId:[{type:"number",required:!0,trigger:["blur","input"],message:"Obligatorio"}]}),ve=async d=>{try{return(await _().post("/student/load-data-table",d)).data.data}catch{return J()}},le=async d=>{try{return(await _().get(`/student/item/by-id/${d}`)).data.data}catch{return w()}},ne=async d=>{try{return{status:!0,data:(await _().post("/student",d)).data.data}}catch(s){return s.response.status===422?{status:!1,data:s.response.data.errors}:{status:!1,data:null}}},ue=async d=>{try{return{status:!0,data:(await _().put("/student",d)).data.data}}catch(s){return s.response.status===422?{status:!1,data:s.response.data.errors}:{status:!1,data:null}}},fe=async d=>{try{return await _().delete("/student",{data:{id:d.id}}),!0}catch{return!1}},ce=async d=>{try{return(await _().post("/student/search/list",d)).data.data}catch{return[]}},_e=G({__name:"StudentForm",props:{item:{},modelValue:{type:Boolean},selectables:{}},emits:["update:modelValue","success"],setup(d,{emit:s}){const h=s,N=d,{screenSize:f}=z(),b=q({get:()=>N.modelValue,set:p=>h("update:modelValue",p)}),y=g(!1),I=g(null),t=g(w()),u=g(null),E=g({...te()}),k=async()=>{if(console.log("formRef",t.value),I.value){const p=await I.value.validate();let e=null;p?(y.value=!0,t.value.id?e=await ue(t.value):e=await ne(t.value),e.status?(h("success",t.value),b.value=!1):u.value=e.data):console.log("Formulario inválido")}y.value=!1},R=async()=>{var p;return(p=N.item)!=null&&p.id?t.value=await le(N.item.id):t.value=w(),t.value},O=async()=>{console.log("Inicializando formulario"),await R()};return j(b,p=>{p&&O()}),(p,e)=>{const T=K,i=Y,m=Q,c=ee,$=ae,F=W,M=X,V=Z,S=L,B=P,C=x;return H(),A(C,{show:b.value,"onUpdate:show":e[18]||(e[18]=n=>b.value=n)},{default:l(()=>[a(B,{style:{width:"1024px"},title:p.item?"EDITAR REGISTRO":"NUEVO REGISTRO",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:l(()=>[a(F,{justify:"end"},{default:l(()=>[a(S,{tertiary:"",size:"large",onClick:e[17]||(e[17]=n=>b.value=!1),disabled:y.value},{default:l(()=>e[19]||(e[19]=[U(" Cancelar ")])),_:1},8,["disabled"]),a(S,{size:"large",type:"primary",onClick:k,loading:y.value},{default:l(()=>e[20]||(e[20]=[U("Guardar")])),_:1},8,["loading"])]),_:1})]),default:l(()=>[a(V,{ref_key:"formRef",ref:I,model:t.value,rules:E.value,size:"large",onSubmit:k},{default:l(()=>[a(M,{gutter:16},{default:l(()=>[a(m,{span:v(f)==="sm"?12:6},{default:l(()=>[a(i,{path:"studentTypeId",label:"Tipo de Estudiante"},{default:l(()=>[a(T,{value:t.value.studentTypeId,"onUpdate:value":e[0]||(e[0]=n=>t.value.studentTypeId=n),clearable:"",placeholder:"Seleccione","virtual-scroll":!1,options:p.selectables.studentTypesItems},null,8,["value","options"])]),_:1})]),_:1},8,["span"]),a(m,{span:v(f)==="sm"?12:6},{default:l(()=>{var n;return[a(i,{path:"code",label:"Código",feedback:(n=u.value)==null?void 0:n.code},{default:l(()=>{var o;return[a(c,{value:t.value.code,"onUpdate:value":e[1]||(e[1]=r=>t.value.code=r),status:((o=u.value)==null?void 0:o.code)!=null?"error":"",onInput:e[2]||(e[2]=r=>u.value!=null?u.value.code=null:()=>{})},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(m,{span:v(f)==="sm"?12:6},{default:l(()=>[a(i,{path:"documentTypeId",label:"Tipo de Documento"},{default:l(()=>[a(T,{value:t.value.documentTypeId,"onUpdate:value":e[3]||(e[3]=n=>t.value.documentTypeId=n),clearable:"","virtual-scroll":!1,placeholder:"Seleccione",options:p.selectables.documentTypesItems},null,8,["value","options"])]),_:1})]),_:1},8,["span"]),a(m,{span:v(f)==="sm"?12:6},{default:l(()=>{var n;return[a(i,{path:"documentNumber",label:"Número de Documento",feedback:(n=u.value)==null?void 0:n.documentNumber},{default:l(()=>{var o;return[a(c,{value:t.value.documentNumber,"onUpdate:value":e[4]||(e[4]=r=>t.value.documentNumber=r),status:((o=u.value)==null?void 0:o.documentNumber)!=null?"error":"",onInput:e[5]||(e[5]=r=>u.value!=null?u.value.documentNumber=null:()=>{})},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(m,{span:v(f)==="sm"?24:8},{default:l(()=>{var n;return[a(i,{path:"name",label:"Nombre",feedback:(n=u.value)==null?void 0:n.name},{default:l(()=>{var o;return[a(c,{status:((o=u.value)==null?void 0:o.name)!=null?"error":"",value:t.value.name,"onUpdate:value":e[6]||(e[6]=r=>t.value.name=r),onInput:e[7]||(e[7]=r=>u.value!=null?u.value.name=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(m,{span:v(f)==="sm"?12:8},{default:l(()=>{var n;return[a(i,{path:"lastNameFather",label:"Apellido Paterno",feedback:(n=u.value)==null?void 0:n.lastNameFather},{default:l(()=>{var o;return[a(c,{status:((o=u.value)==null?void 0:o.lastNameFather)!=null?"error":"",value:t.value.lastNameFather,"onUpdate:value":e[8]||(e[8]=r=>t.value.lastNameFather=r),onInput:e[9]||(e[9]=r=>u.value!=null?u.value.lastNameFather=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(m,{span:v(f)==="sm"?12:8},{default:l(()=>{var n;return[a(i,{path:"lastNameMother",label:"Apellido Materno",feedback:(n=u.value)==null?void 0:n.lastNameMother},{default:l(()=>{var o;return[a(c,{status:((o=u.value)==null?void 0:o.lastNameMother)!=null?"error":"",value:t.value.lastNameMother,"onUpdate:value":e[10]||(e[10]=r=>t.value.lastNameMother=r),onInput:e[11]||(e[11]=r=>u.value!=null?u.value.lastNameMother=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1},8,["span"]),a(m,{span:v(f)==="sm"?12:6},{default:l(()=>[a(i,{path:"gender",label:"Genero"},{default:l(()=>[a(T,{value:t.value.gender,"onUpdate:value":e[12]||(e[12]=n=>t.value.gender=n),clearable:"",placeholder:"Seleccione","virtual-scroll":!1,options:v(D)},null,8,["value","options"])]),_:1})]),_:1},8,["span"]),a(m,{span:v(f)==="sm"?12:6},{default:l(()=>[a(i,{path:"birthDate",label:"Fecha de Nacimiento"},{default:l(()=>[a(c,{value:t.value.dateOfBirth,"onUpdate:value":e[13]||(e[13]=n=>t.value.dateOfBirth=n),type:"date",clearable:"",placeholder:""},null,8,["value"])]),_:1})]),_:1},8,["span"]),a(m,{span:v(f)==="sm"?12:6},{default:l(()=>[a(i,{path:"email",label:"Correo Electrónico"},{default:l(()=>[a(c,{value:t.value.email,"onUpdate:value":e[14]||(e[14]=n=>t.value.email=n)},null,8,["value"])]),_:1})]),_:1},8,["span"]),a(m,{span:v(f)==="sm"?12:6},{default:l(()=>[a(i,{path:"phone",label:"Teléfono"},{default:l(()=>[a(c,{value:t.value.phone,"onUpdate:value":e[15]||(e[15]=n=>t.value.phone=n)},null,8,["value"])]),_:1})]),_:1},8,["span"]),a(m,{span:"24"},{default:l(()=>[a(F,{justify:"end"},{default:l(()=>[a(i,{"label-placement":"left",label:"¿Habilitado?",path:"isEnabled","show-feedback":!1},{default:l(()=>[a($,{value:t.value.isEnabled,"onUpdate:value":e[16]||(e[16]=n=>t.value.isEnabled=n)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}});export{_e as _,ve as a,fe as b,ce as c};
