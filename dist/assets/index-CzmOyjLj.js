import{r as B}from"./icon.utils-DnuXdNV1.js";import{_ as Z,a as K,b as Q,c as X}from"./period.services-B33MSbFV.js";import{d as S,a7 as C,a3 as D,a4 as t,a8 as e,ac as M,h as $,e as ee,r as _,g as ae,ad as te,ab as R,a9 as I,ae as A,af as ne,ag as N,ah as F,ai as le,Z as G}from"./index-Bqe-vxMq.js";import{_ as oe}from"./InputNumber-DA_7K28D.js";import{_ as se,a as ue}from"./FormItem-BBmdDte0.js";import{i as q,_ as re,a as H,e as ie,b as pe,c as L}from"./DataTable.types-C3XSPyHT.js";import{_ as de,d as me}from"./debounce.utils-rmPTix7t.js";import{a as j,_ as _e}from"./LnxIcon.vue_vue_type_script_setup_true_lang-tM4SdBca.js";import{u as ce,_ as ge}from"./composables-B9b5AZp0.js";import{_ as ve}from"./Input-yPERYFUO.js";import"./get-C8gX6CwU.js";import"./Remove-DsEDqNmj.js";import"./Add-DUQ_pCkh.js";import"./use-keyboard-BPlN3GQF.js";import"./Forward-DN8GWHg-.js";const fe=S({__name:"DataTableOp",props:{item:{}},emits:["edit","delete"],setup(p,{emit:i}){const o=ce(),a=i,r=[{label:"Editar",key:"edit",icon:B("edit-2"),props:{onClick:()=>a("edit")}},{label:"Eliminar",key:"delete",icon:B("trash","red"),props:{style:{color:"red"},onClick:()=>{o.warning({title:"Confirmar",content:"¿Está seguro que desea eliminar este registro?",positiveText:"Eliminar",negativeText:"Cancelar",closable:!1,showIcon:!1,negativeButtonProps:{secondary:!0,type:"tertiary",size:"large"},positiveButtonProps:{size:"large",type:"error"},onPositiveClick:()=>{a("delete")}})}}}];return(s,u)=>{const l=M,d=_e;return C(),D(d,{options:r,placement:"bottom-start"},{default:t(()=>[e(l,null,{default:t(()=>[e(j,{"icon-name":"setting-5",size:"20"})]),_:1})]),_:1})}}}),J=[{value:1,label:"ENERO"},{value:2,label:"FEBRERO"},{value:3,label:"MARZO"},{value:4,label:"ABRIL"},{value:5,label:"MAYO"},{value:6,label:"JUNIO"},{value:7,label:"JULIO"},{value:8,label:"AGOSTO"},{value:9,label:"SEPTIEMBRE"},{value:10,label:"OCTUBRE"},{value:11,label:"NOVIEMBRE"},{value:12,label:"DICIEMBRE"}],be=(p,i)=>[{title:"Ops.",key:"ops",width:"80px",fixed:"left",render(o){const a=o;return $(fe,{onEdit:()=>{p(a)},onDelete:()=>{i(a)},item:a},{default:()=>"Editar"})}},{title:"Año",key:"year",minWidth:"150px"},{title:"Mes",key:"month",minWidth:"150px",render:o=>{const a=J.find(r=>r.value===o.month);return $("span",a==null?void 0:a.label)}},{title:"Habilitado",key:"isEnabled",width:"150px",render:o=>$(re,{type:o.isEnabled?"success":"error",tertiary:!0,bordered:!1,strong:!0},{default:()=>o.isEnabled?"	Habilitado":"Deshabilitado"})}],ye=(p=q())=>({page:p.page,total:p.total,pageSize:p.pageSize,pageCount:p.pageCount,showSizePicker:!0,pageSizes:[10,50,100,500,1e3,5e3],style:{paddingRight:"16px",paddingBottom:"12px"},prefix(){return`Total ${p.total} registros`}}),U=()=>({id:null,year:new Date().getFullYear(),month:null,isEnabled:!1}),we=()=>({year:[{type:"number",required:!0,trigger:["blur","input"],message:"Obligatorio"}],month:[{type:"number",required:!0,trigger:["blur","input"],message:"Obligatorio"}]}),W=S({__name:"PeriodForm",props:{item:{},modelValue:{type:Boolean}},emits:["update:modelValue","success"],setup(p,{emit:i}){const o=i,a=p,r=ee({get:()=>a.modelValue,set:m=>o("update:modelValue",m)}),s=_(!1),u=_(null),l=_(U()),d=_(null),P=_({...we()}),O=async()=>{if(u.value){const m=await u.value.validate();let n=null;m?(s.value=!0,l.value.id?n=await Z(l.value):n=await K(l.value),n.status?(o("success"),r.value=!1):d.value=n.data):console.log("Formulario inválido")}s.value=!1},v=()=>{console.log("Inicializando formulario"),l.value=a.item?{...a.item}:U()};return ae(r,m=>{m&&v()}),(m,n)=>{const T=oe,y=se,k=H,c=ie,f=de,b=pe,V=L,h=ue,z=M,w=A,Y=te;return C(),D(Y,{show:r.value,"onUpdate:show":n[6]||(n[6]=g=>r.value=g)},{default:t(()=>[e(w,{style:{width:"500px"},title:m.item?"EDITAR REGISTRO":"NUEVO REGISTRO",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:t(()=>[e(b,{justify:"end"},{default:t(()=>[e(z,{tertiary:"",size:"large",onClick:n[5]||(n[5]=g=>r.value=!1),disabled:s.value},{default:t(()=>n[7]||(n[7]=[R(" Cancelar ")])),_:1},8,["disabled"]),e(z,{size:"large",type:"primary",onClick:O,loading:s.value},{default:t(()=>n[8]||(n[8]=[R("Guardar")])),_:1},8,["loading"])]),_:1})]),default:t(()=>[e(h,{ref_key:"formRef",ref:u,model:l.value,rules:P.value,size:"large"},{default:t(()=>[e(V,{gutter:16},{default:t(()=>[e(k,{span:"12"},{default:t(()=>{var g;return[e(y,{path:"year",label:"Año",feedback:(g=d.value)==null?void 0:g.year},{default:t(()=>{var E;return[e(T,{clearable:"",maxlength:"4",status:((E=d.value)==null?void 0:E.year)!=null?"error":"",value:l.value.year,"onUpdate:value":n[0]||(n[0]=x=>l.value.year=x),valueModifiers:{number:!0},onInput:n[1]||(n[1]=x=>d.value!=null?d.value.year=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1}),e(k,{span:"12"},{default:t(()=>{var g;return[e(y,{path:"month",label:"Mes",feedback:(g=d.value)==null?void 0:g.month},{default:t(()=>{var E;return[e(c,{clearable:"",value:l.value.month,"onUpdate:value":n[2]||(n[2]=x=>l.value.month=x),options:I(J),"virtual-scroll":!1,status:((E=d.value)==null?void 0:E.month)!=null?"error":"",onInput:n[3]||(n[3]=x=>d.value!=null?d.value.month=null:()=>{})},null,8,["value","options","status"])]}),_:1},8,["feedback"])]}),_:1}),e(k,{span:"24"},{default:t(()=>[e(b,{justify:"end"},{default:t(()=>[e(y,{"label-placement":"left",label:"¿Habilitado?",path:"isEnabled","show-feedback":!1},{default:t(()=>[e(f,{value:l.value.isEnabled,"onUpdate:value":n[4]||(n[4]=g=>l.value.isEnabled=g)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),Ee={style:{"border-bottom":"1px solid #e9e9e9"}},xe=S({__name:"DataTable",setup(p){const i=_(!1),o=_([]),a=_(!1),r=_(null),s=ne({...q()}),u=_({search:null,page:s.page,pageSize:s.pageSize}),l=_({}),O=be(c=>{r.value=c,a.value=!0},async c=>{await X(c),await v()}),v=async()=>{u.value.page=1,await m()},m=async()=>{i.value=!0,l.value=await Q(u.value),o.value=l.value.data,s.total=l.value.total,s.pageSize=l.value.per_page,s.page=l.value.current_page,s.pageCount=l.value.last_page,i.value=!1},n=me(()=>{v()},400),T=async c=>{u.value.page=c,await m()},y=async c=>{u.value.page=1,u.value.pageSize=c,await m()};return(async()=>{await m()})(),(c,f)=>{const b=H,V=ve,h=L,z=ge;return C(),N(G,null,[F("div",Ee,[e(h,{gutter:12,style:{padding:"12px 16px"}},{default:t(()=>[e(b,{span:12}),e(b,{span:12},{default:t(()=>[e(V,{size:"large",placeholder:"Buscar",value:u.value.search,"onUpdate:value":f[0]||(f[0]=w=>u.value.search=w),onInput:I(n),clearable:""},{suffix:t(()=>[e(j,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(b,{span:24},{default:t(()=>[e(z,{key:"id",remote:"","single-line":!1,columns:I(O),data:o.value,pagination:I(ye)(s),"pagination-show-size-picker":!0,loading:i.value,"onUpdate:page":T,"onUpdate:pageSize":y},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),le(c.$slots,"extra",{reLoadDataTable:v})]),e(W,{modelValue:a.value,"onUpdate:modelValue":f[1]||(f[1]=w=>a.value=w),item:r.value,onSuccess:v},null,8,["modelValue","item"])],64)}}}),De=S({__name:"index",setup(p){const i=_(!1);return(o,a)=>{const r=M,s=A;return C(),N(G,null,[e(s,{segmented:{header:!0,content:!0}},{header:t(()=>a[2]||(a[2]=[F("h6",{style:{color:"#999",margin:"0"}},"Gestión Periodos Académicos",-1),R(" Periodos Académicos ")])),"header-extra":t(()=>[e(r,{"render-icon":I(B)("additem"),onClick:a[0]||(a[0]=u=>i.value=!0)},{default:t(()=>a[3]||(a[3]=[R(" Agregar ")])),_:1},8,["render-icon"])]),_:1}),e(xe,null,{extra:t(({reLoadDataTable:u})=>[e(W,{modelValue:i.value,"onUpdate:modelValue":a[1]||(a[1]=l=>i.value=l),item:null,onSuccess:u},null,8,["modelValue","onSuccess"])]),_:1})],64)}}});export{De as default};
