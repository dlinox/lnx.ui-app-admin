import{r as O}from"./icon.utils-_VQD1LzU.js";import{d as h,a3 as H,a9 as L,ad as U,ae as b,aa as y,ab as a,ac as e,ag as N,aH as M,h as q,az as te,e as F,r as v,j as ae,aB as j,aA as $,aI as oe,aJ as ne,aG as Y,_ as J,af as B,aK as le,a8 as se}from"./index-B4HM4eEq.js";import{i as K,a as re}from"./DataTable.types-BEg5m_To.js";import{_ as ue,a as ie}from"./FormItem-cRsh-SHk.js";import{_ as W,a as Q}from"./Col-CBFn7CGp.js";import{_ as X}from"./Input-Blyfr7bU.js";import{_ as pe}from"./Select-lU1ug5AA.js";import{_ as de}from"./Space-DsuPZ34i.js";import{_ as me}from"./Switch-BouS8iVV.js";import{u as ce}from"./composables-CnPINYM7.js";import{_ as _e}from"./Dropdown-CtyOND1F.js";import{N as ve}from"./Tag-C7q16pA0.js";import{d as ge}from"./debounce.utils-DqPPCsFD.js";import{_ as fe}from"./DataTable-DxdGd7cD.js";import"./get-ClpdtJHT.js";import"./Suffix-CO3cYY28.js";import"./use-merged-state-D3q23DVU.js";import"./Popover-V6QhFDvP.js";import"./Tooltip-BuNmYRWT.js";const be=h({__name:"DataTableOp",props:{item:{}},emits:["edit","delete"],setup(n,{emit:s}){const{hasPermission:u}=H(),p=ce(),l=s,i=[{label:"Editar",key:"edit",icon:O("edit-2"),show:u(["laboratory.edit"]),props:{onClick:()=>l("edit")}},{label:"Eliminar",key:"delete",icon:O("trash","red"),show:u(["laboratory.delete"]),props:{style:{color:"red"},onClick:()=>{p.warning({title:"Confirmar",content:"¿Está seguro que desea eliminar este registro?",positiveText:"Eliminar",negativeText:"Cancelar",closable:!1,showIcon:!1,negativeButtonProps:{secondary:!0,type:"tertiary",size:"large"},positiveButtonProps:{size:"large",type:"error"},onPositiveClick:()=>{l("delete")}})}}}];return(d,o)=>{const r=N,k=_e;return b(u)(["laboratory.edit","laboratory.delete"])?(y(),L(k,{key:0,options:i,placement:"bottom-start"},{default:a(()=>[e(r,null,{default:a(()=>[e(M,{"icon-name":"setting-5",size:"20"})]),_:1})]),_:1})):U("",!0)}}}),ye=(n,s)=>[{title:"Ops.",key:"ops",width:"80px",fixed:"left",render(u){const p=u;return q(be,{onEdit:()=>{n(p)},onDelete:()=>{s(p)},item:p},{default:()=>"Editar"})}},{title:"Nombre",key:"name",minWidth:"180px"},{title:"Tipo",key:"type",width:"120px"},{title:"Habilitado",key:"isEnabled",width:"120px",render:u=>q(ve,{type:u.isEnabled?"success":"error",tertiary:!0,bordered:!1,strong:!0},{default:()=>u.isEnabled?"	Habilitado":"Deshabilitado"})}],ke=(n=K())=>({page:n.page,total:n.total,pageSize:n.pageSize,pageCount:n.pageCount,showSizePicker:!0,pageSizes:[10,50,100,500,1e3,5e3],style:{paddingRight:"16px",paddingBottom:"12px"},prefix(){return`Total ${n.total} registros`}}),we=[{label:"LABORATORIO",value:"LABORATORIO"},{label:"VIRTUAL",value:"VIRTUAL"}],G=()=>({id:null,name:null,type:"LABORATORIO",virtualLink:null,isEnabled:!0}),Te=n=>({name:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}],type:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}],virtualLink:[{required:n.type==="VIRTUAL",trigger:["blur","input"],message:"Obligatorio"},{type:"url",trigger:["blur","input"],message:"No es un link valido"}]}),P="/laboratory",D=te(),xe=async n=>{try{return(await D.post(`${P}/load-data-table`,n)).data.data}catch{return re()}},ze=async n=>{try{return{status:!0,data:(await D.post(`${P}/save`,n)).data.data}}catch(s){return s.response.status===422?{status:!1,data:s.response.data.errors}:{status:!1,data:null}}},Ie=async n=>{try{return await D.delete(`${P}`,{data:{id:n.id}}),!0}catch{return!1}},Z=h({__name:"LaboratoryForm",props:{item:{},modelValue:{type:Boolean}},emits:["update:modelValue","success"],setup(n,{emit:s}){const u=s,p=n,l=F({get:()=>p.modelValue,set:c=>u("update:modelValue",c)}),i=v(!1),d=v(null),o=v(G()),r=v(null),k=F(()=>Te(o.value)),A=async()=>{if(d.value){const c=await d.value.validate();let t=null;c?(i.value=!0,t=await ze(o.value),t.status?(u("success"),l.value=!1):r.value=t.data):console.log("Formulario inválido")}i.value=!1},w=()=>{console.log("Inicializando formulario"),o.value=p.item?{...p.item}:G()};return ae(l,c=>{c&&w()}),(c,t)=>{const E=X,T=ie,I=Q,_=pe,x=me,z=de,C=W,V=ue,S=N,R=j,ee=oe;return y(),L(ee,{show:l.value,"onUpdate:show":t[8]||(t[8]=m=>l.value=m)},{default:a(()=>[e(R,{style:{width:"500px"},title:c.item?"EDITAR REGISTRO":"NUEVO REGISTRO",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:a(()=>[e(z,{justify:"end"},{default:a(()=>[e(S,{tertiary:"",size:"large",onClick:t[7]||(t[7]=m=>l.value=!1),disabled:i.value},{default:a(()=>t[9]||(t[9]=[$(" Cancelar ")])),_:1},8,["disabled"]),e(S,{size:"large",type:"primary",onClick:A,loading:i.value},{default:a(()=>t[10]||(t[10]=[$(" Guardar ")])),_:1},8,["loading"])]),_:1})]),default:a(()=>[e(V,{ref_key:"formRef",ref:d,model:o.value,rules:k.value,size:"large"},{default:a(()=>[e(C,null,{default:a(()=>[e(I,{span:"24"},{default:a(()=>{var m;return[e(T,{path:"name",label:"Nombre",feedback:(m=r.value)==null?void 0:m.name},{default:a(()=>{var g;return[e(E,{status:((g=r.value)==null?void 0:g.name)!=null?"error":"",value:o.value.name,"onUpdate:value":t[0]||(t[0]=f=>o.value.name=f),onInput:t[1]||(t[1]=f=>r.value!=null?r.value.name=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1}),e(I,{span:"24"},{default:a(()=>{var m;return[e(T,{path:"type",label:"Tipo de laboratorio",feedback:(m=r.value)==null?void 0:m.type},{default:a(()=>{var g;return[e(_,{status:((g=r.value)==null?void 0:g.type)!=null?"error":"",value:o.value.type,"onUpdate:value":t[2]||(t[2]=f=>o.value.type=f),onInput:t[3]||(t[3]=f=>r.value!=null?r.value.type=null:()=>{}),options:b(we),placeholder:"Seleccione un tipo de laboratorio"},null,8,["status","value","options"])]}),_:1},8,["feedback"])]}),_:1}),o.value.type==="VIRTUAL"?(y(),L(I,{key:0,span:"24"},{default:a(()=>{var m;return[e(T,{path:"virtualLink",label:"Enlace virtual",feedback:(m=r.value)==null?void 0:m.virtualLink},{default:a(()=>{var g;return[e(E,{status:((g=r.value)==null?void 0:g.virtualLink)!=null?"error":"",value:o.value.virtualLink,"onUpdate:value":t[4]||(t[4]=f=>o.value.virtualLink=f),onInput:t[5]||(t[5]=f=>r.value!=null?r.value.virtualLink=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1})):U("",!0),e(I,{span:"24"},{default:a(()=>[e(z,{justify:"end"},{default:a(()=>[e(T,{"label-placement":"left",label:"¿Habilitado?",path:"isEnabled","show-feedback":!1},{default:a(()=>[e(x,{value:o.value.isEnabled,"onUpdate:value":t[6]||(t[6]=m=>o.value.isEnabled=m)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),Re={style:{"border-bottom":"1px solid #e9e9e9"}},Le=h({__name:"DataTable",setup(n){const s=v(!1),u=v([]),p=v(!1),l=v(null),i=ne({...K()}),d=v({search:null,page:i.page,pageSize:i.pageSize}),o=v({}),A=ye(_=>{l.value=_,p.value=!0},async _=>{await Ie(_),await w()}),w=async()=>{d.value.page=1,await c()},c=async()=>{s.value=!0,o.value=await xe(d.value),u.value=o.value.data,i.total=o.value.total,i.pageSize=o.value.per_page,i.page=o.value.current_page,i.pageCount=o.value.last_page,s.value=!1},t=ge(()=>{w()},400),E=async _=>{d.value.page=_,await c()},T=async _=>{d.value.page=1,d.value.pageSize=_,await c()};return(async()=>{await c()})(),(_,x)=>{const z=Q,C=X,V=W,S=fe;return y(),Y(J,null,[B("div",Re,[e(V,{gutter:12,style:{padding:"12px 16px"}},{default:a(()=>[e(z,{span:12}),e(z,{span:12},{default:a(()=>[e(C,{size:"large",placeholder:"Buscar",value:d.value.search,"onUpdate:value":x[0]||(x[0]=R=>d.value.search=R),onInput:b(t),clearable:""},{suffix:a(()=>[e(M,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),e(V,null,{default:a(()=>[e(z,{span:24},{default:a(()=>[e(S,{key:"id",remote:"",size:"small","single-line":!1,columns:b(A),data:u.value,pagination:b(ke)(i),"pagination-show-size-picker":!0,loading:s.value,"onUpdate:page":E,"onUpdate:pageSize":T},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),le(_.$slots,"extra",{reLoadDataTable:w})]),e(Z,{modelValue:p.value,"onUpdate:modelValue":x[1]||(x[1]=R=>p.value=R),item:l.value,onSuccess:w},null,8,["modelValue","item"])],64)}}}),Ye=h({__name:"index",setup(n){const{hasPermission:s}=H(),u=v(!1);return(p,l)=>{const i=N,d=j,o=se("AppNotAuthorization");return b(s)(["laboratory.create","laboratory.update","laboratory.delete"])?(y(),Y(J,{key:0},[e(d,{segmented:{header:!0,content:!0}},{header:a(()=>l[2]||(l[2]=[B("span",{class:"text-sm text-slate-500"}," Gestión de Laboratorios ",-1),B("h5",{class:"text-lg font-bold text-slate-800"},"Laboratorios",-1)])),"header-extra":a(()=>[b(s)(["laboratory.create"])?(y(),L(i,{key:0,type:"primary",size:"large","render-icon":b(O)("additem"),onClick:l[0]||(l[0]=r=>u.value=!0)},{default:a(()=>l[3]||(l[3]=[$(" Agregar ")])),_:1},8,["render-icon"])):U("",!0)]),_:1}),e(Le,null,{extra:a(({reLoadDataTable:r})=>[e(Z,{modelValue:u.value,"onUpdate:modelValue":l[1]||(l[1]=k=>u.value=k),item:null,onSuccess:r},null,8,["modelValue","onSuccess"])]),_:1})],64)):(y(),L(o,{key:1}))}}});export{Ye as default};
