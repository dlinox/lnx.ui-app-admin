import{r as te}from"./icon.utils-DutMd2qr.js";import{f as E}from"./dateFormatter.utils-4gMrAa0F.js";import{i as R}from"./DataTable.types-BEg5m_To.js";import{a3 as j,h as z,ag as F,d as N,e as O,r as p,j as ne,a9 as A,aa as S,ab as t,ac as a,aB as q,ae as y,aA as M,aI as le,aJ as oe,aG as W,_ as G,af as B,aK as se,aH as re,a8 as ie,ad as ue}from"./index-DwV6zJCX.js";import{_ as de,u as pe,a as me}from"./period.stores-DWdKCjN9.js";import{d as H}from"./debounce.utils-DqPPCsFD.js";import{a as ce}from"./selectables.services-rqDjzlhf.js";import{_ as _e,a as ve}from"./FormItem-CNNyqOT9.js";import{_ as J,a as K}from"./Col-BkVWW8vc.js";import{_ as fe}from"./Select-B-XafpkT.js";import{_ as Q}from"./Input-DldL4MyO.js";import{_ as ge}from"./Space-DEwGxh3N.js";import{_ as be}from"./Switch-DLELeq5T.js";import{_ as ye}from"./DataTable-DqW2qosf.js";import"./get-CqIzH_zz.js";import"./Popover-BpepRpqO.js";import"./use-merged-state-B_X6BK0G.js";import"./Suffix-B52V2l9z.js";import"./Tag-tDmUe03M.js";import"./get-slot-Bk_rJcZu.js";import"./Tooltip-B687EG_W.js";import"./Dropdown-CxNUQKFj.js";const{hasPermission:De}=j(),we=r=>[{title:"Ops.",key:"ops",width:"80px",fixed:"left",render(i){const o=i;return De(["enrollment-deadline.extension"])?z(F,{disabled:o.type==="AMPLIACION",onClick:()=>{r(o)},item:o},{default:()=>"Ampliación"}):null}},{title:"Periodo",key:"period",minWidth:"120px"},{title:"Fecha de Inicio",key:"startDate",minWidth:"140px",render(i){const o=i;return z("span",{},{default:()=>E(o.startDate)})}},{title:"Fecha de Fin",key:"endDate",minWidth:"140px",render(i){const o=i;return z("span",{},{default:()=>E(o.endDate)})}},{title:"Tipo",key:"type",width:"120px"},{title:"Matrícula Virtual",key:"virtual",width:"120px",render(i){const o=i;return z("span",{},{default:()=>o.virtual?"Habilitado":"No habilitado"})}},{title:"Observaciones",key:"observations",minWidth:"200px"}],he=(r=R())=>({page:r.page,total:r.total,pageSize:r.pageSize,pageCount:r.pageCount,showSizePicker:!0,pageSizes:[10,50,100,500,1e3],style:{paddingRight:"16px",paddingBottom:"12px"},prefix(){return`Total ${r.total} registros`}}),L=()=>({id:null,startDate:null,endDate:null,observations:"",periodId:null,virtual:!0}),ke=r=>({startDate:[{required:!0,trigger:["blur","input"],message:"Obligatorio"},{message:"La fecha de inicio debe ser menor",trigger:"blur",validator:(i,o)=>r.endDate&&o>r.endDate?Promise.reject("La fecha de inicio debe ser menor"):Promise.resolve()}],endDate:[{required:!0,trigger:["blur","input"],message:"Obligatorio"},{message:"La fecha de fin debe ser mayor",trigger:"blur",validator:(i,o)=>r.startDate&&o<r.startDate?Promise.reject("La fecha de fin debe ser mayor"):Promise.resolve()}],periodId:[{type:"number",required:!0,trigger:["blur","input"],message:"Obligatorio"}]}),X=N({__name:"Form",props:{item:{},modelValue:{type:Boolean}},emits:["update:modelValue","success"],setup(r,{emit:i}){const o=i,_=r,s=O({get:()=>_.modelValue,set:m=>o("update:modelValue",m)}),v=p(!1),d=p(null),l=p(L()),n=p(null),I=O(()=>({...ke(l.value)})),x=p(!1),D=p([]),g=async m=>{x.value=!0,D.value=await ce(m),x.value=!1},V=H(m=>{g(m)},400),C=async()=>{if(d.value){const m=await d.value.validate();let e=null;m&&(v.value=!0,e=await de(l.value),e.status?(o("success"),s.value=!1):n.value=e.data)}v.value=!1},U=()=>{l.value=_.item?{..._.item,startDate:_.item.lastDate?_.item.lastDate.slice(0,10):null,endDate:null,observations:null}:L()};return ne(s,m=>{m&&(n.value=null,g(""),U())}),(m,e)=>{const w=fe,f=ve,b=K,h=Q,$=be,k=ge,Y=J,Z=_e,T=F,ee=q,ae=le;return S(),A(ae,{show:s.value,"onUpdate:show":e[10]||(e[10]=u=>s.value=u)},{default:t(()=>[a(ee,{style:{width:"500px"},title:m.item?"Editar registro":"Nuevo registro",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:t(()=>[a(k,{justify:"end"},{default:t(()=>[a(T,{tertiary:"",size:"large",onClick:e[9]||(e[9]=u=>s.value=!1),disabled:v.value},{default:t(()=>e[11]||(e[11]=[M(" Cancelar ")])),_:1},8,["disabled"]),a(T,{size:"large",type:"primary",onClick:C,loading:v.value},{default:t(()=>e[12]||(e[12]=[M("Guardar")])),_:1},8,["loading"])]),_:1})]),default:t(()=>[a(Z,{ref_key:"formRef",ref:d,model:l.value,rules:I.value,size:"large"},{default:t(()=>[a(Y,{gutter:16},{default:t(()=>[a(b,{span:"24"},{default:t(()=>{var u;return[a(f,{path:"periodId",label:"Periodo",feedback:(u=n.value)==null?void 0:u.periodId},{default:t(()=>[a(w,{value:l.value.periodId,"onUpdate:value":[e[0]||(e[0]=c=>l.value.periodId=c),e[1]||(e[1]=()=>n.value!=null?n.value.periodId=null:()=>{})],placeholder:"Seleccionar Periodo Académico",filterable:"",options:D.value,loading:x.value,clearable:"",remote:"",disabled:l.value.id!=null,"virtual-scroll":!1,onSearch:y(V)},null,8,["value","options","loading","disabled","onSearch"])]),_:1},8,["feedback"])]}),_:1}),a(b,{span:"12"},{default:t(()=>{var u;return[a(f,{path:"startDate",label:"Fecha de inicio",feedback:(u=n.value)==null?void 0:u.startDate},{default:t(()=>{var c;return[a(h,{type:"date",disabled:l.value.id!=null,value:l.value.startDate,"onUpdate:value":[e[2]||(e[2]=P=>l.value.startDate=P),e[3]||(e[3]=()=>n.value!=null?n.value.startDate=null:()=>{})],status:((c=n.value)==null?void 0:c.startDate)!=null?"error":"",clearable:"",placeholder:""},null,8,["disabled","value","status"])]}),_:1},8,["feedback"])]}),_:1}),a(b,{span:"12"},{default:t(()=>{var u;return[a(f,{path:"endDate",label:"Fecha de fin",feedback:(u=n.value)==null?void 0:u.endDate},{default:t(()=>{var c;return[a(h,{type:"date",placeholder:"",value:l.value.endDate,"onUpdate:value":[e[4]||(e[4]=P=>l.value.endDate=P),e[5]||(e[5]=()=>n.value!=null?n.value.endDate=null:()=>{})],status:((c=n.value)==null?void 0:c.endDate)!=null?"error":"",clearable:""},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1}),a(b,{span:"24"},{default:t(()=>{var u;return[a(f,{path:"observations",label:"Observaciones",feedback:(u=n.value)==null?void 0:u.observations},{default:t(()=>{var c;return[a(h,{type:"textarea",value:l.value.observations,"onUpdate:value":[e[6]||(e[6]=P=>l.value.observations=P),e[7]||(e[7]=()=>n.value!=null?n.value.observations=null:()=>{})],status:((c=n.value)==null?void 0:c.observations)!=null?"error":"",clearable:"",placeholder:"Ingrese observaciones"},null,8,["value","status"])]}),_:1},8,["feedback"])]}),_:1}),a(b,{span:"24"},{default:t(()=>[a(k,{justify:"end"},{default:t(()=>[a(f,{"label-placement":"left",label:"Matrícula virtual",path:"isEnabled","show-feedback":!1},{default:t(()=>[a($,{value:l.value.virtual,"onUpdate:value":e[8]||(e[8]=u=>l.value.virtual=u)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),xe={style:{"border-bottom":"1px solid #e9e9e9"}},Pe=N({__name:"DataTable",setup(r){const i=pe(),o=p(!1),_=p([]),s=p(!1),v=p(null),d=oe({...R()}),l=p({search:null,page:d.page,pageSize:d.pageSize}),n=p({}),x=we(e=>{v.value=e,s.value=!0}),D=async()=>{l.value.page=1,await g()},g=async()=>{o.value=!0,await i.getEnrollment(),n.value=await me(l.value),_.value=n.value.data,d.total=n.value.total,d.pageSize=n.value.per_page,d.page=n.value.current_page,d.pageCount=n.value.last_page,o.value=!1},V=H(()=>{D()},400),C=async e=>{l.value.page=e,await g()},U=async e=>{l.value.page=1,l.value.pageSize=e,await g()};return(async()=>{await g()})(),(e,w)=>{const f=K,b=Q,h=J,$=ye;return S(),W(G,null,[B("div",xe,[a(h,{gutter:12,style:{padding:"12px 16px"}},{default:t(()=>[a(f,{span:12}),a(f,{span:12},{default:t(()=>[a(b,{size:"large",placeholder:"Buscar",value:l.value.search,"onUpdate:value":w[0]||(w[0]=k=>l.value.search=k),onInput:y(V),clearable:""},{suffix:t(()=>[a(re,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),a(h,null,{default:t(()=>[a(f,{span:24},{default:t(()=>[a($,{key:"id",remote:"",size:"small","single-line":!1,columns:y(x),data:_.value,pagination:y(he)(d),"pagination-show-size-picker":!0,loading:o.value,"onUpdate:page":C,"onUpdate:pageSize":U},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),se(e.$slots,"extra",{reLoadDataTable:D})]),a(X,{modelValue:s.value,"onUpdate:modelValue":w[1]||(w[1]=k=>s.value=k),item:v.value,onSuccess:D},null,8,["modelValue","item"])],64)}}}),Je=N({__name:"EnrollmentDeadlineView",setup(r){const{hasPermission:i}=j(),o=p(!1);return(_,s)=>{const v=F,d=q,l=ie("AppNotAuthorization");return y(i)(["enrollment-deadline.create","enrollment-deadline.extension"])?(S(),W(G,{key:0},[a(d,{segmented:{header:!0,content:!0}},{header:t(()=>s[2]||(s[2]=[B("span",{class:"text-sm text-slate-500"},"Gestión de Periodos de Matrícula",-1),B("h5",{class:"text-lg font-bold text-slate-800"},"Periodos de Matrícula",-1)])),"header-extra":t(()=>[y(i)(["enrollment-deadline.create"])?(S(),A(v,{key:0,type:"primary",size:"large","render-icon":y(te)("additem"),onClick:s[0]||(s[0]=n=>o.value=!0)},{default:t(()=>s[3]||(s[3]=[M(" Agregar ")])),_:1},8,["render-icon"])):ue("",!0)]),_:1}),a(Pe,null,{extra:t(({reLoadDataTable:n})=>[a(X,{modelValue:o.value,"onUpdate:modelValue":s[1]||(s[1]=I=>o.value=I),item:null,onSuccess:n},null,8,["modelValue","onSuccess"])]),_:1})],64)):(S(),A(l,{key:1}))}}});export{Je as default};
