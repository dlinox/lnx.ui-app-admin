import{d as ne,a6 as le,r as m,aI as oe,aa as s,al as h,ab as o,a8 as e,ad as l,ah as _,ac as c,ao as u,_ as S,aH as A,a5 as g,ae as E,ai as ae,af as ue}from"./index-B1moMmGf.js";import{r as re}from"./icon.utils-CvbdSYhW.js";import{u as se}from"./useBreakpoints-CTSinSsP.js";import{_ as de,a as ie,b as me,c as _e}from"./EditEnrollmentGroup.vue_vue_type_script_setup_true_lang-DZWx6epA.js";import"./studentType.services-CR2hGnl7.js";import{h as pe}from"./student.services-DO6Mfu2X.js";import"./documentType.services-DC9Pg81f.js";import{_ as ce}from"./selectables.services-B5hlRUEK.js";import{u as fe}from"./period.stores-hTtU1Vg2.js";import{_ as ge,a as ve,b as be,c as ye,d as Ie}from"./EnrollmentModuleForm.vue_vue_type_script_setup_true_lang-B7FN7T4K.js";import{_ as he,N as we}from"./Select-CFNlPL_t.js";import{_ as ke}from"./Space-DLhth_1u.js";import{_ as Ee}from"./Spin-w0Jvv-MP.js";import{_ as Ne,a as Se}from"./Col-Jp9hAiy_.js";import{_ as Ce}from"./Thing-CamCySVC.js";import{a as xe,_ as Me}from"./ListItem-ByhKepDA.js";import"./index-Z2j9nM23.js";import"./Alert-SPitgLKj.js";import"./Input-CnTYTM92.js";import"./get-DK0dPHvI.js";import"./FormItem-Dinphbxr.js";import"./DataTable.types-BIkVFYV7.js";import"./composables-Dzo7p1MU.js";import"./Dropdown-56SzW5B2.js";const Ve={class:"p-4"},$e={class:"flex justify-end bg-gray-100 p-4 -mx-6 -mt-6 mb-4"},Be={class:"text-lg font-semibold w-full text-blue-800 p-2"},Re={key:1},at=ne({__name:"EnrollmentStudentView",setup(Ae){const{screenSize:F}=se(),T=le(),v=fe(),C=m(!1),x=m(!1),b=m(null),G=m(null),M=m([]),V=m(!0),d=m({}),D=m(!0),P=m(null),U=m(null),L=m(null),H=async f=>{let t=await _e({id:f}),I=new Blob([t],{type:"application/pdf"}),w=window.URL.createObjectURL(I),p=document.getElementById("printFrame");p.src=w,p.onload=function(){var k;(k=p.contentWindow)==null||k.print()}},W=async()=>{const f=T.params.id;V.value=!0,d.value=await pe(f),V.value=!1},y=async()=>{var I;const f=T.params.id,t=(I=G.value)==null?void 0:I.id;D.value=!0,P.value=await ie(f,b.value,t),D.value=!1},$=(f,t=null)=>{U.value=f,L.value=t,x.value=!0},q=async()=>{M.value=await ce(),b.value=M.value[0].value,W(),y()};return oe(()=>{q()}),(f,t)=>{const I=he,w=ae,p=ve,k=ke,J=Ee,z=Ne,B=we,R=ue,K=ye,Q=Ce,X=xe,Y=Me,Z=Ie,ee=be,te=Se;return s(),h(S,null,[o(w,{segmented:{header:!0,footer:!0,content:!0}},{header:e(()=>t[4]||(t[4]=[l("h6",{style:{color:"#999",margin:"0"}},"Matricular estudiante",-1),_(" Nombre del estudiante ")])),"header-extra":e(()=>[o(I,{value:b.value,"onUpdate:value":[t[0]||(t[0]=n=>b.value=n),y],placeholder:"Seleccionar Plan de estudio",filterable:"",options:M.value,"virtual-scroll":!1,"default-value":1},null,8,["value","options"])]),action:e(()=>t[5]||(t[5]=[])),_:1}),l("div",Ve,[o(te,{gutter:16},{default:e(()=>[o(z,{span:c(F)=="lg"?6:24},{default:e(()=>[o(w,{segmented:{header:!0,content:!0},title:"InformaciÃ³n Personal",subtitle:"Datos del estudiante"},{default:e(()=>[o(J,{show:V.value},{default:e(()=>[o(k,{vertical:""},{default:e(()=>[o(p,{class:"small",label:"Tipo de estudiante"},{default:e(()=>{var n;return[_(u((n=d.value)==null?void 0:n.studentType),1)]}),_:1}),o(p,{class:"small",label:"Documento"},{default:e(()=>{var n,r;return[_(u((n=d.value)!=null&&n.documentNumber?(r=d.value)==null?void 0:r.documentNumber:"No registrado"),1)]}),_:1}),o(p,{class:"small",label:"Nombres"},{default:e(()=>{var n;return[_(u((n=d.value)==null?void 0:n.fullName),1)]}),_:1}),o(p,{class:"small",label:"Correo electronico"},{default:e(()=>{var n,r;return[_(u((n=d.value)!=null&&n.email?(r=d.value)==null?void 0:r.email:"No registrado"),1)]}),_:1}),o(p,{class:"small",label:"Telefono"},{default:e(()=>{var n,r;return[_(u((n=d.value)!=null&&n.phone?(r=d.value)==null?void 0:r.phone:"No registrado"),1)]}),_:1})]),_:1})]),_:1},8,["show"])]),_:1})]),_:1},8,["span"]),o(z,{span:c(F)=="lg"?18:24},{default:e(()=>[o(w,{segmented:{header:!0,content:!0},title:"Matricula"},{"header-extra":e(()=>[o(B,{bordered:!1,type:c(v).enrollment?"info":"error"},{default:e(()=>{var n;return[l("strong",null,u(c(v).enrollment?(n=c(v).enrollment)==null?void 0:n.period:"No habilitado"),1)]}),_:1},8,["type"])]),default:e(()=>[l("div",$e,[o(R,{type:"primary",onClick:t[1]||(t[1]=n=>C.value=!0),disabled:!c(v).enrollment},{default:e(()=>t[6]||(t[6]=[_(" Agregar Modulo ")])),_:1},8,["disabled"])]),o(ee,null,{default:e(()=>{var n;return[(s(!0),h(S,null,A((n=P.value)==null?void 0:n.enrollments,r=>(s(),g(Z,{key:r.moduleId,name:r.moduleId},{header:e(()=>[l("h2",Be,u(r.moduleName)+" "+u(r.isExtracurricular?"(Extracurricular)":""),1)]),default:e(()=>[o(Y,{hoverable:"",clickable:""},{default:e(()=>[(s(!0),h(S,null,A(r.courses,i=>(s(),g(X,{key:i.id},{default:e(()=>[o(Q,{title:`${i.code} - ${i.name}`},{"header-extra":e(()=>[i.enrollmentGroups.length==0||Math.max(...i.enrollmentGroups.map(a=>a.grade))<11&&i.enrollmentGroups.filter(a=>a.groupStatus=="ABIERTO").length==0?(s(),g(R,{key:0,type:"primary",onClick:a=>$(i.id)},{default:e(()=>t[7]||(t[7]=[_(" Matricular ")])),_:2},1032,["onClick"])):E("",!0)]),description:e(()=>[o(k,{size:"small"},{default:e(()=>[o(B,{bordered:!1,size:"small"},{default:e(()=>[_(" Area: "+u(i.area),1)]),_:2},1024)]),_:2},1024)]),default:e(()=>[i.enrollmentGroups.length>0?(s(),g(K,{key:0,"single-line":!1},{default:e(()=>[t[9]||(t[9]=l("thead",null,[l("tr",null,[l("th",{colspan:"2"},"Matricula"),l("th",{colspan:"3"},"Grupo"),l("th",{colspan:"2"})]),l("tr",null,[l("th",null,"Periodo"),l("th",null,"Estado"),l("th",null,"Grupo"),l("th",null,"Modalidad"),l("th",null,"Estado"),l("th",{rowspan:"2"},"Nota"),l("th",null,"Acciones")])],-1)),l("tbody",null,[(s(!0),h(S,null,A(i.enrollmentGroups,a=>{var O,j;return s(),h("tr",null,[l("td",null,[((O=c(v).enrollment)==null?void 0:O.period)==a.period?(s(),g(B,{key:0,type:"info"},{default:e(()=>[_(u(a.period),1)]),_:2},1024)):(s(),h("span",Re,u(a.period),1))]),l("td",null,u(a.enrollmentStatus),1),l("td",null,u(a.groupName),1),l("td",null,u(a.groupModality),1),l("td",null,u(a.groupStatus),1),l("td",null,u(a.grade),1),l("td",null,[((j=c(v).enrollment)==null?void 0:j.period)==a.period?(s(),g(me,{key:0,item:a,onResetEnrollment:N=>$(i.id,N),onChangeGroup:N=>$(i.id,N),onReserveEnrollment:y,onCancelEnrollment:y},null,8,["item","onResetEnrollment","onChangeGroup"])):E("",!0),a.enrollmentStatus==="MATRICULADO"?(s(),g(R,{key:1,"render-icon":c(re)("printer"),onClick:N=>H(a.id)},{default:e(()=>t[8]||(t[8]=[_(" Ficha ")])),_:2},1032,["render-icon","onClick"])):E("",!0)])])}),256))])]),_:2},1024)):E("",!0)]),_:2},1032,["title"])]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["name"]))),128))]}),_:1})]),_:1})]),_:1},8,["span"])]),_:1})]),t[10]||(t[10]=l("iframe",{id:"printFrame",style:{display:"none"}},null,-1)),d.value?(s(),g(ge,{key:0,modelValue:C.value,"onUpdate:modelValue":t[2]||(t[2]=n=>C.value=n),studentId:d.value.id,curriculumId:b.value,onSuccess:y},null,8,["modelValue","studentId","curriculumId"])):E("",!0),o(de,{modelValue:x.value,"onUpdate:modelValue":t[3]||(t[3]=n=>x.value=n),studentId:d.value.id,curriculumId:b.value,courseId:U.value,enrollmetGroup:L.value,onSuccess:y},null,8,["modelValue","studentId","curriculumId","courseId","enrollmetGroup"])],64)}}});export{at as default};
