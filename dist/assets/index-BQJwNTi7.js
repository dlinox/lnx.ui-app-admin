import{r as h}from"./icon.utils-CvbdSYhW.js";import{d as I,aa as S,a5 as M,a8 as a,ab as e,ag as G,af as B,h as O,an as Y,e as Z,r as _,g as ee,ah as R,ai as H,aj as te,ak as ae,al as j,ad as U,ac as $,am as ne,_ as q}from"./index-B1moMmGf.js";import{i as A,a as oe}from"./DataTable.types-BIkVFYV7.js";import{_ as W}from"./Input-CnTYTM92.js";import{_ as le,a as se}from"./FormItem-Dinphbxr.js";import{_ as J,a as K}from"./Col-Jp9hAiy_.js";import{_ as ue}from"./InputNumber-CLdvDV5J.js";import{_ as re}from"./Switch-BmkbJoFt.js";import{_ as ie}from"./Space-DLhth_1u.js";import{u as de}from"./composables-Dzo7p1MU.js";import{_ as pe}from"./Dropdown-56SzW5B2.js";import{N as me}from"./Select-CFNlPL_t.js";import{d as ce}from"./debounce.utils-DqPPCsFD.js";import{_ as _e}from"./DataTable-CmGk2gV6.js";import"./get-DK0dPHvI.js";import"./Tooltip-BxjKzuTH.js";const ve=I({__name:"DataTableOp",props:{item:{}},emits:["edit","delete"],setup(s,{emit:l}){const d=de(),n=l,m=[{label:"Editar",key:"edit",icon:h("edit-2"),props:{onClick:()=>n("edit")}},{label:"Eliminar",key:"delete",icon:h("trash","red"),props:{style:{color:"red"},onClick:()=>{d.warning({title:"Confirmar",content:"¿Está seguro que desea eliminar este registro?",positiveText:"Eliminar",negativeText:"Cancelar",closable:!1,showIcon:!1,negativeButtonProps:{secondary:!0,type:"tertiary",size:"large"},positiveButtonProps:{size:"large",type:"error"},onPositiveClick:()=>{n("delete")}})}}}];return(r,i)=>{const o=B,u=pe;return S(),M(u,{options:m,placement:"bottom-start"},{default:a(()=>[e(o,null,{default:a(()=>[e(G,{"icon-name":"setting-5",size:"20"})]),_:1})]),_:1})}}}),fe=(s,l)=>[{title:"Ops.",key:"ops",width:"80px",fixed:"left",render(d){const n=d;return O(ve,{onEdit:()=>{s(n)},onDelete:()=>{l(n)},item:n},{default:()=>"Editar"})}},{title:"Nombre",key:"name",minWidth:"300px"},{title:"Habilitado",key:"isEnabled",width:"150px",render:d=>O(me,{type:d.isEnabled?"success":"error",tertiary:!0,bordered:!1,strong:!0},{default:()=>d.isEnabled?"	Habilitado":"Deshabilitado"})}],ge=(s=A())=>({page:s.page,total:s.total,pageSize:s.pageSize,pageCount:s.pageCount,showSizePicker:!0,pageSizes:[10,50,100,500,1e3,5e3],style:{paddingRight:"16px",paddingBottom:"12px"},prefix(){return`Total ${s.total} registros`}}),F=()=>({id:null,name:null,deviceCount:0,deviceDetail:null,isEnabled:!0}),be=()=>({name:[{required:!0,trigger:["blur","input"],message:"Obligatorio"}]}),N="/laboratory",P=Y(),ye=async s=>{try{return(await P.post(`${N}/load-data-table`,s)).data.data}catch{return oe()}},we=async s=>{try{return{status:!0,data:(await P.post(`${N}/save`,s)).data.data}}catch(l){return l.response.status===422?{status:!1,data:l.response.data.errors}:{status:!1,data:null}}},xe=async s=>{try{return await P.delete(`${N}`,{data:{id:s.id}}),!0}catch{return!1}},Q=I({__name:"LaboratoryForm",props:{item:{},modelValue:{type:Boolean}},emits:["update:modelValue","success"],setup(s,{emit:l}){const d=l,n=s,m=Z({get:()=>n.modelValue,set:c=>d("update:modelValue",c)}),r=_(!1),i=_(null),o=_(F()),u=_(null),L=_({...be()}),V=async()=>{if(i.value){const c=await i.value.validate();let t=null;c?(r.value=!0,t=await we(o.value),t.status?(d("success"),m.value=!1):u.value=t.data):console.log("Formulario inválido")}r.value=!1},b=()=>{console.log("Inicializando formulario"),o.value=n.item?{...n.item}:F()};return ee(m,c=>{c&&b()}),(c,t)=>{const z=W,y=le,k=J,v=ue,w=re,x=ie,T=K,E=se,D=B,C=H,X=te;return S(),M(X,{show:m.value,"onUpdate:show":t[8]||(t[8]=p=>m.value=p)},{default:a(()=>[e(C,{style:{width:"500px"},title:c.item?"EDITAR REGISTRO":"NUEVO REGISTRO",segmented:{content:!0,footer:!0},size:"small",role:"dialog","aria-modal":"true"},{footer:a(()=>[e(x,{justify:"end"},{default:a(()=>[e(D,{tertiary:"",size:"large",onClick:t[7]||(t[7]=p=>m.value=!1),disabled:r.value},{default:a(()=>t[9]||(t[9]=[R(" Cancelar ")])),_:1},8,["disabled"]),e(D,{size:"large",type:"primary",onClick:V,loading:r.value},{default:a(()=>t[10]||(t[10]=[R("Guardar")])),_:1},8,["loading"])]),_:1})]),default:a(()=>[e(E,{ref_key:"formRef",ref:i,model:o.value,rules:L.value,size:"large"},{default:a(()=>[e(T,null,{default:a(()=>[e(k,{span:"24"},{default:a(()=>{var p;return[e(y,{path:"name",label:"Nombre",feedback:(p=u.value)==null?void 0:p.name},{default:a(()=>{var f;return[e(z,{status:((f=u.value)==null?void 0:f.name)!=null?"error":"",value:o.value.name,"onUpdate:value":t[0]||(t[0]=g=>o.value.name=g),onInput:t[1]||(t[1]=g=>u.value!=null?u.value.name=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1}),e(k,{span:"24"},{default:a(()=>{var p;return[e(y,{path:"deviceCount",label:"Cantidad de dispositivos",feedback:(p=u.value)==null?void 0:p.deviceCount},{default:a(()=>{var f;return[e(v,{class:"w-full",status:((f=u.value)==null?void 0:f.deviceCount)!=null?"error":"",value:o.value.deviceCount,"onUpdate:value":t[2]||(t[2]=g=>o.value.deviceCount=g),onInput:t[3]||(t[3]=g=>u.value!=null?u.value.deviceCount=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1}),e(k,{span:"24"},{default:a(()=>{var p;return[e(y,{path:"deviceDetail",label:"Detalle de dispositivos",feedback:(p=u.value)==null?void 0:p.deviceDetail},{default:a(()=>{var f;return[e(z,{status:((f=u.value)==null?void 0:f.deviceDetail)!=null?"error":"",value:o.value.deviceDetail,"onUpdate:value":t[4]||(t[4]=g=>o.value.deviceDetail=g),onInput:t[5]||(t[5]=g=>u.value!=null?u.value.deviceDetail=null:()=>{})},null,8,["status","value"])]}),_:1},8,["feedback"])]}),_:1}),e(k,{span:"24"},{default:a(()=>[e(x,{justify:"end"},{default:a(()=>[e(y,{"label-placement":"left",label:"¿Habilitado?",path:"isEnabled","show-feedback":!1},{default:a(()=>[e(w,{value:o.value.isEnabled,"onUpdate:value":t[6]||(t[6]=p=>o.value.isEnabled=p)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),ke={style:{"border-bottom":"1px solid #e9e9e9"}},Ce=I({__name:"DataTable",setup(s){const l=_(!1),d=_([]),n=_(!1),m=_(null),r=ae({...A()}),i=_({search:null,page:r.page,pageSize:r.pageSize}),o=_({}),V=fe(v=>{m.value=v,n.value=!0},async v=>{await xe(v),await b()}),b=async()=>{i.value.page=1,await c()},c=async()=>{l.value=!0,o.value=await ye(i.value),d.value=o.value.data,r.total=o.value.total,r.pageSize=o.value.per_page,r.page=o.value.current_page,r.pageCount=o.value.last_page,l.value=!1},t=ce(()=>{b()},400),z=async v=>{i.value.page=v,await c()},y=async v=>{i.value.page=1,i.value.pageSize=v,await c()};return(async()=>{await c()})(),(v,w)=>{const x=J,T=W,E=K,D=_e;return S(),j(q,null,[U("div",ke,[e(E,{gutter:12,style:{padding:"12px 16px"}},{default:a(()=>[e(x,{span:12}),e(x,{span:12},{default:a(()=>[e(T,{size:"large",placeholder:"Buscar",value:i.value.search,"onUpdate:value":w[0]||(w[0]=C=>i.value.search=C),onInput:$(t),clearable:""},{suffix:a(()=>[e(G,{"icon-name":"search-normal-1",size:"20"})]),_:1},8,["value","onInput"])]),_:1})]),_:1}),e(E,null,{default:a(()=>[e(x,{span:24},{default:a(()=>[e(D,{key:"id",remote:"","single-line":!1,columns:$(V),data:d.value,pagination:$(ge)(r),"pagination-show-size-picker":!0,loading:l.value,"onUpdate:page":z,"onUpdate:pageSize":y},null,8,["columns","data","pagination","loading"])]),_:1})]),_:1}),ne(v.$slots,"extra",{reLoadDataTable:b})]),e(Q,{modelValue:n.value,"onUpdate:modelValue":w[1]||(w[1]=C=>n.value=C),item:m.value,onSuccess:b},null,8,["modelValue","item"])],64)}}}),Fe=I({__name:"index",setup(s){const l=_(!1);return(d,n)=>{const m=B,r=H;return S(),j(q,null,[e(r,{segmented:{header:!0,content:!0}},{header:a(()=>n[2]||(n[2]=[U("span",{class:"text-sm text-slate-500"}," Gestión de Laboratorios ",-1),U("h5",{class:"text-lg font-bold text-slate-800"},"Laboratorios",-1)])),"header-extra":a(()=>[e(m,{"render-icon":$(h)("additem"),onClick:n[0]||(n[0]=i=>l.value=!0)},{default:a(()=>n[3]||(n[3]=[R(" Agregar ")])),_:1},8,["render-icon"])]),_:1}),e(Ce,null,{extra:a(({reLoadDataTable:i})=>[e(Q,{modelValue:l.value,"onUpdate:modelValue":n[1]||(n[1]=o=>l.value=o),item:null,onSuccess:i},null,8,["modelValue","onSuccess"])]),_:1})],64)}}});export{Fe as default};
